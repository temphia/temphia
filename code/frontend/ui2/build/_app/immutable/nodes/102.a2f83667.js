import{s as de,u as Ye,f as k,a as O,g as w,h as I,c as P,d as u,j as h,i as N,w as g,D as le,A as Y,x as Ze,y as We,z as Ke,Q as ye,J as Xe,E as hn,e as ne,p as Be,l as Z,m as W,n as _e,C as ue,o as yn,k as Fe,M as Ge,U as Me,K as Se,N as je,O as ze,I as at,W as Te,$ as Ve,am as st,v as Cn,R as Oe,B as Et,X as It,Y as Nt,_ as En,P as Tn,L as Ct,t as Sn,a0 as Vt}from"../chunks/scheduler.e2ee220a.js";import{S as ve,i as be,b as j,d as z,m as F,a as C,g as se,c as ie,t as D,e as G,j as Re}from"../chunks/index.4aee2103.js";import"../chunks/paths.3df37c61.js";import"../chunks/loading_spinner.svelte_svelte_type_style_lang.0368a52d.js";import{L as tt}from"../chunks/loading_spinner.ede256fc.js";import{e as re}from"../chunks/each.e59479a4.js";import{I as De}from"../chunks/Icon.9e22c3e4.js";import{A as Ue,U as mn,L as Dn,T as In,M as Nn,P as $n,a as Vn,J as Ln}from"../chunks/jsonview.d67c42f8.js";import{f as An,b as Bn,t as On}from"../chunks/index.3b48e8d3.js";import{K as $t,M as Pn,N as Un}from"../chunks/field.bf8f3926.js";import{M as Mn}from"../chunks/_multi_text.bb0c31f7.js";import{a as gn}from"../chunks/format.8ac0f50c.js";import{t as Lt}from"../chunks/index.0864d2d3.js";import{c as it,b as Tt,a as St,D as Dt}from"../chunks/table_types.a80667dc.js";import{T as Rn}from"../chunks/target.d267d535.js";import{p as Hn}from"../chunks/index.008d0d8b.js";function At(r,e,l){const t=r.slice();return t[23]=e[l],t}function Bt(r,e,l){const t=r.slice();return t[26]=e[l],t}function jn(r){let e,l=r[26].name+"",t,n,o;function s(){return r[10](r[26])}return{c(){e=k("button"),t=Z(l),this.h()},l(a){e=w(a,"BUTTON",{class:!0});var i=I(e);t=W(i,l),i.forEach(u),this.h()},h(){h(e,"class","text-gray-600 p-2 block hover:text-blue-500 focus:outline-none")},m(a,i){N(a,e,i),g(e,t),n||(o=le(e,"click",s),n=!0)},p(a,i){r=a,i&1&&l!==(l=r[26].name+"")&&_e(t,l)},i:Y,o:Y,d(a){a&&u(e),n=!1,o()}}}function zn(r){let e,l=r[26].name+"",t,n,o,s,a,i,c;return s=new De({props:{name:"x-circle",class:"w-5 pt-1 text-gray-500 hover:text-red-500"}}),{c(){e=k("button"),t=Z(l),n=Z(`
            
          `),o=k("span"),j(s.$$.fragment),this.h()},l(f){e=w(f,"BUTTON",{class:!0});var d=I(e);t=W(d,l),n=W(d,`
            
          `),o=w(d,"SPAN",{});var _=I(o);z(s.$$.fragment,_),_.forEach(u),d.forEach(u),this.h()},h(){h(e,"class","p-2 hover:text-blue-500 focus:outline-none text-blue-500 border-b-2 font-medium border-blue-500 inline-flex")},m(f,d){N(f,e,d),g(e,t),g(e,n),g(e,o),F(s,o,null),a=!0,i||(c=le(o,"click",r[9]),i=!0)},p(f,d){(!a||d&1)&&l!==(l=f[26].name+"")&&_e(t,l)},i(f){a||(C(s.$$.fragment,f),a=!0)},o(f){D(s.$$.fragment,f),a=!1},d(f){f&&u(e),G(s),i=!1,c()}}}function Ot(r){let e,l,t,n;const o=[zn,jn],s=[];function a(i,c){return i[26].__id===i[1]?0:1}return e=a(r),l=s[e]=o[e](r),{c(){l.c(),t=ne()},l(i){l.l(i),t=ne()},m(i,c){s[e].m(i,c),N(i,t,c),n=!0},p(i,c){let f=e;e=a(i),e===f?s[e].p(i,c):(se(),D(s[f],1,1,()=>{s[f]=null}),ie(),l=s[e],l?l.p(i,c):(l=s[e]=o[e](i),l.c()),C(l,1),l.m(t.parentNode,t))},i(i){n||(C(l),n=!0)},o(i){D(l),n=!1},d(i){i&&u(t),s[e].d(i)}}}function Pt(r){let e,l,t,n;return e=new Ue({props:{onClick:r[16],icon:"trash",name:"Delete"}}),t=new Ue({props:{onClick:r[17],icon:"duplicate",name:"Clone"}}),{c(){j(e.$$.fragment),l=O(),j(t.$$.fragment)},l(o){z(e.$$.fragment,o),l=P(o),z(t.$$.fragment,o)},m(o,s){F(e,o,s),N(o,l,s),F(t,o,s),n=!0},p(o,s){const a={};s&4&&(a.onClick=o[16]),e.$set(a);const i={};s&4&&(i.onClick=o[17]),t.$set(i)},i(o){n||(C(e.$$.fragment,o),C(t.$$.fragment,o),n=!0)},o(o){D(e.$$.fragment,o),D(t.$$.fragment,o),n=!1},d(o){o&&u(l),G(e,o),G(t,o)}}}function Ut(r){let e,l;return e=new Ue({props:{onClick:r[18],icon:"refresh",name:"Clear "+r[2].length}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n&4&&(o.name="Clear "+t[2].length),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Mt(r){let e,l,t,n=r[2].length===1&&Pt(r),o=r[2].length&&Ut(r);return{c(){n&&n.c(),e=O(),o&&o.c(),l=ne()},l(s){n&&n.l(s),e=P(s),o&&o.l(s),l=ne()},m(s,a){n&&n.m(s,a),N(s,e,a),o&&o.m(s,a),N(s,l,a),t=!0},p(s,a){s[2].length===1?n?(n.p(s,a),a&4&&C(n,1)):(n=Pt(s),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(se(),D(n,1,1,()=>{n=null}),ie()),s[2].length?o?(o.p(s,a),a&4&&C(o,1)):(o=Ut(s),o.c(),C(o,1),o.m(l.parentNode,l)):o&&(se(),D(o,1,1,()=>{o=null}),ie())},i(s){t||(C(n),C(o),t=!0)},o(s){D(n),D(o),t=!1},d(s){s&&(u(e),u(l)),n&&n.d(s),o&&o.d(s)}}}function Rt(r){let e,l;function t(){return r[20](r[23])}return e=new Ue({props:{onClick:t,icon:"puzzle",name:r[23].name}}),{c(){j(e.$$.fragment)},l(n){z(e.$$.fragment,n)},m(n,o){F(e,n,o),l=!0},p(n,o){r=n;const s={};o&8&&(s.onClick=t),o&8&&(s.name=r[23].name),e.$set(s)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){D(e.$$.fragment,n),l=!1},d(n){G(e,n)}}}function Fn(r){let e,l,t,n,o,s,a,i,c,f,d,_,m,y,b,v=r[2],$,T,S,E,p,V,L,K,M,A,B,q,ee,fe,ke=re(r[0]),X=[];for(let R=0;R<ke.length;R+=1)X[R]=Ot(Bt(r,ke,R));const U=R=>D(X[R],1,1,()=>{X[R]=null});o=new De({props:{name:"plus",class:"w-4 h-4"}}),i=new Ue({props:{onClick:r[12],icon:"refresh",name:"Refresh"}}),f=new Ue({props:{onClick:r[13],icon:"hashtag",name:"Raw"}}),_=new Ue({props:{onClick:r[14],icon:"calendar",name:"History"}}),y=new Ue({props:{onClick:r[15],icon:"dots-horizontal",name:"Extra"}});let J=Mt(r);T=new Ue({props:{onClick:r[19],icon:"document-search",name:"Search"}});let he=re(r[3]),Q=[];for(let R=0;R<he.length;R+=1)Q[R]=Rt(At(r,he,R));const pe=R=>D(Q[R],1,1,()=>{Q[R]=null}),Ne=r[8].default,Ee=Ye(Ne,r,r[7],null);return B=new De({props:{name:"plus",class:"w-6 h-6 inline-block text-white"}}),{c(){e=k("div"),l=k("nav");for(let R=0;R<X.length;R+=1)X[R].c();t=O(),n=k("button"),j(o.$$.fragment),s=O(),a=k("div"),j(i.$$.fragment),c=O(),j(f.$$.fragment),d=O(),j(_.$$.fragment),m=O(),j(y.$$.fragment),b=O(),J.c(),$=O(),j(T.$$.fragment),S=O(),E=k("div"),p=O();for(let R=0;R<Q.length;R+=1)Q[R].c();V=O(),L=k("div"),Ee&&Ee.c(),K=O(),M=k("div"),A=k("button"),j(B.$$.fragment),this.h()},l(R){e=w(R,"DIV",{class:!0});var ce=I(e);l=w(ce,"NAV",{class:!0});var x=I(l);for(let me=0;me<X.length;me+=1)X[me].l(x);t=P(x),n=w(x,"BUTTON",{class:!0});var H=I(n);z(o.$$.fragment,H),H.forEach(u),x.forEach(u),s=P(ce),a=w(ce,"DIV",{class:!0});var ae=I(a);z(i.$$.fragment,ae),c=P(ae),z(f.$$.fragment,ae),d=P(ae),z(_.$$.fragment,ae),m=P(ae),z(y.$$.fragment,ae),b=P(ae),J.l(ae),$=P(ae),z(T.$$.fragment,ae),S=P(ae),E=w(ae,"DIV",{class:!0}),I(E).forEach(u),p=P(ae);for(let me=0;me<Q.length;me+=1)Q[me].l(ae);ae.forEach(u),V=P(ce),L=w(ce,"DIV",{id:!0,class:!0});var we=I(L);Ee&&Ee.l(we),we.forEach(u),ce.forEach(u),K=P(R),M=w(R,"DIV",{class:!0});var $e=I(M);A=w($e,"BUTTON",{class:!0});var te=I(A);z(B.$$.fragment,te),te.forEach(u),$e.forEach(u),this.h()},h(){h(n,"class","m-2 p-1 rounded hover:bg-blue-200 border border-blue-200"),h(l,"class","flex flex-row border flex-nowrap overflow-auto"),h(E,"class","h-full border mx-1"),h(a,"class","flex p-1 gap-1"),h(L,"id","sheet-main"),h(L,"class","bg-white border rounded overflow-auto relative svelte-lcez13"),h(e,"class","flex flex-col m-1 p-1 rounded bg-white dark:bg-gray-500"),h(A,"class","p-0 w-8 h-8 bg-blue-500 rounded-full hover:bg-blue-800 active:shadow-lg mouse shadow transition ease-in duration-200 focus:outline-none"),h(M,"class","fixed bottom-4 z-5 right-14")},m(R,ce){N(R,e,ce),g(e,l);for(let x=0;x<X.length;x+=1)X[x]&&X[x].m(l,null);g(l,t),g(l,n),F(o,n,null),g(e,s),g(e,a),F(i,a,null),g(a,c),F(f,a,null),g(a,d),F(_,a,null),g(a,m),F(y,a,null),g(a,b),J.m(a,null),g(a,$),F(T,a,null),g(a,S),g(a,E),g(a,p);for(let x=0;x<Q.length;x+=1)Q[x]&&Q[x].m(a,null);g(e,V),g(e,L),Ee&&Ee.m(L,null),r[21](L),N(R,K,ce),N(R,M,ce),g(M,A),F(B,A,null),q=!0,ee||(fe=[le(n,"click",r[11]),le(L,"scroll",r[6]),le(A,"click",r[22])],ee=!0)},p(R,[ce]){if(ce&35){ke=re(R[0]);let x;for(x=0;x<ke.length;x+=1){const H=Bt(R,ke,x);X[x]?(X[x].p(H,ce),C(X[x],1)):(X[x]=Ot(H),X[x].c(),C(X[x],1),X[x].m(l,t))}for(se(),x=ke.length;x<X.length;x+=1)U(x);ie()}if(ce&4&&de(v,v=R[2])?(se(),D(J,1,1,Y),ie(),J=Mt(R),J.c(),C(J,1),J.m(a,$)):J.p(R,ce),ce&40){he=re(R[3]);let x;for(x=0;x<he.length;x+=1){const H=At(R,he,x);Q[x]?(Q[x].p(H,ce),C(Q[x],1)):(Q[x]=Rt(H),Q[x].c(),C(Q[x],1),Q[x].m(a,null))}for(se(),x=he.length;x<Q.length;x+=1)pe(x);ie()}Ee&&Ee.p&&(!q||ce&128)&&Ze(Ee,Ne,R,R[7],q?Ke(Ne,R[7],ce,null):We(R[7]),null)},i(R){if(!q){for(let ce=0;ce<ke.length;ce+=1)C(X[ce]);C(o.$$.fragment,R),C(i.$$.fragment,R),C(f.$$.fragment,R),C(_.$$.fragment,R),C(y.$$.fragment,R),C(J),C(T.$$.fragment,R);for(let ce=0;ce<he.length;ce+=1)C(Q[ce]);C(Ee,R),C(B.$$.fragment,R),q=!0}},o(R){X=X.filter(Boolean);for(let ce=0;ce<X.length;ce+=1)D(X[ce]);D(o.$$.fragment,R),D(i.$$.fragment,R),D(f.$$.fragment,R),D(_.$$.fragment,R),D(y.$$.fragment,R),D(J),D(T.$$.fragment,R),Q=Q.filter(Boolean);for(let ce=0;ce<Q.length;ce+=1)D(Q[ce]);D(Ee,R),D(B.$$.fragment,R),q=!1},d(R){R&&(u(e),u(K),u(M)),ye(X,R),G(o),G(i),G(f),G(_),G(y),J.d(R),G(T),ye(Q,R),Ee&&Ee.d(R),r[21](null),G(B),ee=!1,Xe(fe)}}}function Gn(r,e,l){let{$$slots:t={},$$scope:n}=e,{sheets:o}=e,{active_sheet:s}=e,{selected_rows:a=[]}=e,{widgets:i}=e;const c=hn();let f;const d=A=>{const{scrollTop:B,scrollTopMax:q}=f;B==0?c("scroll_top"):q===B&&c("scroll_bottom")},_=()=>c("remove_sheet"),m=A=>c("change_sheet",A.__id),y=()=>c("add_sheet"),b=()=>c("action_refresh"),v=()=>c("action_goto_rawtable"),$=()=>c("action_goto_history"),T=()=>c("action_extra"),S=()=>c("action_delete_trash",a[0]),E=()=>c("action_clone",a[0]),p=()=>c("action_clear_selects"),V=()=>c("action_search"),L=A=>c("action_run_widget",A);function K(A){Be[A?"unshift":"push"](()=>{f=A,l(4,f)})}const M=()=>c("add_row");return r.$$set=A=>{"sheets"in A&&l(0,o=A.sheets),"active_sheet"in A&&l(1,s=A.active_sheet),"selected_rows"in A&&l(2,a=A.selected_rows),"widgets"in A&&l(3,i=A.widgets),"$$scope"in A&&l(7,n=A.$$scope)},[o,s,a,i,f,c,d,n,t,_,m,y,b,v,$,T,S,E,p,V,L,K,M]}class qn extends ve{constructor(e){super(),be(this,e,Gn,Fn,de,{sheets:0,active_sheet:1,selected_rows:2,widgets:3})}}function Jn(r){let e,l,t,n,o=r[0][0].toFixed(3)+"",s,a,i,c,f,d=r[0][1].toFixed(3)+"",_;return{c(){e=k("div"),l=k("span"),t=Z(`Lat
    `),n=k("strong"),s=Z(o),a=O(),i=k("span"),c=Z(`Long
    `),f=k("strong"),_=Z(d),this.h()},l(m){e=w(m,"DIV",{class:!0});var y=I(e);l=w(y,"SPAN",{class:!0});var b=I(l);t=W(b,`Lat
    `),n=w(b,"STRONG",{class:!0});var v=I(n);s=W(v,o),v.forEach(u),b.forEach(u),a=P(y),i=w(y,"SPAN",{class:!0});var $=I(i);c=W($,`Long
    `),f=w($,"STRONG",{class:!0});var T=I(f);_=W(T,d),T.forEach(u),$.forEach(u),y.forEach(u),this.h()},h(){h(n,"class","font-semibold text-gray-700"),h(l,"class","bg-yellow-100 rounded p-0.5 text-gray-600"),h(f,"class","font-semibold text-gray-700"),h(i,"class","bg-yellow-100 rounded p-0.5 text-gray-600"),h(e,"class","flex gap-1")},m(m,y){N(m,e,y),g(e,l),g(l,t),g(l,n),g(n,s),g(e,a),g(e,i),g(i,c),g(i,f),g(f,_)},p:Y,i:Y,o:Y,d(m){m&&u(e)}}}function Yn(r,e,l){let{value:t}=e;const n=An(t);return r.$$set=o=>{"value"in o&&l(1,t=o.value)},[n,t]}class vn extends ve{constructor(e){super(),be(this,e,Yn,Jn,de,{value:1})}}const ft="shorttext",bt="longtext",qe="select",Je="multi_select",ut="number",pt="datetime",kt="bool",wt="ratings",lt="location",nt="file",Qe="user",Ae="reference",rt="remote",Zn=[ft,qe,Je,bt,ut,pt,kt,wt,lt,nt,Qe,Ae,rt],Ht={text:[ft,bt,rt,qe,Je,Qe],number:[ut,Ae]},vt={[ft]:"annotation",[qe]:"menu-alt-4",[Je]:"menu-alt-4",[bt]:"document-text",[ut]:"hashtag",[pt]:"calendar",[kt]:"check",[wt]:"star",[lt]:"map",[nt]:"document",[Ae]:"paper-clip",[Qe]:"users",[rt]:"external-link"};function jt(r,e,l){const t=r.slice();t[18]=e[l];const n=t[3][t[18].__id]||{};return t[19]=n,t}function zt(r,e,l){const t=r.slice();t[22]=e[l];const n=!!t[19][t[22].__id];t[23]=n;const o=t[19][t[22].__id]||{};t[24]=o;const s=t[24].color||"";t[25]=s;const a=t[24].value||"";t[26]=a;const i=t[24].numval||0;return t[27]=i,t}function Ft(r,e,l){const t=r.slice();return t[33]=e[l],t}function Gt(r,e,l){const t=r.slice();return t[33]=e[l],t}function qt(r,e,l){const t=r.slice();return t[33]=e[l],t}function Jt(r,e,l){const t=r.slice();return t[30]=e[l],t}function Yt(r,e,l){const t=r.slice();return t[22]=e[l],t}function Zt(r){let e,l,t,n,o=(r[22].name||`Column ${r[22].__id}`)+"",s,a,i,c;t=new De({props:{name:vt[r[22].ctype],class:"h-5 w-5 mr-1 mt-1 text-gray-500",solid:!0}});function f(){return r[10](r[22])}return{c(){e=k("th"),l=k("button"),j(t.$$.fragment),n=O(),s=Z(o),this.h()},l(d){e=w(d,"TH",{class:!0});var _=I(e);l=w(_,"BUTTON",{class:!0});var m=I(l);z(t.$$.fragment,m),n=P(m),s=W(m,o),m.forEach(u),_.forEach(u),this.h()},h(){h(l,"class","inline-flex hover:bg-blue-200 rounded px-1"),h(e,"class","sticky top-0 border-b px-6 py-1 font-bold tracking-wider uppercase text-base text-gray-700 bg-gray-100")},m(d,_){N(d,e,_),g(e,l),F(t,l,null),g(l,n),g(l,s),a=!0,i||(c=le(l,"click",f),i=!0)},p(d,_){r=d;const m={};_[0]&2&&(m.name=vt[r[22].ctype]),t.$set(m),(!a||_[0]&2)&&o!==(o=(r[22].name||`Column ${r[22].__id}`)+"")&&_e(s,o)},i(d){a||(C(t.$$.fragment,d),a=!0)},o(d){D(t.$$.fragment,d),a=!1},d(d){d&&u(e),G(t),i=!1,c()}}}function Wt(r){let e,l,t,n,o;return l=new De({props:{name:"plus",class:"w-4 h-4"}}),{c(){e=k("button"),j(l.$$.fragment),this.h()},l(s){e=w(s,"BUTTON",{class:!0});var a=I(e);z(l.$$.fragment,a),a.forEach(u),this.h()},h(){h(e,"class","p-1 rounded bg-blue-500 text-white hover:bg-blue-800")},m(s,a){N(s,e,a),F(l,e,null),t=!0,n||(o=le(e,"click",r[11]),n=!0)},p:Y,i(s){t||(C(l.$$.fragment,s),t=!0)},o(s){D(l.$$.fragment,s),t=!1},d(s){s&&u(e),G(l),n=!1,o()}}}function Kt(r){let e,l,t,n,o;function s(){return r[12](r[18])}return{c(){e=k("label"),l=k("input"),this.h()},l(a){e=w(a,"LABEL",{class:!0});var i=I(e);l=w(i,"INPUT",{type:!0,class:!0}),i.forEach(u),this.h()},h(){h(l,"type","checkbox"),l.checked=t=r[0].includes(r[18].__id),h(l,"class","form-checkbox rowCheckbox focus:outline-none focus:shadow-outline"),h(e,"class","text-teal-500 inline-flex justify-between items-center hover:bg-gray-200 px-2 py-2 rounded-lg cursor-pointer")},m(a,i){N(a,e,i),g(e,l),n||(o=le(l,"click",s),n=!0)},p(a,i){r=a,i[0]&5&&t!==(t=r[0].includes(r[18].__id))&&(l.checked=t)},d(a){a&&u(e),n=!1,o()}}}function Xt(r){let e,l,t,n;const o=[rr,nr,lr,tr,er,xn,Qn,Xn,Kn,Wn],s=[];function a(i,c){return i[22].ctype===kt?0:i[22].ctype===pt?1:i[22].ctype===Ae?2:i[22].ctype===lt?3:i[22].ctype===wt?4:i[22].ctype===nt?5:i[22].ctype===qe||i[22].ctype===Je?6:i[22].ctype===Qe?7:i[22].ctype===ut?8:9}return l=a(r),t=s[l]=o[l](r),{c(){e=k("span"),t.c(),this.h()},l(i){e=w(i,"SPAN",{class:!0});var c=I(e);t.l(c),c.forEach(u),this.h()},h(){h(e,"class","text-gray-700 px-6 py-3 flex items-center")},m(i,c){N(i,e,c),s[l].m(e,null),n=!0},p(i,c){let f=l;l=a(i),l===f?s[l].p(i,c):(se(),D(s[f],1,1,()=>{s[f]=null}),ie(),t=s[l],t?t.p(i,c):(t=s[l]=o[l](i),t.c()),C(t,1),t.m(e,null))},i(i){n||(C(t),n=!0)},o(i){D(t),n=!1},d(i){i&&u(e),s[l].d()}}}function Wn(r){let e=r[26]+"",l;return{c(){l=Z(e)},l(t){l=W(t,e)},m(t,n){N(t,l,n)},p(t,n){n[0]&14&&e!==(e=t[26]+"")&&_e(l,e)},i:Y,o:Y,d(t){t&&u(l)}}}function Kn(r){let e=r[27]+"",l;return{c(){l=Z(e)},l(t){l=W(t,e)},m(t,n){N(t,l,n)},p(t,n){n[0]&14&&e!==(e=t[27]+"")&&_e(l,e)},i:Y,o:Y,d(t){t&&u(l)}}}function Xn(r){let e,l,t=re(r[26].split(",")),n=[];for(let s=0;s<t.length;s+=1)n[s]=Qt(Ft(r,t,s));const o=s=>D(n[s],1,1,()=>{n[s]=null});return{c(){e=k("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){e=w(s,"DIV",{class:!0});var a=I(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(u),this.h()},h(){h(e,"class","flex gap-1")},m(s,a){N(s,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);l=!0},p(s,a){if(a[0]&78){t=re(s[26].split(","));let i;for(i=0;i<t.length;i+=1){const c=Ft(s,t,i);n[i]?(n[i].p(c,a),C(n[i],1)):(n[i]=Qt(c),n[i].c(),C(n[i],1),n[i].m(e,null))}for(se(),i=t.length;i<n.length;i+=1)o(i);ie()}},i(s){if(!l){for(let a=0;a<t.length;a+=1)C(n[a]);l=!0}},o(s){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)D(n[a]);l=!1},d(s){s&&u(e),ye(n,s)}}}function Qn(r){let e,l=r[26]&&xt(r);return{c(){l&&l.c(),e=ne()},l(t){l&&l.l(t),e=ne()},m(t,n){l&&l.m(t,n),N(t,e,n)},p(t,n){t[26]?l?l.p(t,n):(l=xt(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:Y,o:Y,d(t){t&&u(e),l&&l.d(t)}}}function xn(r){let e,l=r[26]&&tl(r);return{c(){l&&l.c(),e=ne()},l(t){l&&l.l(t),e=ne()},m(t,n){l&&l.m(t,n),N(t,e,n)},p(t,n){t[26]?l?l.p(t,n):(l=tl(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:Y,o:Y,d(t){t&&u(e),l&&l.d(t)}}}function er(r){let e,l,t=r[27]&&nl(r);return{c(){t&&t.c(),e=ne()},l(n){t&&t.l(n),e=ne()},m(n,o){t&&t.m(n,o),N(n,e,o),l=!0},p(n,o){n[27]?t?(t.p(n,o),o[0]&14&&C(t,1)):(t=nl(n),t.c(),C(t,1),t.m(e.parentNode,e)):t&&(se(),D(t,1,1,()=>{t=null}),ie())},i(n){l||(C(t),l=!0)},o(n){D(t),l=!1},d(n){n&&u(e),t&&t.d(n)}}}function tr(r){let e,l,t;return l=new vn({props:{value:r[26]}}),{c(){e=k("div"),j(l.$$.fragment),this.h()},l(n){e=w(n,"DIV",{class:!0});var o=I(e);z(l.$$.fragment,o),o.forEach(u),this.h()},h(){h(e,"class","text-xs")},m(n,o){N(n,e,o),F(l,e,null),t=!0},p(n,o){const s={};o[0]&14&&(s.value=n[26]),l.$set(s)},i(n){t||(C(l.$$.fragment,n),t=!0)},o(n){D(l.$$.fragment,n),t=!1},d(n){n&&u(e),G(l)}}}function lr(r){let e,l=r[27]&&sl(r);return{c(){l&&l.c(),e=ne()},l(t){l&&l.l(t),e=ne()},m(t,n){l&&l.m(t,n),N(t,e,n)},p(t,n){t[27]?l?l.p(t,n):(l=sl(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:Y,o:Y,d(t){t&&u(e),l&&l.d(t)}}}function nr(r){let e=(r[26]&&new Date(r[26]).toLocaleDateString())+"",l;return{c(){l=Z(e)},l(t){l=W(t,e)},m(t,n){N(t,l,n)},p(t,n){n[0]&14&&e!==(e=(t[26]&&new Date(t[26]).toLocaleDateString())+"")&&_e(l,e)},i:Y,o:Y,d(t){t&&u(l)}}}function rr(r){let e,l,t,n;const o=[fr,cr],s=[];function a(i,c){return i[26]==="true"?0:i[26]==="false"?1:-1}return~(e=a(r))&&(l=s[e]=o[e](r)),{c(){l&&l.c(),t=ne()},l(i){l&&l.l(i),t=ne()},m(i,c){~e&&s[e].m(i,c),N(i,t,c),n=!0},p(i,c){let f=e;e=a(i),e!==f&&(l&&(se(),D(s[f],1,1,()=>{s[f]=null}),ie()),~e?(l=s[e],l||(l=s[e]=o[e](i),l.c()),C(l,1),l.m(t.parentNode,t)):l=null)},i(i){n||(C(l),n=!0)},o(i){D(l),n=!1},d(i){i&&u(t),~e&&s[e].d(i)}}}function or(r){let e,l=r[33]+"",t;return{c(){e=k("span"),t=Z(l)},l(n){e=w(n,"SPAN",{});var o=I(e);t=W(o,l),o.forEach(u)},m(n,o){N(n,e,o),g(e,t)},p(n,o){o[0]&14&&l!==(l=n[33]+"")&&_e(t,l)},i:Y,o:Y,d(n){n&&u(e)}}}function sr(r){let e,l;return e=new mn({props:{name:r[33],url:r[6](r[33])}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n[0]&14&&(o.name=t[33]),n[0]&78&&(o.url=t[6](t[33])),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Qt(r){let e,l,t,n,o,s=r[33]+"",a,i;const c=[sr,or],f=[];function d(_,m){return _[6]?0:1}return l=d(r),t=f[l]=c[l](r),{c(){e=k("div"),t.c(),n=O(),o=k("span"),a=Z(s),this.h()},l(_){e=w(_,"DIV",{class:!0});var m=I(e);t.l(m),n=P(m),o=w(m,"SPAN",{});var y=I(o);a=W(y,s),y.forEach(u),m.forEach(u),this.h()},h(){h(e,"class","p-0.5 rounded bg-gray-50 flex border gap-0.5 text-xs items-center")},m(_,m){N(_,e,m),f[l].m(e,null),g(e,n),g(e,o),g(o,a),i=!0},p(_,m){let y=l;l=d(_),l===y?f[l].p(_,m):(se(),D(f[y],1,1,()=>{f[y]=null}),ie(),t=f[l],t?t.p(_,m):(t=f[l]=c[l](_),t.c()),C(t,1),t.m(e,n)),(!i||m[0]&14)&&s!==(s=_[33]+"")&&_e(a,s)},i(_){i||(C(t),i=!0)},o(_){D(t),i=!1},d(_){_&&u(e),f[l].d()}}}function xt(r){let e,l=re(r[26].split(",")),t=[];for(let n=0;n<l.length;n+=1)t[n]=el(Gt(r,l,n));return{c(){e=k("div");for(let n=0;n<t.length;n+=1)t[n].c();this.h()},l(n){e=w(n,"DIV",{class:!0});var o=I(e);for(let s=0;s<t.length;s+=1)t[s].l(o);o.forEach(u),this.h()},h(){h(e,"class","flex gap-1")},m(n,o){N(n,e,o);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(e,null)},p(n,o){if(o[0]&14){l=re(n[26].split(","));let s;for(s=0;s<l.length;s+=1){const a=Gt(n,l,s);t[s]?t[s].p(a,o):(t[s]=el(a),t[s].c(),t[s].m(e,null))}for(;s<t.length;s+=1)t[s].d(1);t.length=l.length}},d(n){n&&u(e),ye(t,n)}}}function el(r){let e,l=r[33]+"",t;return{c(){e=k("span"),t=Z(l),this.h()},l(n){e=w(n,"SPAN",{class:!0});var o=I(e);t=W(o,l),o.forEach(u),this.h()},h(){h(e,"class","bg-gray-100 hover:bg-gray-200 rounded")},m(n,o){N(n,e,o),g(e,t)},p(n,o){o[0]&14&&l!==(l=n[33]+"")&&_e(t,l)},d(n){n&&u(e)}}}function tl(r){let e,l=re(r[26].split(",")),t=[];for(let n=0;n<l.length;n+=1)t[n]=ll(qt(r,l,n));return{c(){for(let n=0;n<t.length;n+=1)t[n].c();e=ne()},l(n){for(let o=0;o<t.length;o+=1)t[o].l(n);e=ne()},m(n,o){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(n,o);N(n,e,o)},p(n,o){if(o[0]&30){l=re(n[26].split(","));let s;for(s=0;s<l.length;s+=1){const a=qt(n,l,s);t[s]?t[s].p(a,o):(t[s]=ll(a),t[s].c(),t[s].m(e.parentNode,e))}for(;s<t.length;s+=1)t[s].d(1);t.length=l.length}},d(n){n&&u(e),ye(t,n)}}}function ir(r){let e,l=r[33]+"",t;return{c(){e=k("span"),t=Z(l)},l(n){e=w(n,"SPAN",{});var o=I(e);t=W(o,l),o.forEach(u)},m(n,o){N(n,e,o),g(e,t)},p(n,o){o[0]&14&&l!==(l=n[33]+"")&&_e(t,l)},d(n){n&&u(e)}}}function ar(r){let e,l;return{c(){e=k("img"),this.h()},l(t){e=w(t,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){h(e,"class","h-8 w-auto border rounded"),Ge(e.src,l=r[4].getFilePreviewUrl(r[33]))||h(e,"src",l),h(e,"alt","")},m(t,n){N(t,e,n)},p(t,n){n[0]&30&&!Ge(e.src,l=t[4].getFilePreviewUrl(t[33]))&&h(e,"src",l)},d(t){t&&u(e)}}}function ll(r){let e;function l(o,s){return o[4]?ar:ir}let t=l(r),n=t(r);return{c(){e=k("div"),n.c(),this.h()},l(o){e=w(o,"DIV",{class:!0});var s=I(e);n.l(s),s.forEach(u),this.h()},h(){h(e,"class","flex gap-1")},m(o,s){N(o,e,s),n.m(e,null)},p(o,s){t===(t=l(o))&&n?n.p(o,s):(n.d(1),n=t(o),n&&(n.c(),n.m(e,null)))},d(o){o&&u(e),n.d()}}}function nl(r){let e,l,t=re([1,2,3,4,5]),n=[];for(let s=0;s<5;s+=1)n[s]=ol(Jt(r,t,s));const o=s=>D(n[s],1,1,()=>{n[s]=null});return{c(){for(let s=0;s<5;s+=1)n[s].c();e=ne()},l(s){for(let a=0;a<5;a+=1)n[a].l(s);e=ne()},m(s,a){for(let i=0;i<5;i+=1)n[i]&&n[i].m(s,a);N(s,e,a),l=!0},p(s,a){if(a[0]&14){t=re([1,2,3,4,5]);let i;for(i=0;i<5;i+=1){const c=Jt(s,t,i);n[i]?(n[i].p(c,a),C(n[i],1)):(n[i]=ol(c),n[i].c(),C(n[i],1),n[i].m(e.parentNode,e))}for(se(),i=5;i<5;i+=1)o(i);ie()}},i(s){if(!l){for(let a=0;a<5;a+=1)C(n[a]);l=!0}},o(s){n=n.filter(Boolean);for(let a=0;a<5;a+=1)D(n[a]);l=!1},d(s){s&&u(e),ye(n,s)}}}function rl(r){let e,l;return e=new De({props:{name:"star",class:"h-5 w-5 text-yellow-400 ",solid:!0}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function ol(r){let e,l,t=r[30]<=r[27]&&rl();return{c(){t&&t.c(),e=ne()},l(n){t&&t.l(n),e=ne()},m(n,o){t&&t.m(n,o),N(n,e,o),l=!0},p(n,o){n[30]<=n[27]?t?o[0]&14&&C(t,1):(t=rl(),t.c(),C(t,1),t.m(e.parentNode,e)):t&&(se(),D(t,1,1,()=>{t=null}),ie())},i(n){l||(C(t),l=!0)},o(n){D(t),l=!1},d(n){n&&u(e),t&&t.d(n)}}}function sl(r){let e,l,t=r[27]+"",n,o,s,a=r[26]+"",i,c,f;function d(){return r[13](r[24])}return{c(){e=k("button"),l=Z(`Ref:
                      `),n=Z(t),o=O(),s=k("strong"),i=Z(a),this.h()},l(_){e=w(_,"BUTTON",{class:!0});var m=I(e);l=W(m,`Ref:
                      `),n=W(m,t),o=P(m),s=w(m,"STRONG",{class:!0});var y=I(s);i=W(y,a),y.forEach(u),m.forEach(u),this.h()},h(){h(s,"class","font-semibold text-gray-700 text-xs"),h(e,"class","bg-blue-100 rounded p-0.5 text-gray-600 text-xs hover:underline")},m(_,m){N(_,e,m),g(e,l),g(e,n),g(e,o),g(e,s),g(s,i),c||(f=le(e,"click",d),c=!0)},p(_,m){r=_,m[0]&14&&t!==(t=r[27]+"")&&_e(n,t),m[0]&14&&a!==(a=r[26]+"")&&_e(i,a)},d(_){_&&u(e),c=!1,f()}}}function cr(r){let e,l;return e=new De({props:{name:"x",class:"w-6 h-6 text-red-500"}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function fr(r){let e,l;return e=new De({props:{name:"check",class:"w-6 h-6 text-green-500"}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function il(r){let e,l,t,n=r[23]&&Xt(r);return{c(){e=k("td"),n&&n.c(),this.h()},l(o){e=w(o,"TD",{class:!0,style:!0});var s=I(e);n&&n.l(s),s.forEach(u),this.h()},h(){h(e,"class",l="border-dashed border-t border-gray-200 bg-"+r[25]+"-400"),Fe(e,"background-color",r[25])},m(o,s){N(o,e,s),n&&n.m(e,null),t=!0},p(o,s){o[23]?n?(n.p(o,s),s[0]&14&&C(n,1)):(n=Xt(o),n.c(),C(n,1),n.m(e,null)):n&&(se(),D(n,1,1,()=>{n=null}),ie()),(!t||s[0]&14&&l!==(l="border-dashed border-t border-gray-200 bg-"+o[25]+"-400"))&&h(e,"class",l),(!t||s[0]&14)&&Fe(e,"background-color",o[25])},i(o){t||(C(n),t=!0)},o(o){D(n),t=!1},d(o){o&&u(e),n&&n.d()}}}function ur(r){let e,l,t,n;function o(){return r[15](r[18])}return{c(){e=k("button"),l=Z(r[7]),this.h()},l(s){e=w(s,"BUTTON",{class:!0});var a=I(e);l=W(a,r[7]),a.forEach(u),this.h()},h(){h(e,"class","underline text-blue-600")},m(s,a){N(s,e,a),g(e,l),t||(n=le(e,"click",o),t=!0)},p(s,a){r=s,a[0]&128&&_e(l,r[7])},d(s){s&&u(e),t=!1,n()}}}function _r(r){let e,l="edit",t,n;function o(){return r[14](r[18])}return{c(){e=k("button"),e.textContent=l,this.h()},l(s){e=w(s,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(e)!=="svelte-skanxy"&&(e.textContent=l),this.h()},h(){h(e,"class","underline text-blue-600")},m(s,a){N(s,e,a),t||(n=le(e,"click",o),t=!0)},p(s,a){r=s},d(s){s&&u(e),t=!1,n()}}}function al(r){let e,l,t,n,o=(r[18].__id||"")+"",s,a,i,c,f,d,_,m=r[5]&&Kt(r),y=re(r[1]),b=[];for(let E=0;E<y.length;E+=1)b[E]=il(zt(r,y,E));const v=E=>D(b[E],1,1,()=>{b[E]=null});function $(E,p){return E[5]?_r:ur}let T=$(r),S=T(r);return{c(){e=k("tr"),l=k("td"),m&&m.c(),t=O(),n=k("span"),s=Z(o),a=O();for(let E=0;E<b.length;E+=1)b[E].c();i=O(),c=k("td"),S.c(),f=O(),this.h()},l(E){e=w(E,"TR",{id:!0});var p=I(e);l=w(p,"TD",{class:!0});var V=I(l);m&&m.l(V),t=P(V),n=w(V,"SPAN",{class:!0});var L=I(n);s=W(L,o),L.forEach(u),V.forEach(u),a=P(p);for(let M=0;M<b.length;M+=1)b[M].l(p);i=P(p),c=w(p,"TD",{});var K=I(c);S.l(K),K.forEach(u),f=P(p),p.forEach(u),this.h()},h(){h(n,"class","text-xs text-gray-500"),h(l,"class","border-dashed border-t border-gray-200 px-2"),h(e,"id",d=`sheet-${r[18].__id}`)},m(E,p){N(E,e,p),g(e,l),m&&m.m(l,null),g(l,t),g(l,n),g(n,s),g(e,a);for(let V=0;V<b.length;V+=1)b[V]&&b[V].m(e,null);g(e,i),g(e,c),S.m(c,null),g(e,f),_=!0},p(E,p){if(E[5]?m?m.p(E,p):(m=Kt(E),m.c(),m.m(l,t)):m&&(m.d(1),m=null),(!_||p[0]&4)&&o!==(o=(E[18].__id||"")+"")&&_e(s,o),p[0]&606){y=re(E[1]);let V;for(V=0;V<y.length;V+=1){const L=zt(E,y,V);b[V]?(b[V].p(L,p),C(b[V],1)):(b[V]=il(L),b[V].c(),C(b[V],1),b[V].m(e,i))}for(se(),V=y.length;V<b.length;V+=1)v(V);ie()}T===(T=$(E))&&S?S.p(E,p):(S.d(1),S=T(E),S&&(S.c(),S.m(c,null))),(!_||p[0]&4&&d!==(d=`sheet-${E[18].__id}`))&&h(e,"id",d)},i(E){if(!_){for(let p=0;p<y.length;p+=1)C(b[p]);_=!0}},o(E){b=b.filter(Boolean);for(let p=0;p<b.length;p+=1)D(b[p]);_=!1},d(E){E&&u(e),m&&m.d(),ye(b,E),S.d()}}}function dr(r){let e,l,t,n,o="#",s,a,i,c,f,d,_=re(r[1]),m=[];for(let S=0;S<_.length;S+=1)m[S]=Zt(Yt(r,_,S));const y=S=>D(m[S],1,1,()=>{m[S]=null});let b=r[5]&&Wt(r),v=re(r[2]),$=[];for(let S=0;S<v.length;S+=1)$[S]=al(jt(r,v,S));const T=S=>D($[S],1,1,()=>{$[S]=null});return{c(){e=k("table"),l=k("thead"),t=k("tr"),n=k("th"),n.textContent=o,s=O();for(let S=0;S<m.length;S+=1)m[S].c();a=O(),i=k("th"),b&&b.c(),c=O(),f=k("tbody");for(let S=0;S<$.length;S+=1)$[S].c();this.h()},l(S){e=w(S,"TABLE",{class:!0});var E=I(e);l=w(E,"THEAD",{class:!0});var p=I(l);t=w(p,"TR",{class:!0});var V=I(t);n=w(V,"TH",{class:!0,"data-svelte-h":!0}),ue(n)!=="svelte-oumwzo"&&(n.textContent=o),s=P(V);for(let M=0;M<m.length;M+=1)m[M].l(V);a=P(V),i=w(V,"TH",{class:!0});var L=I(i);b&&b.l(L),L.forEach(u),V.forEach(u),p.forEach(u),c=P(E),f=w(E,"TBODY",{});var K=I(f);for(let M=0;M<$.length;M+=1)$[M].l(K);K.forEach(u),E.forEach(u),this.h()},h(){h(n,"class","py-1 px-3 sticky top-0 border-b w-20 bg-gray-100"),h(i,"class","w-10 sticky top-0 bg-gray-100"),h(t,"class","text-left"),h(l,"class","text-gray-600 border-gray-200 bg-gray-100"),h(e,"class","border-collapse table-auto w-full whitespace-no-wrap bg-white table-striped relative")},m(S,E){N(S,e,E),g(e,l),g(l,t),g(t,n),g(t,s);for(let p=0;p<m.length;p+=1)m[p]&&m[p].m(t,null);g(t,a),g(t,i),b&&b.m(i,null),g(e,c),g(e,f);for(let p=0;p<$.length;p+=1)$[p]&&$[p].m(f,null);r[16](e),d=!0},p(S,E){if(E[0]&514){_=re(S[1]);let p;for(p=0;p<_.length;p+=1){const V=Yt(S,_,p);m[p]?(m[p].p(V,E),C(m[p],1)):(m[p]=Zt(V),m[p].c(),C(m[p],1),m[p].m(t,a))}for(se(),p=_.length;p<m.length;p+=1)y(p);ie()}if(S[5]?b?(b.p(S,E),E[0]&32&&C(b,1)):(b=Wt(S),b.c(),C(b,1),b.m(i,null)):b&&(se(),D(b,1,1,()=>{b=null}),ie()),E[0]&767){v=re(S[2]);let p;for(p=0;p<v.length;p+=1){const V=jt(S,v,p);$[p]?($[p].p(V,E),C($[p],1)):($[p]=al(V),$[p].c(),C($[p],1),$[p].m(f,null))}for(se(),p=v.length;p<$.length;p+=1)T(p);ie()}},i(S){if(!d){for(let E=0;E<_.length;E+=1)C(m[E]);C(b);for(let E=0;E<v.length;E+=1)C($[E]);d=!0}},o(S){m=m.filter(Boolean);for(let E=0;E<m.length;E+=1)D(m[E]);D(b),$=$.filter(Boolean);for(let E=0;E<$.length;E+=1)D($[E]);d=!1},d(S){S&&u(e),ye(m,S),b&&b.d(),ye($,S),r[16](null)}}}function hr(r,e,l){let{columns:t}=e,{rows:n}=e,{cells:o}=e,{selected_rows:s=[]}=e,{folder_api:a=void 0}=e,{editable:i=!0}=e,{profile_genrator:c=void 0}=e,{pick_label:f="pick"}=e;const d=p=>{const V=_.querySelector(`#sheet-${p}`);V&&V.scrollIntoView()};let _;const m=hn();yn(()=>{m("mounted",{sheet_elem:_,scroller:d})});const y=p=>m("edit_column",p),b=()=>m("add_column"),v=p=>{s.includes(p.__id)?(l(0,s=s.filter(V=>V!==p.__id)),l(0,s)):l(0,s=[...s,p.__id])},$=p=>m("ref_preview",p),T=p=>m("edit_row",p),S=p=>m("pick_row",p);function E(p){Be[p?"unshift":"push"](()=>{_=p,l(8,_)})}return r.$$set=p=>{"columns"in p&&l(1,t=p.columns),"rows"in p&&l(2,n=p.rows),"cells"in p&&l(3,o=p.cells),"selected_rows"in p&&l(0,s=p.selected_rows),"folder_api"in p&&l(4,a=p.folder_api),"editable"in p&&l(5,i=p.editable),"profile_genrator"in p&&l(6,c=p.profile_genrator),"pick_label"in p&&l(7,f=p.pick_label)},[s,t,n,o,a,i,c,f,_,m,y,b,v,$,T,S,E]}class yt extends ve{constructor(e){super(),be(this,e,hr,dr,de,{columns:1,rows:2,cells:3,selected_rows:0,folder_api:4,editable:5,profile_genrator:6,pick_label:7},null,[-1,-1])}}function mr(r){let e,l,t;function n(s){r[9](s)}let o={profile_genrator:r[8],columns:r[1],rows:r[2],cells:r[3],folder_api:r[7]};return r[0]!==void 0&&(o.selected_rows=r[0]),e=new yt({props:o}),Be.push(()=>Re(e,"selected_rows",n)),e.$on("add_column",r[10]),e.$on("edit_column",r[11]),e.$on("edit_row",r[12]),e.$on("mounted",r[13]),e.$on("ref_preview",r[14]),{c(){j(e.$$.fragment)},l(s){z(e.$$.fragment,s)},m(s,a){F(e,s,a),t=!0},p(s,a){const i={};a&256&&(i.profile_genrator=s[8]),a&2&&(i.columns=s[1]),a&4&&(i.rows=s[2]),a&8&&(i.cells=s[3]),a&128&&(i.folder_api=s[7]),!l&&a&1&&(l=!0,i.selected_rows=s[0],Me(()=>l=!1)),e.$set(i)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function gr(r){let e,l;return e=new qn({props:{sheets:r[4],active_sheet:r[6],selected_rows:r[0],widgets:r[5],$$slots:{default:[mr]},$$scope:{ctx:r}}}),e.$on("action_delete_trash",r[15]),e.$on("action_goto_history",r[16]),e.$on("action_goto_rawtable",r[17]),e.$on("action_refresh",r[18]),e.$on("action_search",r[19]),e.$on("add_row",r[20]),e.$on("add_sheet",r[21]),e.$on("change_sheet",r[22]),e.$on("remove_sheet",r[23]),e.$on("action_run_widget",r[24]),e.$on("action_extra",r[25]),e.$on("scroll_top",r[26]),e.$on("scroll_bottom",r[27]),e.$on("action_clear_selects",r[28]),e.$on("action_clone",r[29]),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,[n]){const o={};n&16&&(o.sheets=t[4]),n&64&&(o.active_sheet=t[6]),n&1&&(o.selected_rows=t[0]),n&32&&(o.widgets=t[5]),n&1073742223&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function vr(r,e,l){let{columns:t}=e,{rows:n}=e,{cells:o}=e,{sheets:s}=e,{widgets:a}=e,{active_sheet:i}=e,{selected_rows:c=[]}=e,{folder_api:f}=e,{profile_genrator:d}=e;function _(U){c=U,l(0,c)}function m(U){Se.call(this,r,U)}function y(U){Se.call(this,r,U)}function b(U){Se.call(this,r,U)}function v(U){Se.call(this,r,U)}function $(U){Se.call(this,r,U)}function T(U){Se.call(this,r,U)}function S(U){Se.call(this,r,U)}function E(U){Se.call(this,r,U)}function p(U){Se.call(this,r,U)}function V(U){Se.call(this,r,U)}function L(U){Se.call(this,r,U)}function K(U){Se.call(this,r,U)}function M(U){Se.call(this,r,U)}function A(U){Se.call(this,r,U)}function B(U){Se.call(this,r,U)}function q(U){Se.call(this,r,U)}function ee(U){Se.call(this,r,U)}function fe(U){Se.call(this,r,U)}function ke(U){Se.call(this,r,U)}function X(U){Se.call(this,r,U)}return r.$$set=U=>{"columns"in U&&l(1,t=U.columns),"rows"in U&&l(2,n=U.rows),"cells"in U&&l(3,o=U.cells),"sheets"in U&&l(4,s=U.sheets),"widgets"in U&&l(5,a=U.widgets),"active_sheet"in U&&l(6,i=U.active_sheet),"selected_rows"in U&&l(0,c=U.selected_rows),"folder_api"in U&&l(7,f=U.folder_api),"profile_genrator"in U&&l(8,d=U.profile_genrator)},[c,t,n,o,s,a,i,f,d,_,m,y,b,v,$,T,S,E,p,V,L,K,M,A,B,q,ee,fe,ke,X]}class br extends ve{constructor(e){super(),be(this,e,vr,gr,de,{columns:1,rows:2,cells:3,sheets:4,widgets:5,active_sheet:6,selected_rows:0,folder_api:7,profile_genrator:8})}}function cl(r){let e,l,t;return{c(){e=je("svg"),l=je("circle"),t=je("path"),this.h()},l(n){e=ze(n,"svg",{class:!0,fill:!0,viewBox:!0});var o=I(e);l=ze(o,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),I(l).forEach(u),t=ze(o,"path",{class:!0,fill:!0,d:!0}),I(t).forEach(u),o.forEach(u),this.h()},h(){h(l,"class","opacity-25"),h(l,"cx","12"),h(l,"cy","12"),h(l,"r","10"),h(l,"stroke","currentColor"),h(l,"stroke-width","4"),h(t,"class","opacity-75"),h(t,"fill","currentColor"),h(t,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),h(e,"class","animate-spin -ml-1 mr-3 h-5 w-5 text-white"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24")},m(n,o){N(n,e,o),g(e,l),g(e,t)},d(n){n&&u(e)}}}function pr(r){let e,l,t,n,o,s,a=r[0]&&cl();return{c(){e=k("button"),a&&a.c(),l=O(),t=Z(r[2]),this.h()},l(i){e=w(i,"BUTTON",{class:!0});var c=I(e);a&&a.l(c),l=P(c),t=W(c,r[2]),c.forEach(u),this.h()},h(){h(e,"class",n="px-2 py-1 font-bold text-white bg-"+r[3]+"-500 hover:bg-"+r[3]+"-700 focus:outline-none focus:shadow-outline rounded mt-1")},m(i,c){N(i,e,c),a&&a.m(e,null),g(e,l),g(e,t),o||(s=le(e,"click",r[4]),o=!0)},p(i,[c]){i[0]?a||(a=cl(),a.c(),a.m(e,l)):a&&(a.d(1),a=null),c&4&&_e(t,i[2]),c&8&&n!==(n="px-2 py-1 font-bold text-white bg-"+i[3]+"-500 hover:bg-"+i[3]+"-700 focus:outline-none focus:shadow-outline rounded mt-1")&&h(e,"class",n)},i:Y,o:Y,d(i){i&&u(e),a&&a.d(),o=!1,s()}}}function kr(r,e,l){let{loading:t=!1}=e,{onClick:n}=e,{name:o}=e,{color:s="blue"}=e;const a=async()=>{l(0,t=!0);const i=n();i instanceof Promise&&await i,l(0,t=!1)};return r.$$set=i=>{"loading"in i&&l(0,t=i.loading),"onClick"in i&&l(1,n=i.onClick),"name"in i&&l(2,o=i.name),"color"in i&&l(3,s=i.color)},[t,n,o,s,a]}class ct extends ve{constructor(e){super(),be(this,e,kr,pr,de,{loading:0,onClick:1,name:2,color:3})}}function fl(r){let e,l;return e=new ct({props:{name:"Delete",onClick:r[2],color:"red"}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n&4&&(o.onClick=t[2]),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function wr(r){let e,l,t,n,o,s,a,i,c,f,d,_,m='<div class="border-l-red-400"></div> <div class="border-l-blue-400"></div> <div class="border-l-green-400"></div> <div class="border-l-gray-400"></div> <div class="border-l-yellow-400"></div> <div class="border-l-zinc-400"></div> <div class="border-l-emerald-400"></div> <div class="border-l-orange-400"></div> <div class="border-l-lime-400"></div> <div class="border-l-amber-400"></div> <div class="border-l-teal-400"></div> <div class="border-l-cyan-400"></div> <div class="border-l-sky-400"></div> <div class="border-l-indigo-400"></div> <div class="border-l-violet-400"></div> <div class="border-l-purple-400"></div> <div class="border-l-fuchsia-400"></div> <div class="border-l-pink-400"></div> <div class="bg-red-400"></div> <div class="bg-blue-400"></div> <div class="bg-green-400"></div> <div class="bg-gray-400"></div> <div class="bg-yellow-400"></div> <div class="bg-zinc-400"></div> <div class="bg-emerald-400"></div> <div class="bg-orange-400"></div> <div class="bg-lime-400"></div> <div class="bg-amber-400"></div> <div class="bg-teal-400"></div> <div class="bg-cyan-400"></div> <div class="bg-sky-400"></div> <div class="bg-indigo-400"></div> <div class="bg-violet-400"></div> <div class="bg-purple-400"></div> <div class="bg-fuchsia-400"></div> <div class="bg-pink-400"></div>',y;const b=r[4].default,v=Ye(b,r,r[3],null);let $=r[2]&&fl(r);return f=new ct({props:{name:"Save",onClick:r[1]}}),{c(){e=k("div"),l=k("div"),t=k("h1"),n=Z(r[0]),o=O(),s=k("div"),v&&v.c(),a=O(),i=k("div"),$&&$.c(),c=O(),j(f.$$.fragment),d=O(),_=k("div"),_.innerHTML=m,this.h()},l(T){e=w(T,"DIV",{class:!0});var S=I(e);l=w(S,"DIV",{class:!0});var E=I(l);t=w(E,"H1",{class:!0});var p=I(t);n=W(p,r[0]),p.forEach(u),E.forEach(u),o=P(S),s=w(S,"DIV",{class:!0});var V=I(s);v&&v.l(V),V.forEach(u),a=P(S),i=w(S,"DIV",{class:!0});var L=I(i);$&&$.l(L),c=P(L),z(f.$$.fragment,L),L.forEach(u),S.forEach(u),d=P(T),_=w(T,"DIV",{class:!0,"data-svelte-h":!0}),ue(_)!=="svelte-1cq7ao8"&&(_.innerHTML=m),this.h()},h(){h(t,"class","block mb-2 text-lg font-bold text-gray-700"),h(l,"class","mb-4 border-b"),h(s,"class","flex flex-col flex-grow gap-2"),h(i,"class","flex justify-end gap-2 border-t"),h(e,"class","flex flex-col h-full"),h(_,"class","hidden")},m(T,S){N(T,e,S),g(e,l),g(l,t),g(t,n),g(e,o),g(e,s),v&&v.m(s,null),g(e,a),g(e,i),$&&$.m(i,null),g(i,c),F(f,i,null),N(T,d,S),N(T,_,S),y=!0},p(T,[S]){(!y||S&1)&&_e(n,T[0]),v&&v.p&&(!y||S&8)&&Ze(v,b,T,T[3],y?Ke(b,T[3],S,null):We(T[3]),null),T[2]?$?($.p(T,S),S&4&&C($,1)):($=fl(T),$.c(),C($,1),$.m(i,c)):$&&(se(),D($,1,1,()=>{$=null}),ie());const E={};S&2&&(E.onClick=T[1]),f.$set(E)},i(T){y||(C(v,T),C($),C(f.$$.fragment,T),y=!0)},o(T){D(v,T),D($),D(f.$$.fragment,T),y=!1},d(T){T&&(u(e),u(d),u(_)),v&&v.d(T),$&&$.d(),G(f)}}}function yr(r,e,l){let{$$slots:t={},$$scope:n}=e,{title:o}=e,{onSave:s}=e,{onDelete:a=void 0}=e;return r.$$set=i=>{"title"in i&&l(0,o=i.title),"onSave"in i&&l(1,s=i.onSave),"onDelete"in i&&l(2,a=i.onDelete),"$$scope"in i&&l(3,n=i.$$scope)},[o,s,a,n,t]}let bn=class extends ve{constructor(e){super(),be(this,e,yr,wr,de,{title:0,onSave:1,onDelete:2})}};function ul(r,e,l){const t=r.slice();return t[20]=e[l],t}function _l(r,e,l){const t=r.slice();return t[23]=e[l],t}function Cr(r,e,l){const t=r.slice();return t[26]=e[l],t}function Er(r){let e,l;return{c(){e=k("option"),l=Z(r[26]),this.h()},l(t){e=w(t,"OPTION",{});var n=I(e);l=W(n,r[26]),n.forEach(u),this.h()},h(){e.__value=r[26],Te(e,e.__value)},m(t,n){N(t,e,n),g(e,l)},p:Y,d(t){t&&u(e)}}}function dl(r){let e,l,t="Ref Sheet",n,o,s,a,i,c,f,d,_,m=re(r[0]),y=[];for(let T=0;T<m.length;T+=1)y[T]=ml(_l(r,m,T));const b=[Sr,Tr],v=[];function $(T,S){return T[7]?0:1}return a=$(r),i=v[a]=b[a](r),{c(){e=k("div"),l=k("label"),l.textContent=t,n=O(),o=k("select");for(let T=0;T<y.length;T+=1)y[T].c();s=O(),i.c(),c=ne(),this.h()},l(T){e=w(T,"DIV",{class:!0});var S=I(e);l=w(S,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(l)!=="svelte-8d2p6o"&&(l.textContent=t),n=P(S),o=w(S,"SELECT",{id:!0,class:!0});var E=I(o);for(let p=0;p<y.length;p+=1)y[p].l(E);E.forEach(u),S.forEach(u),s=P(T),i.l(T),c=ne(),this.h()},h(){h(l,"class","block mb-2 text-sm font-bold text-gray-700"),h(l,"for","refsheet"),h(o,"id","refsheet"),h(o,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"),r[5]===void 0&&at(()=>r[15].call(o)),h(e,"class","mb-4")},m(T,S){N(T,e,S),g(e,l),g(e,n),g(e,o);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(o,null);Ve(o,r[5],!0),N(T,s,S),v[a].m(T,S),N(T,c,S),f=!0,d||(_=[le(o,"change",r[15]),le(o,"change",r[16])],d=!0)},p(T,S){if(S&3){m=re(T[0]);let p;for(p=0;p<m.length;p+=1){const V=_l(T,m,p);y[p]?y[p].p(V,S):(y[p]=ml(V),y[p].c(),y[p].m(o,null))}for(;p<y.length;p+=1)y[p].d(1);y.length=m.length}S&33&&Ve(o,T[5]);let E=a;a=$(T),a===E?v[a].p(T,S):(se(),D(v[E],1,1,()=>{v[E]=null}),ie(),i=v[a],i?i.p(T,S):(i=v[a]=b[a](T),i.c()),C(i,1),i.m(c.parentNode,c))},i(T){f||(C(i),f=!0)},o(T){D(i),f=!1},d(T){T&&(u(e),u(s),u(c)),ye(y,T),v[a].d(T),d=!1,Xe(_)}}}function hl(r){let e,l=r[23].name+"",t,n;return{c(){e=k("option"),t=Z(l),this.h()},l(o){e=w(o,"OPTION",{});var s=I(e);t=W(s,l),s.forEach(u),this.h()},h(){e.__value=n=r[23].__id,Te(e,e.__value)},m(o,s){N(o,e,s),g(e,t)},p(o,s){s&1&&l!==(l=o[23].name+"")&&_e(t,l),s&1&&n!==(n=o[23].__id)&&(e.__value=n,Te(e,e.__value))},d(o){o&&u(e)}}}function ml(r){let e,l=r[1]!=r[23].__id&&hl(r);return{c(){l&&l.c(),e=ne()},l(t){l&&l.l(t),e=ne()},m(t,n){l&&l.m(t,n),N(t,e,n)},p(t,n){t[1]!=t[23].__id?l?l.p(t,n):(l=hl(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){t&&u(e),l&&l.d(t)}}}function Tr(r){let e,l,t="Ref Column",n,o,s,a,i=r[3]===Ae&&gl(r);return{c(){e=k("div"),l=k("label"),l.textContent=t,n=O(),o=k("select"),i&&i.c(),this.h()},l(c){e=w(c,"DIV",{class:!0});var f=I(e);l=w(f,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(l)!=="svelte-hl098m"&&(l.textContent=t),n=P(f),o=w(f,"SELECT",{id:!0,class:!0});var d=I(o);i&&i.l(d),d.forEach(u),f.forEach(u),this.h()},h(){h(l,"class","block mb-2 text-sm font-bold text-gray-700"),h(l,"for","refcolumn"),h(o,"id","refcolumn"),h(o,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"),r[6]===void 0&&at(()=>r[17].call(o)),h(e,"class","mb-4")},m(c,f){N(c,e,f),g(e,l),g(e,n),g(e,o),i&&i.m(o,null),Ve(o,r[6],!0),s||(a=le(o,"change",r[17]),s=!0)},p(c,f){c[3]===Ae?i?i.p(c,f):(i=gl(c),i.c(),i.m(o,null)):i&&(i.d(1),i=null),f&320&&Ve(o,c[6])},i:Y,o:Y,d(c){c&&u(e),i&&i.d(),s=!1,a()}}}function Sr(r){let e,l;return e=new tt({props:{classes:""}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p:Y,i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function gl(r){let e,l=re(r[8]),t=[];for(let n=0;n<l.length;n+=1)t[n]=bl(ul(r,l,n));return{c(){for(let n=0;n<t.length;n+=1)t[n].c();e=ne()},l(n){for(let o=0;o<t.length;o+=1)t[o].l(n);e=ne()},m(n,o){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(n,o);N(n,e,o)},p(n,o){if(o&264){l=re(n[8]);let s;for(s=0;s<l.length;s+=1){const a=ul(n,l,s);t[s]?t[s].p(a,o):(t[s]=bl(a),t[s].c(),t[s].m(e.parentNode,e))}for(;s<t.length;s+=1)t[s].d(1);t.length=l.length}},d(n){n&&u(e),ye(t,n)}}}function vl(r){let e,l=r[20].name+"",t,n;return{c(){e=k("option"),t=Z(l),this.h()},l(o){e=w(o,"OPTION",{});var s=I(e);t=W(s,l),s.forEach(u),this.h()},h(){e.__value=n=r[20].__id,Te(e,e.__value)},m(o,s){N(o,e,s),g(e,t)},p(o,s){s&256&&l!==(l=o[20].name+"")&&_e(t,l),s&256&&n!==(n=o[20].__id)&&(e.__value=n,Te(e,e.__value))},d(o){o&&u(e)}}}function bl(r){let e=Ht.number.includes(r[3]),l,t=e&&vl(r);return{c(){t&&t.c(),l=ne()},l(n){t&&t.l(n),l=ne()},m(n,o){t&&t.m(n,o),N(n,l,o)},p(n,o){o&8&&(e=Ht.number.includes(n[3])),e?t?t.p(n,o):(t=vl(n),t.c(),t.m(l.parentNode,l)):t&&(t.d(1),t=null)},d(n){n&&u(l),t&&t.d(n)}}}function pl(r){let e,l,t="Options",n,o,s,a;function i(f){r[18](f)}let c={};return r[4]!==void 0&&(c.value=r[4]),o=new Mn({props:c}),Be.push(()=>Re(o,"value",i)),{c(){e=k("div"),l=k("label"),l.textContent=t,n=O(),j(o.$$.fragment),this.h()},l(f){e=w(f,"DIV",{class:!0});var d=I(e);l=w(d,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(l)!=="svelte-wf46x2"&&(l.textContent=t),n=P(d),z(o.$$.fragment,d),d.forEach(u),this.h()},h(){h(l,"class","block mb-2 text-sm font-bold text-gray-700"),h(l,"for","opts"),h(e,"class","mb-4")},m(f,d){N(f,e,d),g(e,l),g(e,n),F(o,e,null),a=!0},p(f,d){const _={};!s&&d&16&&(s=!0,_.value=f[4],Me(()=>s=!1)),o.$set(_)},i(f){a||(C(o.$$.fragment,f),a=!0)},o(f){D(o.$$.fragment,f),a=!1},d(f){f&&u(e),G(o)}}}function Dr(r){let e,l,t="Name",n,o,s,a,i,c="Type",f,d,_,m,y,b,v,$="Extra Options",T,S,E,p,V,L=re(Zn),K=[];for(let B=0;B<L.length;B+=1)K[B]=Er(Cr(r,L,B));let M=r[3]===Ae&&dl(r),A=(r[3]===Je||r[3]===qe)&&pl(r);return S=new $t({}),{c(){e=k("div"),l=k("label"),l.textContent=t,n=O(),o=k("input"),s=O(),a=k("div"),i=k("label"),i.textContent=c,f=O(),d=k("select");for(let B=0;B<K.length;B+=1)K[B].c();_=O(),M&&M.c(),m=O(),A&&A.c(),y=O(),b=k("div"),v=k("label"),v.textContent=$,T=O(),j(S.$$.fragment),this.h()},l(B){e=w(B,"DIV",{class:!0});var q=I(e);l=w(q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(l)!=="svelte-jo32ro"&&(l.textContent=t),n=P(q),o=w(q,"INPUT",{class:!0,id:!0,type:!0,placeholder:!0}),q.forEach(u),s=P(B),a=w(B,"DIV",{class:!0});var ee=I(a);i=w(ee,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(i)!=="svelte-1yrlt32"&&(i.textContent=c),f=P(ee),d=w(ee,"SELECT",{id:!0,class:!0});var fe=I(d);for(let X=0;X<K.length;X+=1)K[X].l(fe);fe.forEach(u),ee.forEach(u),_=P(B),M&&M.l(B),m=P(B),A&&A.l(B),y=P(B),b=w(B,"DIV",{class:!0});var ke=I(b);v=w(ke,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(v)!=="svelte-xnldoe"&&(v.textContent=$),T=P(ke),z(S.$$.fragment,ke),ke.forEach(u),this.h()},h(){h(l,"class","block mb-2 text-sm font-bold text-gray-700"),h(l,"for","name"),h(o,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"),h(o,"id","name"),h(o,"type","text"),h(o,"placeholder","name"),h(e,"class","mb-4"),h(i,"class","block mb-2 text-sm font-bold text-gray-700"),h(i,"for","type"),h(d,"id","type"),h(d,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"),r[3]===void 0&&at(()=>r[14].call(d)),h(a,"class","mb-4"),h(v,"class","block mb-2 text-sm font-bold text-gray-700"),h(v,"for","extraopts"),h(b,"class","mb-4")},m(B,q){N(B,e,q),g(e,l),g(e,n),g(e,o),Te(o,r[2]),N(B,s,q),N(B,a,q),g(a,i),g(a,f),g(a,d);for(let ee=0;ee<K.length;ee+=1)K[ee]&&K[ee].m(d,null);Ve(d,r[3],!0),N(B,_,q),M&&M.m(B,q),N(B,m,q),A&&A.m(B,q),N(B,y,q),N(B,b,q),g(b,v),g(b,T),F(S,b,null),E=!0,p||(V=[le(o,"input",r[13]),le(d,"change",r[14])],p=!0)},p(B,q){q&4&&o.value!==B[2]&&Te(o,B[2]),q&8&&Ve(d,B[3]),B[3]===Ae?M?(M.p(B,q),q&8&&C(M,1)):(M=dl(B),M.c(),C(M,1),M.m(m.parentNode,m)):M&&(se(),D(M,1,1,()=>{M=null}),ie()),B[3]===Je||B[3]===qe?A?(A.p(B,q),q&8&&C(A,1)):(A=pl(B),A.c(),C(A,1),A.m(y.parentNode,y)):A&&(se(),D(A,1,1,()=>{A=null}),ie())},i(B){E||(C(M),C(A),C(S.$$.fragment,B),E=!0)},o(B){D(M),D(A),D(S.$$.fragment,B),E=!1},d(B){B&&(u(e),u(s),u(a),u(_),u(m),u(y),u(b)),ye(K,B),M&&M.d(B),A&&A.d(B),G(S),p=!1,Xe(V)}}}function Ir(r){let e,l;return e=new bn({props:{title:"New Column",onSave:r[10],$$slots:{default:[Dr]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,[n]){const o={};n&536871423&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Nr(r,e,l){let{sheets:t}=e,{sheetid:n}=e,{onAdd:o=L=>{}}=e,{service:s}=e,a="",i=ft,c={},f="",d="",_="",m=!1,y=[];const b=async L=>{if(!L)return;l(7,m=!0);const K=await s.api.list_columns(L);K.ok&&(l(8,y=K.data),l(7,m=!1))},v=async()=>{const L={name:a,ctype:i,extraopts:c};return i===Ae&&(L.refsheet=Number(d),L.refcolumn=Number(_)),f&&(L.opts=f),o(L)};function $(){a=this.value,l(2,a)}function T(){i=st(this),l(3,i)}function S(){d=st(this),l(5,d),l(0,t)}const E=L=>{l(6,_=""),l(8,y=[]),b(L.target.value)};function p(){_=st(this),l(6,_),l(8,y)}function V(L){f=L,l(4,f)}return r.$$set=L=>{"sheets"in L&&l(0,t=L.sheets),"sheetid"in L&&l(1,n=L.sheetid),"onAdd"in L&&l(11,o=L.onAdd),"service"in L&&l(12,s=L.service)},[t,n,a,i,f,d,_,m,y,b,v,o,s,$,T,S,E,p,V]}class $r extends ve{constructor(e){super(),be(this,e,Nr,Ir,de,{sheets:0,sheetid:1,onAdd:11,service:12})}}function Vr(r){let e,l,t,n,o,s,a,i,c,f,d,_,m,y='<div class="border-l-red-400"></div> <div class="border-l-blue-400"></div> <div class="border-l-green-400"></div> <div class="border-l-gray-400"></div> <div class="border-l-yellow-400"></div> <div class="border-l-zinc-400"></div> <div class="border-l-emerald-400"></div> <div class="border-l-orange-400"></div> <div class="border-l-lime-400"></div> <div class="border-l-amber-400"></div> <div class="border-l-teal-400"></div> <div class="border-l-cyan-400"></div> <div class="border-l-sky-400"></div> <div class="border-l-indigo-400"></div> <div class="border-l-violet-400"></div> <div class="border-l-purple-400"></div> <div class="border-l-fuchsia-400"></div> <div class="border-l-pink-400"></div> <div class="bg-red-400"></div> <div class="bg-blue-400"></div> <div class="bg-green-400"></div> <div class="bg-gray-400"></div> <div class="bg-yellow-400"></div> <div class="bg-zinc-400"></div> <div class="bg-emerald-400"></div> <div class="bg-orange-400"></div> <div class="bg-lime-400"></div> <div class="bg-amber-400"></div> <div class="bg-teal-400"></div> <div class="bg-cyan-400"></div> <div class="bg-sky-400"></div> <div class="bg-indigo-400"></div> <div class="bg-violet-400"></div> <div class="bg-purple-400"></div> <div class="bg-fuchsia-400"></div> <div class="bg-pink-400"></div>',b,v,$;const T=r[4].default,S=Ye(T,r,r[3],null);return{c(){e=k("div"),l=k("div"),t=k("h1"),n=Z(r[0]),o=O(),s=k("div"),S&&S.c(),a=O(),i=k("div"),c=k("button"),f=Z("Save"),_=O(),m=k("div"),m.innerHTML=y,this.h()},l(E){e=w(E,"DIV",{class:!0});var p=I(e);l=w(p,"DIV",{class:!0});var V=I(l);t=w(V,"H1",{class:!0});var L=I(t);n=W(L,r[0]),L.forEach(u),V.forEach(u),o=P(p),s=w(p,"DIV",{class:!0});var K=I(s);S&&S.l(K),K.forEach(u),a=P(p),i=w(p,"DIV",{class:!0});var M=I(i);c=w(M,"BUTTON",{class:!0});var A=I(c);f=W(A,"Save"),A.forEach(u),M.forEach(u),p.forEach(u),_=P(E),m=w(E,"DIV",{class:!0,"data-svelte-h":!0}),ue(m)!=="svelte-1cq7ao8"&&(m.innerHTML=y),this.h()},h(){h(t,"class","block mb-2 text-lg font-bold text-gray-700"),h(l,"class","mb-4 border-b"),h(s,"class","flex flex-col flex-grow gap-2"),h(c,"class",d="px-2 py-1 font-bold text-white bg-blue-500 hover:bg-blue-700 focus:outline-none focus:shadow-outline rounded mt-1 "+(r[2]?"animate-bounce":"")),h(i,"class","flex justify-end border-t"),h(e,"class","flex flex-col h-full"),h(m,"class","hidden")},m(E,p){N(E,e,p),g(e,l),g(l,t),g(t,n),g(e,o),g(e,s),S&&S.m(s,null),g(e,a),g(e,i),g(i,c),g(c,f),N(E,_,p),N(E,m,p),b=!0,v||($=le(c,"click",r[5]),v=!0)},p(E,[p]){(!b||p&1)&&_e(n,E[0]),S&&S.p&&(!b||p&8)&&Ze(S,T,E,E[3],b?Ke(T,E[3],p,null):We(E[3]),null),(!b||p&4&&d!==(d="px-2 py-1 font-bold text-white bg-blue-500 hover:bg-blue-700 focus:outline-none focus:shadow-outline rounded mt-1 "+(E[2]?"animate-bounce":"")))&&h(c,"class",d)},i(E){b||(C(S,E),b=!0)},o(E){D(S,E),b=!1},d(E){E&&(u(e),u(_),u(m)),S&&S.d(E),v=!1,$()}}}function Lr(r,e,l){let{$$slots:t={},$$scope:n}=e,{title:o}=e,{onClick:s}=e,a=!1;const i=async()=>{l(2,a=!0);const c=s();c instanceof Promise&&await c,l(2,a=!1)};return r.$$set=c=>{"title"in c&&l(0,o=c.title),"onClick"in c&&l(1,s=c.onClick),"$$scope"in c&&l(3,n=c.$$scope)},[o,s,a,n,t,i]}let Ar=class extends ve{constructor(e){super(),be(this,e,Lr,Vr,de,{title:0,onClick:1})}};function Br(r){let e,l,t="Name",n,o,s,a,i,c="Options",f,d,_,m,y;return d=new $t({}),{c(){e=k("div"),l=k("label"),l.textContent=t,n=O(),o=k("input"),s=O(),a=k("div"),i=k("label"),i.textContent=c,f=O(),j(d.$$.fragment),this.h()},l(b){e=w(b,"DIV",{class:!0});var v=I(e);l=w(v,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(l)!=="svelte-jo32ro"&&(l.textContent=t),n=P(v),o=w(v,"INPUT",{class:!0,id:!0,type:!0,placeholder:!0}),v.forEach(u),s=P(b),a=w(b,"DIV",{class:!0});var $=I(a);i=w($,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(i)!=="svelte-1l2322u"&&(i.textContent=c),f=P($),z(d.$$.fragment,$),$.forEach(u),this.h()},h(){h(l,"class","block mb-2 text-sm font-bold text-gray-700"),h(l,"for","name"),h(o,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"),h(o,"id","name"),h(o,"type","text"),h(o,"placeholder","name"),h(e,"class","mb-4"),h(i,"class","block mb-2 text-sm font-bold text-gray-700"),h(i,"for","opts"),h(a,"class","mb-4")},m(b,v){N(b,e,v),g(e,l),g(e,n),g(e,o),Te(o,r[1]),N(b,s,v),N(b,a,v),g(a,i),g(a,f),F(d,a,null),_=!0,m||(y=le(o,"input",r[3]),m=!0)},p(b,v){v&2&&o.value!==b[1]&&Te(o,b[1])},i(b){_||(C(d.$$.fragment,b),_=!0)},o(b){D(d.$$.fragment,b),_=!1},d(b){b&&(u(e),u(s),u(a)),G(d),m=!1,y()}}}function Or(r){let e,l;return e=new Ar({props:{title:"New Sheet",onClick:r[4],$$slots:{default:[Br]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,[n]){const o={};n&3&&(o.onClick=t[4]),n&34&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Pr(r,e,l){let{onAdd:t=async(i,c)=>{}}=e,n="",o={};function s(){n=this.value,l(1,n)}const a=()=>t(n,o);return r.$$set=i=>{"onAdd"in i&&l(0,t=i.onAdd)},[t,n,o,s,a]}class Ur extends ve{constructor(e){super(),be(this,e,Pr,Or,de,{onAdd:0})}}const Mr=r=>({}),kl=r=>({}),Rr=r=>({}),wl=r=>({}),Hr=r=>({}),yl=r=>({});function Cl(r,e,l){const t=r.slice();return t[11]=e[l],t}function jr(r){let e,l=re(r[7]),t=[];for(let n=0;n<l.length;n+=1)t[n]=El(Cl(r,l,n));return{c(){e=k("div");for(let n=0;n<t.length;n+=1)t[n].c();this.h()},l(n){e=w(n,"DIV",{class:!0});var o=I(e);for(let s=0;s<t.length;s+=1)t[s].l(o);o.forEach(u),this.h()},h(){h(e,"class","flex flex-row border flex-nowrap overflow-auto")},m(n,o){N(n,e,o);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(e,null)},p(n,o){if(o&193){l=re(n[7]);let s;for(s=0;s<l.length;s+=1){const a=Cl(n,l,s);t[s]?t[s].p(a,o):(t[s]=El(a),t[s].c(),t[s].m(e,null))}for(;s<t.length;s+=1)t[s].d(1);t.length=l.length}},d(n){n&&u(e),ye(t,n)}}}function zr(r){let e,l;return{c(){e=k("h1"),l=Z(r[1]),this.h()},l(t){e=w(t,"H1",{class:!0});var n=I(e);l=W(n,r[1]),n.forEach(u),this.h()},h(){h(e,"class","block mb-2 text-lg font-bold text-gray-700")},m(t,n){N(t,e,n),g(e,l)},p(t,n){n&2&&_e(l,t[1])},d(t){t&&u(e)}}}function Fr(r){let e,l=r[11]+"",t,n,o;function s(){return r[10](r[11])}return{c(){e=k("button"),t=Z(l),this.h()},l(a){e=w(a,"BUTTON",{class:!0});var i=I(e);t=W(i,l),i.forEach(u),this.h()},h(){h(e,"class","text-gray-600 p-2 block hover:text-blue-500 focus:outline-none")},m(a,i){N(a,e,i),g(e,t),n||(o=le(e,"click",s),n=!0)},p(a,i){r=a},d(a){a&&u(e),n=!1,o()}}}function Gr(r){let e,l,t;return{c(){e=k("button"),l=Z(r[0]),t=O(),this.h()},l(n){e=w(n,"BUTTON",{class:!0});var o=I(e);l=W(o,r[0]),t=P(o),o.forEach(u),this.h()},h(){h(e,"class","p-2 hover:text-blue-500 focus:outline-none text-blue-500 border-b-2 font-medium border-blue-500 inline-flex")},m(n,o){N(n,e,o),g(e,l),g(e,t)},p(n,o){o&1&&_e(l,n[0])},d(n){n&&u(e)}}}function El(r){let e;function l(o,s){return o[0]==o[11]?Gr:Fr}let t=l(r),n=t(r);return{c(){n.c(),e=ne()},l(o){n.l(o),e=ne()},m(o,s){n.m(o,s),N(o,e,s)},p(o,s){t===(t=l(o))&&n?n.p(o,s):(n.d(1),n=t(o),n&&(n.c(),n.m(e.parentNode,e)))},d(o){o&&u(e),n.d(o)}}}function qr(r){let e,l,t,n;const o=[Wr,Zr,Yr],s=[];function a(i,c){return i[0]==="EDIT"?0:i[0]==="RELATIONS"?1:i[0]==="HISTORY"?2:-1}return~(l=a(r))&&(t=s[l]=o[l](r)),{c(){e=k("div"),t&&t.c(),this.h()},l(i){e=w(i,"DIV",{class:!0});var c=I(e);t&&t.l(c),c.forEach(u),this.h()},h(){h(e,"class","flex flex-col flex-grow gap-2")},m(i,c){N(i,e,c),~l&&s[l].m(e,null),n=!0},p(i,c){let f=l;l=a(i),l===f?~l&&s[l].p(i,c):(t&&(se(),D(s[f],1,1,()=>{s[f]=null}),ie()),~l?(t=s[l],t?t.p(i,c):(t=s[l]=o[l](i),t.c()),C(t,1),t.m(e,null)):t=null)},i(i){n||(C(t),n=!0)},o(i){D(t),n=!1},d(i){i&&u(e),~l&&s[l].d()}}}function Jr(r){let e,l;const t=r[9].default,n=Ye(t,r,r[8],null);return{c(){e=k("div"),n&&n.c(),this.h()},l(o){e=w(o,"DIV",{class:!0});var s=I(e);n&&n.l(s),s.forEach(u),this.h()},h(){h(e,"class","flex flex-col flex-grow gap-2")},m(o,s){N(o,e,s),n&&n.m(e,null),l=!0},p(o,s){n&&n.p&&(!l||s&256)&&Ze(n,t,o,o[8],l?Ke(t,o[8],s,null):We(o[8]),null)},i(o){l||(C(n,o),l=!0)},o(o){D(n,o),l=!1},d(o){o&&u(e),n&&n.d(o)}}}function Yr(r){let e;const l=r[9].history,t=Ye(l,r,r[8],kl),n=t||Kr();return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){t&&t.p&&(!e||s&256)&&Ze(t,l,o,o[8],e?Ke(l,o[8],s,Mr):We(o[8]),kl)},i(o){e||(C(n,o),e=!0)},o(o){D(n,o),e=!1},d(o){n&&n.d(o)}}}function Zr(r){let e;const l=r[9].relation,t=Ye(l,r,r[8],wl),n=t||Xr();return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){t&&t.p&&(!e||s&256)&&Ze(t,l,o,o[8],e?Ke(l,o[8],s,Rr):We(o[8]),wl)},i(o){e||(C(n,o),e=!0)},o(o){D(n,o),e=!1},d(o){n&&n.d(o)}}}function Wr(r){let e;const l=r[9].edit,t=Ye(l,r,r[8],yl),n=t||Qr();return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){t&&t.p&&(!e||s&256)&&Ze(t,l,o,o[8],e?Ke(l,o[8],s,Hr):We(o[8]),yl)},i(o){e||(C(n,o),e=!0)},o(o){D(n,o),e=!1},d(o){n&&n.d(o)}}}function Kr(r){let e;return{c(){e=Z("Empty history template")},l(l){e=W(l,"Empty history template")},m(l,t){N(l,e,t)},d(l){l&&u(e)}}}function Xr(r){let e;return{c(){e=Z("Empty relations template")},l(l){e=W(l,"Empty relations template")},m(l,t){N(l,e,t)},d(l){l&&u(e)}}}function Qr(r){let e;return{c(){e=Z("Empty Edit template")},l(l){e=W(l,"Empty Edit template")},m(l,t){N(l,e,t)},d(l){l&&u(e)}}}function xr(r){let e,l,t,n;return e=new ct({props:{name:"Save",onClick:r[2],loading:pn}}),t=new ct({props:{name:"Delete",onClick:r[3],loading:lo,color:"red"}}),{c(){j(e.$$.fragment),l=O(),j(t.$$.fragment)},l(o){z(e.$$.fragment,o),l=P(o),z(t.$$.fragment,o)},m(o,s){F(e,o,s),N(o,l,s),F(t,o,s),n=!0},p(o,s){const a={};s&4&&(a.onClick=o[2]),e.$set(a);const i={};s&8&&(i.onClick=o[3]),t.$set(i)},i(o){n||(C(e.$$.fragment,o),C(t.$$.fragment,o),n=!0)},o(o){D(e.$$.fragment,o),D(t.$$.fragment,o),n=!1},d(o){o&&u(l),G(e,o),G(t,o)}}}function eo(r){let e,l;return e=new ct({props:{name:"Save",onClick:r[2],loading:pn}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n&4&&(o.onClick=t[2]),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function to(r){let e,l,t,n,o,s,a,i,c,f,d,_,m,y,b='<div class="border-l-red-400"></div> <div class="border-l-blue-400"></div> <div class="border-l-green-400"></div> <div class="border-l-gray-400"></div> <div class="border-l-yellow-400"></div> <div class="border-l-zinc-400"></div> <div class="border-l-emerald-400"></div> <div class="border-l-orange-400"></div> <div class="border-l-lime-400"></div> <div class="border-l-amber-400"></div> <div class="border-l-teal-400"></div> <div class="border-l-cyan-400"></div> <div class="border-l-sky-400"></div> <div class="border-l-indigo-400"></div> <div class="border-l-violet-400"></div> <div class="border-l-purple-400"></div> <div class="border-l-fuchsia-400"></div> <div class="border-l-pink-400"></div> <div class="bg-red-400"></div> <div class="bg-blue-400"></div> <div class="bg-green-400"></div> <div class="bg-gray-400"></div> <div class="bg-yellow-400"></div> <div class="bg-zinc-400"></div> <div class="bg-emerald-400"></div> <div class="bg-orange-400"></div> <div class="bg-lime-400"></div> <div class="bg-amber-400"></div> <div class="bg-teal-400"></div> <div class="bg-cyan-400"></div> <div class="bg-sky-400"></div> <div class="bg-indigo-400"></div> <div class="bg-violet-400"></div> <div class="bg-purple-400"></div> <div class="bg-fuchsia-400"></div> <div class="bg-pink-400"></div>',v;function $(A,B){return A[5]?zr:jr}let T=$(r),S=T(r);const E=[Jr,qr],p=[];function V(A,B){return A[5]?0:1}a=V(r),i=p[a]=E[a](r);const L=[eo,xr],K=[];function M(A,B){return A[5]?0:A[0]==="EDIT"?1:-1}return~(d=M(r))&&(_=K[d]=L[d](r)),{c(){e=k("div"),l=k("p"),t=Z(r[4]),n=O(),o=k("div"),S.c(),s=O(),i.c(),c=O(),f=k("div"),_&&_.c(),m=O(),y=k("div"),y.innerHTML=b,this.h()},l(A){e=w(A,"DIV",{class:!0});var B=I(e);l=w(B,"P",{class:!0});var q=I(l);t=W(q,r[4]),q.forEach(u),n=P(B),o=w(B,"DIV",{class:!0});var ee=I(o);S.l(ee),ee.forEach(u),s=P(B),i.l(B),c=P(B),f=w(B,"DIV",{class:!0});var fe=I(f);_&&_.l(fe),fe.forEach(u),B.forEach(u),m=P(A),y=w(A,"DIV",{class:!0,"data-svelte-h":!0}),ue(y)!=="svelte-1cq7ao8"&&(y.innerHTML=b),this.h()},h(){h(l,"class","text-red-500"),h(o,"class","mb-4 border-b"),h(f,"class","flex justify-end gap-2 border-t"),h(e,"class","flex flex-col h-full"),h(y,"class","hidden")},m(A,B){N(A,e,B),g(e,l),g(l,t),g(e,n),g(e,o),S.m(o,null),g(e,s),p[a].m(e,null),g(e,c),g(e,f),~d&&K[d].m(f,null),N(A,m,B),N(A,y,B),v=!0},p(A,[B]){(!v||B&16)&&_e(t,A[4]),T===(T=$(A))&&S?S.p(A,B):(S.d(1),S=T(A),S&&(S.c(),S.m(o,null)));let q=a;a=V(A),a===q?p[a].p(A,B):(se(),D(p[q],1,1,()=>{p[q]=null}),ie(),i=p[a],i?i.p(A,B):(i=p[a]=E[a](A),i.c()),C(i,1),i.m(e,c));let ee=d;d=M(A),d===ee?~d&&K[d].p(A,B):(_&&(se(),D(K[ee],1,1,()=>{K[ee]=null}),ie()),~d?(_=K[d],_?_.p(A,B):(_=K[d]=L[d](A),_.c()),C(_,1),_.m(f,null)):_=null)},i(A){v||(C(i),C(_),v=!0)},o(A){D(i),D(_),v=!1},d(A){A&&(u(e),u(m),u(y)),S.d(),p[a].d(),~d&&K[d].d()}}}let pn=!1,lo=!1;function no(r,e,l){let{$$slots:t={},$$scope:n}=e,{title:o}=e,{onSave:s}=e,{onDelete:a=void 0}=e,{message:i=""}=e,{new_record:c=!0}=e,{mode:f="EDIT"}=e;const d=y=>{f!==y&&l(0,f=y)},_=["EDIT","RELATIONS","HISTORY"],m=y=>d(y);return r.$$set=y=>{"title"in y&&l(1,o=y.title),"onSave"in y&&l(2,s=y.onSave),"onDelete"in y&&l(3,a=y.onDelete),"message"in y&&l(4,i=y.message),"new_record"in y&&l(5,c=y.new_record),"mode"in y&&l(0,f=y.mode),"$$scope"in y&&l(8,n=y.$$scope)},[f,o,s,a,i,c,d,_,n,t,m]}class kn extends ve{constructor(e){super(),be(this,e,no,to,de,{title:1,onSave:2,onDelete:3,message:4,new_record:5,mode:0,setMode:6})}get setMode(){return this.$$.ctx[6]}}function ro(r){let e;return{c(){e=Z("Select a location")},l(l){e=W(l,"Select a location")},m(l,t){N(l,e,t)},d(l){l&&u(e)}}}function oo(r){let e,l;return e=new $n({props:{$$slots:{default:[ro]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n&2048&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function so(r){let e,l,t,n,o,s,a,i,c,f;return e=new In({props:{url:ao,options:r[4]}}),t=new Nn({props:{latLng:r[1],$$slots:{default:[oo]},$$scope:{ctx:r}}}),a=new De({props:{name:"location-marker",class:"h-4 w-4"}}),{c(){j(e.$$.fragment),l=O(),j(t.$$.fragment),n=O(),o=k("div"),s=k("button"),j(a.$$.fragment),this.h()},l(d){z(e.$$.fragment,d),l=P(d),z(t.$$.fragment,d),n=P(d),o=w(d,"DIV",{class:!0,style:!0});var _=I(o);s=w(_,"BUTTON",{class:!0});var m=I(s);z(a.$$.fragment,m),m.forEach(u),_.forEach(u),this.h()},h(){h(s,"class","p-1 bg-blue-400 hover:bg-blue-700 inline-flex text-white rounded-full"),h(o,"class","absolute right-0 top-0 p-1 flex gap-1"),Fe(o,"z-index","999")},m(d,_){F(e,d,_),N(d,l,_),F(t,d,_),N(d,n,_),N(d,o,_),g(o,s),F(a,s,null),i=!0,c||(f=le(s,"click",r[8]),c=!0)},p(d,_){const m={};_&2&&(m.latLng=d[1]),_&2048&&(m.$$scope={dirty:_,ctx:d}),t.$set(m)},i(d){i||(C(e.$$.fragment,d),C(t.$$.fragment,d),C(a.$$.fragment,d),i=!0)},o(d){D(e.$$.fragment,d),D(t.$$.fragment,d),D(a.$$.fragment,d),i=!1},d(d){d&&(u(l),u(n),u(o)),G(e,d),G(t,d),G(a),c=!1,f()}}}function io(r){let e,l,t="",n,o,s,a,i,c;return i=new Dn({props:{options:r[3],events:["click"],$$slots:{default:[so]},$$scope:{ctx:r}}}),i.$on("click",r[6]),{c(){e=k("link"),l=k("script"),l.innerHTML=t,o=O(),s=k("div"),a=k("div"),j(i.$$.fragment),this.h()},l(f){const d=Cn("svelte-zky8rx",document.head);e=w(d,"LINK",{rel:!0,href:!0,integrity:!0,crossorigin:!0}),l=w(d,"SCRIPT",{src:!0,integrity:!0,crossorigin:!0,"data-svelte-h":!0}),ue(l)!=="svelte-xpm1dw"&&(l.innerHTML=t),d.forEach(u),o=P(f),s=w(f,"DIV",{class:!0});var _=I(s);a=w(_,"DIV",{class:!0});var m=I(a);z(i.$$.fragment,m),m.forEach(u),_.forEach(u),this.h()},h(){h(e,"rel","stylesheet"),h(e,"href","https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"),h(e,"integrity","sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="),h(e,"crossorigin",""),Ge(l.src,n="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js")||h(l,"src",n),h(l,"integrity","sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="),h(l,"crossorigin",""),h(a,"class","w-full grow shadow rounded"),h(s,"class","w-full h-full flex flex-col")},m(f,d){g(document.head,e),g(document.head,l),N(f,o,d),N(f,s,d),g(s,a),F(i,a,null),c=!0},p(f,[d]){const _={};d&2055&&(_.$$scope={dirty:d,ctx:f}),i.$set(_)},i(f){c||(C(i.$$.fragment,f),c=!0)},o(f){D(i.$$.fragment,f),c=!1},d(f){f&&(u(o),u(s)),u(e),u(l),G(i)}}}const ao="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png";function co(r,e,l){let{value:t="{}"}=e,{onChange:n=y=>{}}=e;const[o,s]=Bn(t),a={center:[o,s],zoom:11},i={minZoom:0,maxZoom:20,maxNativeZoom:19,attribution:"© OpenStreetMap contributors"},c=[o,s],f=[...c];function d(){l(1,c[0]=f[0],c),l(1,c[1]=f[1],c)}function _(y){const b=y.detail.latlng;l(2,f[0]=b.lat,f),l(2,f[1]=b.lng,f)}const m=()=>{d(),n(On(f[0],f[1]))};return r.$$set=y=>{"value"in y&&l(7,t=y.value),"onChange"in y&&l(0,n=y.onChange)},[n,c,f,a,i,d,_,t,m]}class fo extends ve{constructor(e){super(),be(this,e,co,io,de,{value:7,onChange:0})}}function Tl(r,e,l){const t=r.slice();return t[6]=e[l],t}function uo(r){let e,l=re(r[3]),t=[];for(let n=0;n<l.length;n+=1)t[n]=Sl(Tl(r,l,n));return{c(){e=k("div");for(let n=0;n<t.length;n+=1)t[n].c();this.h()},l(n){e=w(n,"DIV",{class:!0});var o=I(e);for(let s=0;s<t.length;s+=1)t[s].l(o);o.forEach(u),this.h()},h(){h(e,"class","w-full flex gap-1 flex-wrap")},m(n,o){N(n,e,o);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(e,null)},p(n,o){if(o&11){l=re(n[3]);let s;for(s=0;s<l.length;s+=1){const a=Tl(n,l,s);t[s]?t[s].p(a,o):(t[s]=Sl(a),t[s].c(),t[s].m(e,null))}for(;s<t.length;s+=1)t[s].d(1);t.length=l.length}},i:Y,o:Y,d(n){n&&u(e),ye(t,n)}}}function _o(r){let e,l;return e=new tt({props:{classes:""}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p:Y,i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Sl(r){let e,l,t,n,o,s=r[6].name+"",a,i,c,f="Add",d,_,m;function y(){return r[4](r[6])}return{c(){e=k("div"),l=k("img"),n=O(),o=k("span"),a=Z(s),i=O(),c=k("button"),c.textContent=f,d=O(),this.h()},l(b){e=w(b,"DIV",{class:!0});var v=I(e);l=w(v,"IMG",{class:!0,src:!0,alt:!0}),n=P(v),o=w(v,"SPAN",{class:!0});var $=I(o);a=W($,s),$.forEach(u),i=P(v),c=w(v,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(c)!=="svelte-b17lrd"&&(c.textContent=f),d=P(v),v.forEach(u),this.h()},h(){h(l,"class","h-auto w-24 p-1 rounded"),Ge(l.src,t=r[0].getFilePreviewUrl(r[6].name))||h(l,"src",t),h(l,"alt",""),h(o,"class","text-xs text-gray-600 truncate overflow-hidden whitespace-nowrap"),h(c,"class","hover:bg-blue-500 w-full rounded text-gray-600 hover:text-white font-semibold text-xs bg-blue-100"),h(e,"class","w-24 overflow-hidden border hover:border-blue-500 cursor-pointer border-gray-100 rounded")},m(b,v){N(b,e,v),g(e,l),g(e,n),g(e,o),g(o,a),g(e,i),g(e,c),g(e,d),_||(m=le(c,"click",y),_=!0)},p(b,v){r=b,v&9&&!Ge(l.src,t=r[0].getFilePreviewUrl(r[6].name))&&h(l,"src",t),v&8&&s!==(s=r[6].name+"")&&_e(a,s)},d(b){b&&u(e),_=!1,m()}}}function ho(r){let e,l,t,n;const o=[_o,uo],s=[];function a(i,c){return i[2]?0:1}return l=a(r),t=s[l]=o[l](r),{c(){e=k("div"),t.c(),this.h()},l(i){e=w(i,"DIV",{class:!0});var c=I(e);t.l(c),c.forEach(u),this.h()},h(){h(e,"class","h-full w-full bg-gray-50")},m(i,c){N(i,e,c),s[l].m(e,null),n=!0},p(i,[c]){let f=l;l=a(i),l===f?s[l].p(i,c):(se(),D(s[f],1,1,()=>{s[f]=null}),ie(),t=s[l],t?t.p(i,c):(t=s[l]=o[l](i),t.c()),C(t,1),t.m(e,null))},i(i){n||(C(t),n=!0)},o(i){D(t),n=!1},d(i){i&&u(e),s[l].d()}}}function mo(r,e,l){let{folder_api:t}=e,{onFileAdd:n=c=>{}}=e,o=!0,s=[];(async()=>{const c=await t.list();c.ok&&(l(3,s=c.data),l(2,o=!1))})();const i=c=>n(c.name);return r.$$set=c=>{"folder_api"in c&&l(0,t=c.folder_api),"onFileAdd"in c&&l(1,n=c.onFileAdd)},[t,n,o,s,i]}class go extends ve{constructor(e){super(),be(this,e,mo,ho,de,{folder_api:0,onFileAdd:1})}}function Dl(r){let e,l,t,n,o;return l=new De({props:{class:"w-6 h-6 p-0.5 rounded border hover:bg-yellow-100",name:r[2]}}),{c(){e=k("button"),j(l.$$.fragment)},l(s){e=w(s,"BUTTON",{});var a=I(e);z(l.$$.fragment,a),a.forEach(u)},m(s,a){N(s,e,a),F(l,e,null),t=!0,n||(o=le(e,"click",r[5]),n=!0)},p(s,a){const i={};a&4&&(i.name=s[2]),l.$set(i)},i(s){t||(C(l.$$.fragment,s),t=!0)},o(s){D(l.$$.fragment,s),t=!1},d(s){s&&u(e),G(l),n=!1,o()}}}function Il(r){let e,l,t,n,o;return l=new De({props:{class:"w-6 h-6 p-0.5 rounded border hover:bg-yellow-100",name:"x"}}),{c(){e=k("button"),j(l.$$.fragment)},l(s){e=w(s,"BUTTON",{});var a=I(e);z(l.$$.fragment,a),a.forEach(u)},m(s,a){N(s,e,a),F(l,e,null),t=!0,n||(o=le(e,"click",r[6]),n=!0)},p:Y,i(s){t||(C(l.$$.fragment,s),t=!0)},o(s){D(l.$$.fragment,s),t=!1},d(s){s&&u(e),G(l),n=!1,o()}}}function vo(r){let e,l,t,n,o,s,a,i,c=r[2]!==void 0&&!r[0]&&Dl(r);n=new De({props:{name:"color-swatch",class:"h-5 w-5 p-0.5 rounded border hover:bg-yellow-100"}});let f=r[0]&&Il(r);return{c(){e=k("div"),c&&c.c(),l=O(),t=k("button"),j(n.$$.fragment),o=O(),f&&f.c(),this.h()},l(d){e=w(d,"DIV",{class:!0});var _=I(e);c&&c.l(_),l=P(_),t=w(_,"BUTTON",{});var m=I(t);z(n.$$.fragment,m),m.forEach(u),o=P(_),f&&f.l(_),_.forEach(u),this.h()},h(){h(e,"class","flex gap-1 justify-end mt-1")},m(d,_){N(d,e,_),c&&c.m(e,null),g(e,l),g(e,t),F(n,t,null),g(e,o),f&&f.m(e,null),s=!0,a||(i=le(t,"click",function(){Oe(r[4])&&r[4].apply(this,arguments)}),a=!0)},p(d,[_]){r=d,r[2]!==void 0&&!r[0]?c?(c.p(r,_),_&5&&C(c,1)):(c=Dl(r),c.c(),C(c,1),c.m(e,l)):c&&(se(),D(c,1,1,()=>{c=null}),ie()),r[0]?f?(f.p(r,_),_&1&&C(f,1)):(f=Il(r),f.c(),C(f,1),f.m(e,null)):f&&(se(),D(f,1,1,()=>{f=null}),ie())},i(d){s||(C(c),C(n.$$.fragment,d),C(f),s=!0)},o(d){D(c),D(n.$$.fragment,d),D(f),s=!1},d(d){d&&u(e),c&&c.d(),G(n),f&&f.d(),a=!1,i()}}}function bo(r,e,l){let{is_cell_open:t=!1}=e,{onCellClose:n=void 0}=e,{pick_icon:o=void 0}=e,{onPick:s=void 0}=e,{onCellColor:a}=e;const i=()=>s&&s(),c=()=>n&&n();return r.$$set=f=>{"is_cell_open"in f&&l(0,t=f.is_cell_open),"onCellClose"in f&&l(1,n=f.onCellClose),"pick_icon"in f&&l(2,o=f.pick_icon),"onPick"in f&&l(3,s=f.onPick),"onCellColor"in f&&l(4,a=f.onCellColor)},[t,n,o,s,a,i,c]}class po extends ve{constructor(e){super(),be(this,e,bo,vo,de,{is_cell_open:0,onCellClose:1,pick_icon:2,onPick:3,onCellColor:4})}}function ko(r){let e,l;return e=new yt({props:{editable:!1,cells:r[1].cells||{},columns:r[1].columns||[],rows:r[1].rows||[],folder_api:null,selected_rows:[]}}),e.$on("pick_row",r[2]),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n&2&&(o.cells=t[1].cells||{}),n&2&&(o.columns=t[1].columns||[]),n&2&&(o.rows=t[1].rows||[]),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function wo(r){let e,l;return e=new tt({props:{classes:""}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p:Y,i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function yo(r){let e,l,t,n;const o=[wo,ko],s=[];function a(i,c){return i[0]?0:1}return e=a(r),l=s[e]=o[e](r),{c(){l.c(),t=ne()},l(i){l.l(i),t=ne()},m(i,c){s[e].m(i,c),N(i,t,c),n=!0},p(i,[c]){let f=e;e=a(i),e===f?s[e].p(i,c):(se(),D(s[f],1,1,()=>{s[f]=null}),ie(),l=s[e],l?l.p(i,c):(l=s[e]=o[e](i),l.c()),C(l,1),l.m(t.parentNode,t))},i(i){n||(C(l),n=!0)},o(i){D(l),n=!1},d(i){i&&u(t),s[e].d(i)}}}function Co(r,e,l){let{current:t=void 0}=e,{onSelect:n=d=>{}}=e,{service:o}=e,{column:s}=e,a=!0,i;const c=async()=>{if(!s.refsheet){console.log("invalid refsheet",s);return}l(0,a=!0),l(1,i=await o.ref_sheet_query({column_id:s.__id,row_cursor_id:0,target_source:s.extraopts.ref_source,target_group:s.extraopts.ref_group,target_sheet_id:s.refsheet})),l(0,a=!1)},f=d=>{const _=d.detail.__id,y=(i.cells[_]||{})[s.refcolumn]||{},b=String(y.value||"");n({__id:_,ref_value:b})};return c(),r.$$set=d=>{"current"in d&&l(3,t=d.current),"onSelect"in d&&l(4,n=d.onSelect),"service"in d&&l(5,o=d.service),"column"in d&&l(6,s=d.column)},[a,i,f,t,n,o,s]}class Eo extends ve{constructor(e){super(),be(this,e,Co,yo,de,{current:3,onSelect:4,service:5,column:6})}}function To(r){let e,l="Remote";return{c(){e=k("div"),e.textContent=l},l(t){e=w(t,"DIV",{"data-svelte-h":!0}),ue(e)!=="svelte-kpsom"&&(e.textContent=l)},m(t,n){N(t,e,n)},p:Y,i:Y,o:Y,d(t){t&&u(e)}}}function So(r,e,l){let{current:t=""}=e;return r.$$set=n=>{"current"in n&&l(0,t=n.current)},[t]}class Do extends ve{constructor(e){super(),be(this,e,So,To,de,{current:0})}}function Nl(r,e,l){const t=r.slice();return t[3]=e[l],t}function $l(r){let e,l=r[3]+"",t;return{c(){e=k("option"),t=Z(l),this.h()},l(n){e=w(n,"OPTION",{});var o=I(e);t=W(o,l),o.forEach(u),this.h()},h(){e.__value=r[3],Te(e,e.__value)},m(n,o){N(n,e,o),g(e,t)},p:Y,d(n){n&&u(e)}}}function Vl(r){let e,l,t;return{c(){e=k("input"),this.h()},l(n){e=w(n,"INPUT",{type:!0}),this.h()},h(){h(e,"type","color"),e.value=r[0]},m(n,o){N(n,e,o),l||(t=le(e,"change",function(){Oe(r[1])&&r[1].apply(this,arguments)}),l=!0)},p(n,o){r=n,o&5&&(e.value=r[0])},d(n){n&&u(e),l=!1,t()}}}function Io(r){let e,l,t,n,o,s="Custom",a,i=r[0]&&r[0].startsWith("#"),c,f,d=re(r[2]),_=[];for(let y=0;y<d.length;y+=1)_[y]=$l(Nl(r,d,y));let m=i&&Vl(r);return{c(){e=k("div"),l=k("label"),t=Z(`Color

    `),n=k("select");for(let y=0;y<_.length;y+=1)_[y].c();o=k("option"),o.textContent=s,a=O(),m&&m.c(),this.h()},l(y){e=w(y,"DIV",{class:!0});var b=I(e);l=w(b,"LABEL",{class:!0});var v=I(l);t=W(v,`Color

    `),n=w(v,"SELECT",{class:!0});var $=I(n);for(let T=0;T<_.length;T+=1)_[T].l($);o=w($,"OPTION",{"data-svelte-h":!0}),ue(o)!=="svelte-fxhb72"&&(o.textContent=s),$.forEach(u),a=P(v),m&&m.l(v),v.forEach(u),b.forEach(u),this.h()},h(){o.__value="#ffff",Te(o,o.__value),h(n,"class","p-1 rouned w-20"),h(l,"class","flex gap-2"),h(e,"class","border rounded shadow p-4 mt-2 border-blue-500 overflow-auto")},m(y,b){N(y,e,b),g(e,l),g(l,t),g(l,n);for(let v=0;v<_.length;v+=1)_[v]&&_[v].m(n,null);g(n,o),Ve(n,r[0]),g(l,a),m&&m.m(l,null),c||(f=le(n,"change",function(){Oe(r[1])&&r[1].apply(this,arguments)}),c=!0)},p(y,[b]){if(r=y,b&4){d=re(r[2]);let v;for(v=0;v<d.length;v+=1){const $=Nl(r,d,v);_[v]?_[v].p($,b):(_[v]=$l($),_[v].c(),_[v].m(n,o))}for(;v<_.length;v+=1)_[v].d(1);_.length=d.length}b&5&&Ve(n,r[0]),b&1&&(i=r[0]&&r[0].startsWith("#")),i?m?m.p(r,b):(m=Vl(r),m.c(),m.m(l,null)):m&&(m.d(1),m=null)},i:Y,o:Y,d(y){y&&u(e),ye(_,y),m&&m.d(),c=!1,f()}}}function No(r,e,l){let{color:t=""}=e,{onColorChange:n}=e;const o=["red","blue","green","gray","yellow","zinc","emerald","orange","lime","amber","teal","cyan","sky","indigo","violet","purple","fuchsia","pink"];return r.$$set=s=>{"color"in s&&l(0,t=s.color),"onColorChange"in s&&l(1,n=s.onColorChange)},[t,n,o]}class $o extends ve{constructor(e){super(),be(this,e,No,Io,de,{color:0,onColorChange:1})}}function Ll(r,e,l){const t=r.slice();return t[5]=e[l],t}function Al(r){let e,l,t,n,o=r[5]+"",s,a,i,c;return{c(){e=k("label"),l=k("input"),n=O(),s=Z(o),a=O(),this.h()},l(f){e=w(f,"LABEL",{});var d=I(e);l=w(d,"INPUT",{type:!0,class:!0}),n=P(d),s=W(d,o),a=P(d),d.forEach(u),this.h()},h(){h(l,"type","checkbox"),l.checked=t=r[1].includes(r[5]),h(l,"class","form-checkbox h-5 w-5 text-gray-600")},m(f,d){N(f,e,d),g(e,l),g(e,n),g(e,s),g(e,a),i||(c=le(l,"change",function(){Oe(r[2](r[5]))&&r[2](r[5]).apply(this,arguments)}),i=!0)},p(f,d){r=f,d&3&&t!==(t=r[1].includes(r[5]))&&(l.checked=t),d&1&&o!==(o=r[5]+"")&&_e(s,o)},d(f){f&&u(e),i=!1,c()}}}function Vo(r){let e,l,t=re(r[0]),n=[];for(let o=0;o<t.length;o+=1)n[o]=Al(Ll(r,t,o));return{c(){e=k("div"),l=k("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=w(o,"DIV",{class:!0});var s=I(e);l=w(s,"DIV",{class:!0,style:!0});var a=I(l);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(u),s.forEach(u),this.h()},h(){h(l,"class","flex flex-col pl-4 p-1 space-y-1 border border-dashed rounded-lg bg-gray-50 text-gray-800"),Fe(l,"min-height","2rem"),h(e,"class","flex flex-col w-full p-1 overflow-auto")},m(o,s){N(o,e,s),g(e,l);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(l,null)},p(o,[s]){if(s&7){t=re(o[0]);let a;for(a=0;a<t.length;a+=1){const i=Ll(o,t,a);n[a]?n[a].p(i,s):(n[a]=Al(i),n[a].c(),n[a].m(l,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=t.length}},i:Y,o:Y,d(o){o&&u(e),ye(n,o)}}}function Lo(r,e,l){let t,{value:n}=e,{onChange:o}=e,{options:s}=e;const a=i=>c=>{c.target.checked?l(1,t=[...new Set([...t,i])]):l(1,t=[...new Set(t.filter(f=>f!==i))]),o(Un(t))};return r.$$set=i=>{"value"in i&&l(3,n=i.value),"onChange"in i&&l(4,o=i.onChange),"options"in i&&l(0,s=i.options)},r.$$.update=()=>{r.$$.dirty&8&&l(1,t=Pn(n))},[s,t,a,n,o]}class Ao extends ve{constructor(e){super(),be(this,e,Lo,Vo,de,{value:3,onChange:4,options:0})}}function Bl(r,e,l){const t=r.slice();t[7]=e[l];const n=t[7].user_id;return t[8]=n,t}function Ol(r){let e,l,t,n,o=(r[7].full_name||"")+"",s,a,i,c=(r[7].group||"")+"",f,d,_,m="+",y,b,v,$;l=new Vn({props:{user:r[8],url:r[0].profile_genrator(r[8])}});function T(){return r[4](r[8])}return{c(){e=k("div"),j(l.$$.fragment),t=O(),n=k("span"),s=Z(o),a=O(),i=k("strong"),f=Z(c),d=O(),_=k("button"),_.textContent=m,y=O(),this.h()},l(S){e=w(S,"DIV",{class:!0});var E=I(e);z(l.$$.fragment,E),t=P(E),n=w(E,"SPAN",{class:!0});var p=I(n);s=W(p,o),p.forEach(u),a=P(E),i=w(E,"STRONG",{class:!0});var V=I(i);f=W(V,c),V.forEach(u),d=P(E),_=w(E,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(_)!=="svelte-1c3zyet"&&(_.textContent=m),y=P(E),E.forEach(u),this.h()},h(){h(n,"class","text-gray-500"),h(i,"class","bg-gray-100 text-xs text-gray-500 flex-inline self-center rounded-lg p-0.5"),h(_,"class","hover:bg-blue-500 w-10 rounded-full text-gray-600 hover:text-white font-semibold text-xs bg-blue-100"),h(e,"class","flex hover:bg-blue-200 justify-between p-1 rounded cursor-pointer")},m(S,E){N(S,e,E),F(l,e,null),g(e,t),g(e,n),g(n,s),g(e,a),g(e,i),g(i,f),g(e,d),g(e,_),g(e,y),b=!0,v||($=le(_,"click",T),v=!0)},p(S,E){r=S;const p={};E&4&&(p.user=r[8]),E&5&&(p.url=r[0].profile_genrator(r[8])),l.$set(p),(!b||E&4)&&o!==(o=(r[7].full_name||"")+"")&&_e(s,o),(!b||E&4)&&c!==(c=(r[7].group||"")+"")&&_e(f,c)},i(S){b||(C(l.$$.fragment,S),b=!0)},o(S){D(l.$$.fragment,S),b=!1},d(S){S&&u(e),G(l),v=!1,$()}}}function Bo(r){let e,l,t=re(r[2]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Ol(Bl(r,t,s));const o=s=>D(n[s],1,1,()=>{n[s]=null});return{c(){e=k("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){e=w(s,"DIV",{class:!0});var a=I(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(u),this.h()},h(){h(e,"class","flex flex-col p-1")},m(s,a){N(s,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);l=!0},p(s,[a]){if(a&7){t=re(s[2]);let i;for(i=0;i<t.length;i+=1){const c=Bl(s,t,i);n[i]?(n[i].p(c,a),C(n[i],1)):(n[i]=Ol(c),n[i].c(),C(n[i],1),n[i].m(e,null))}for(se(),i=t.length;i<n.length;i+=1)o(i);ie()}},i(s){if(!l){for(let a=0;a<t.length;a+=1)C(n[a]);l=!0}},o(s){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)D(n[a]);l=!1},d(s){s&&u(e),ye(n,s)}}}function Oo(r,e,l){let{service:t}=e,{column:n}=e,{onUserAdd:o=c=>{}}=e,s=[];(async()=>{const c=await t.api.list_users({target_type:"sheet",target:`${t.sheetid}/${n.__id}`});c.ok&&l(2,s=c.data)})();const i=c=>o(c);return r.$$set=c=>{"service"in c&&l(0,t=c.service),"column"in c&&l(3,n=c.column),"onUserAdd"in c&&l(1,o=c.onUserAdd)},[t,o,s,n,i]}class Po extends ve{constructor(e){super(),be(this,e,Oo,Bo,de,{service:0,column:3,onUserAdd:1})}}function Pl(r,e,l){const t=r.slice();return t[31]=e[l],t}function Ul(r,e,l){const t=r.slice();return t[37]=e[l],t}function Ml(r,e,l){const t=r.slice();return t[34]=e[l],t}function Rl(r,e,l){const t=r.slice();return t[31]=e[l],t}function Uo(r){let e,l,t;return{c(){e=k("input"),this.h()},l(n){e=w(n,"INPUT",{id:!0,class:!0,type:!0}),this.h()},h(){h(e,"id",r[10]),e.value=r[4],h(e,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline hover:border-blue-400"),h(e,"type","text")},m(n,o){N(n,e,o),l||(t=le(e,"change",r[27]),l=!0)},p(n,o){o[0]&18&&e.value!==n[4]&&(e.value=n[4])},i:Y,o:Y,d(n){n&&u(e),l=!1,t()}}}function Mo(r){let e,l,t=r[4]&&Hl(r);return{c(){e=k("div"),t&&t.c(),this.h()},l(n){e=w(n,"DIV",{class:!0});var o=I(e);t&&t.l(o),o.forEach(u),this.h()},h(){h(e,"class","flex gap-1")},m(n,o){N(n,e,o),t&&t.m(e,null),l=!0},p(n,o){n[4]?t?(t.p(n,o),o[0]&16&&C(t,1)):(t=Hl(n),t.c(),C(t,1),t.m(e,null)):t&&(se(),D(t,1,1,()=>{t=null}),ie())},i(n){l||(C(t),l=!0)},o(n){D(t),l=!1},d(n){n&&u(e),t&&t.d()}}}function Ro(r){let e,l;return e=new Ao({props:{onChange:r[25],options:r[1].opts?r[1].opts.split(","):[],value:r[4]}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n[0]&4&&(o.onChange=t[25]),n[0]&2&&(o.options=t[1].opts?t[1].opts.split(","):[]),n[0]&16&&(o.value=t[4]),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Ho(r){let e,l,t,n=re(r[1].opts?r[1].opts.split(","):[]),o=[];for(let s=0;s<n.length;s+=1)o[s]=zl(Ul(r,n,s));return{c(){e=k("select");for(let s=0;s<o.length;s+=1)o[s].c();this.h()},l(s){e=w(s,"SELECT",{class:!0});var a=I(e);for(let i=0;i<o.length;i+=1)o[i].l(a);a.forEach(u),this.h()},h(){h(e,"class","w-full border border-dashed rounded-lg bg-gray-50 p-1")},m(s,a){N(s,e,a);for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(e,null);Ve(e,r[4]),l||(t=le(e,"change",r[24]),l=!0)},p(s,a){if(a[0]&2){n=re(s[1].opts?s[1].opts.split(","):[]);let i;for(i=0;i<n.length;i+=1){const c=Ul(s,n,i);o[i]?o[i].p(c,a):(o[i]=zl(c),o[i].c(),o[i].m(e,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}a[0]&18&&Ve(e,s[4])},i:Y,o:Y,d(s){s&&u(e),ye(o,s),l=!1,t()}}}function jo(r){let e=r[4],l,t,n=Fl(r);return{c(){n.c(),l=ne()},l(o){n.l(o),l=ne()},m(o,s){n.m(o,s),N(o,l,s),t=!0},p(o,s){s[0]&16&&de(e,e=o[4])?(se(),D(n,1,1,Y),ie(),n=Fl(o),n.c(),C(n,1),n.m(l.parentNode,l)):n.p(o,s)},i(o){t||(C(n),t=!0)},o(o){D(n),t=!1},d(o){o&&u(l),n.d(o)}}}function zo(r){let e,l,t,n,o;return{c(){e=k("div"),l=k("span"),t=Z(`Remote:
        `),n=k("strong"),o=Z(r[4]),this.h()},l(s){e=w(s,"DIV",{class:!0});var a=I(e);l=w(a,"SPAN",{class:!0});var i=I(l);t=W(i,`Remote:
        `),n=w(i,"STRONG",{class:!0});var c=I(n);o=W(c,r[4]),c.forEach(u),i.forEach(u),a.forEach(u),this.h()},h(){h(n,"class","font-semibold text-gray-700"),h(l,"class","bg-green-100 rounded p-0.5 text-gray-600"),h(e,"class","flex gap-1")},m(s,a){N(s,e,a),g(e,l),g(l,t),g(l,n),g(n,o)},p(s,a){a[0]&16&&_e(o,s[4])},i:Y,o:Y,d(s){s&&u(e)}}}function Fo(r){let e,l=r[5]&&Gl(r);return{c(){e=k("div"),l&&l.c(),this.h()},l(t){e=w(t,"DIV",{class:!0});var n=I(e);l&&l.l(n),n.forEach(u),this.h()},h(){h(e,"class","flex gap-1")},m(t,n){N(t,e,n),l&&l.m(e,null)},p(t,n){t[5]?l?l.p(t,n):(l=Gl(t),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i:Y,o:Y,d(t){t&&u(e),l&&l.d()}}}function Go(r){let e,l,t=re([1,2,3,4,5]),n=[];for(let s=0;s<5;s+=1)n[s]=ql(Ml(r,t,s));const o=s=>D(n[s],1,1,()=>{n[s]=null});return{c(){e=k("div");for(let s=0;s<5;s+=1)n[s].c();this.h()},l(s){e=w(s,"DIV",{class:!0});var a=I(e);for(let i=0;i<5;i+=1)n[i].l(a);a.forEach(u),this.h()},h(){h(e,"class","flex p-1 gap-1")},m(s,a){N(s,e,a);for(let i=0;i<5;i+=1)n[i]&&n[i].m(e,null);l=!0},p(s,a){if(a[0]&36){t=re([1,2,3,4,5]);let i;for(i=0;i<5;i+=1){const c=Ml(s,t,i);n[i]?(n[i].p(c,a),C(n[i],1)):(n[i]=ql(c),n[i].c(),C(n[i],1),n[i].m(e,null))}for(se(),i=5;i<5;i+=1)o(i);ie()}},i(s){if(!l){for(let a=0;a<5;a+=1)C(n[a]);l=!0}},o(s){n=n.filter(Boolean);for(let a=0;a<5;a+=1)D(n[a]);l=!1},d(s){s&&u(e),ye(n,s)}}}function qo(r){let e,l,t=r[4]&&Jl(r);return{c(){e=k("div"),t&&t.c(),this.h()},l(n){e=w(n,"DIV",{class:!0,style:!0});var o=I(e);t&&t.l(o),o.forEach(u),this.h()},h(){h(e,"class","p-1 rounded bg-gray-50 hover:border-blue-400 flex gap-1 flex-wrap"),Fe(e,"min-height","2rem")},m(n,o){N(n,e,o),t&&t.m(e,null),l=!0},p(n,o){n[4]?t?(t.p(n,o),o[0]&16&&C(t,1)):(t=Jl(n),t.c(),C(t,1),t.m(e,null)):t&&(se(),D(t,1,1,()=>{t=null}),ie())},i(n){l||(C(t),l=!0)},o(n){D(t),l=!1},d(n){n&&u(e),t&&t.d()}}}function Jo(r){let e,l,t;return{c(){e=k("input"),this.h()},l(n){e=w(n,"INPUT",{class:!0,id:!0,type:!0}),this.h()},h(){h(e,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline hover:border-blue-400"),h(e,"id",r[10]),e.value=r[4],h(e,"type","datetime-local")},m(n,o){N(n,e,o),l||(t=le(e,"change",r[21]),l=!0)},p(n,o){o[0]&18&&(e.value=n[4])},i:Y,o:Y,d(n){n&&u(e),l=!1,t()}}}function Yo(r){let e,l,t,n;return{c(){e=k("input"),this.h()},l(o){e=w(o,"INPUT",{class:!0,id:!0,type:!0}),this.h()},h(){h(e,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline hover:border-blue-400"),h(e,"id",r[10]),e.value=l=Number(r[5]),h(e,"type","number")},m(o,s){N(o,e,s),t||(n=le(e,"change",r[20]),t=!0)},p(o,s){s[0]&32&&l!==(l=Number(o[5]))&&e.value!==l&&(e.value=l)},i:Y,o:Y,d(o){o&&u(e),t=!1,n()}}}function Zo(r){let e,l,t,n,o;return{c(){e=k("label"),l=k("input"),this.h()},l(s){e=w(s,"LABEL",{class:!0});var a=I(e);l=w(a,"INPUT",{id:!0,class:!0,type:!0}),a.forEach(u),this.h()},h(){h(l,"id",r[10]),h(l,"class","shadow"),h(l,"type","checkbox"),l.checked=t=r[4]=="true",h(e,"class","text-teal-500 inline-flex justify-between items-center hover:bg-gray-200 px-2 py-2 rounded-lg cursor-pointer hover:border-blue-400")},m(s,a){N(s,e,a),g(e,l),n||(o=le(l,"change",r[19]),n=!0)},p(s,a){a[0]&18&&t!==(t=s[4]=="true")&&(l.checked=t)},i:Y,o:Y,d(s){s&&u(e),n=!1,o()}}}function Wo(r){let e,l,t;return{c(){e=k("textarea"),this.h()},l(n){e=w(n,"TEXTAREA",{id:!0,class:!0}),I(e).forEach(u),this.h()},h(){h(e,"id",r[10]),e.value=r[4],h(e,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline hover:border-blue-400")},m(n,o){N(n,e,o),l||(t=le(e,"change",r[18]),l=!0)},p(n,o){o[0]&18&&(e.value=n[4])},i:Y,o:Y,d(n){n&&u(e),l=!1,t()}}}function Hl(r){let e,l,t=re(r[4].split(",")),n=[];for(let s=0;s<t.length;s+=1)n[s]=jl(Pl(r,t,s));const o=s=>D(n[s],1,1,()=>{n[s]=null});return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=ne()},l(s){for(let a=0;a<n.length;a+=1)n[a].l(s);e=ne()},m(s,a){for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(s,a);N(s,e,a),l=!0},p(s,a){if(a[0]&65560){t=re(s[4].split(","));let i;for(i=0;i<t.length;i+=1){const c=Pl(s,t,i);n[i]?(n[i].p(c,a),C(n[i],1)):(n[i]=jl(c),n[i].c(),C(n[i],1),n[i].m(e.parentNode,e))}for(se(),i=t.length;i<n.length;i+=1)o(i);ie()}},i(s){if(!l){for(let a=0;a<t.length;a+=1)C(n[a]);l=!0}},o(s){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)D(n[a]);l=!1},d(s){s&&u(e),ye(n,s)}}}function jl(r){let e,l,t,n,o=r[31]+"",s,a,i,c,f,d,_,m;l=new mn({props:{name:r[31],url:r[3].profile_genrator(r[31])}}),c=new De({props:{solid:!0,name:"x",class:"w-4 h-4 rounded-full border hover:bg-slate-500"}});function y(){return r[26](r[31])}return{c(){e=k("div"),j(l.$$.fragment),t=O(),n=k("span"),s=Z(o),a=O(),i=k("button"),j(c.$$.fragment),f=O(),this.h()},l(b){e=w(b,"DIV",{class:!0});var v=I(e);z(l.$$.fragment,v),t=P(v),n=w(v,"SPAN",{});var $=I(n);s=W($,o),$.forEach(u),a=P(v),i=w(v,"BUTTON",{});var T=I(i);z(c.$$.fragment,T),T.forEach(u),f=P(v),v.forEach(u),this.h()},h(){h(e,"class","p-1 rounded bg-gray-50 flex border gap-1")},m(b,v){N(b,e,v),F(l,e,null),g(e,t),g(e,n),g(n,s),g(e,a),g(e,i),F(c,i,null),g(e,f),d=!0,_||(m=le(i,"click",y),_=!0)},p(b,v){r=b;const $={};v[0]&16&&($.name=r[31]),v[0]&24&&($.url=r[3].profile_genrator(r[31])),l.$set($),(!d||v[0]&16)&&o!==(o=r[31]+"")&&_e(s,o)},i(b){d||(C(l.$$.fragment,b),C(c.$$.fragment,b),d=!0)},o(b){D(l.$$.fragment,b),D(c.$$.fragment,b),d=!1},d(b){b&&u(e),G(l),G(c),_=!1,m()}}}function zl(r){let e,l=r[37]+"",t,n;return{c(){e=k("option"),t=Z(l),this.h()},l(o){e=w(o,"OPTION",{});var s=I(e);t=W(s,l),s.forEach(u),this.h()},h(){e.__value=n=r[37],Te(e,e.__value)},m(o,s){N(o,e,s),g(e,t)},p(o,s){s[0]&2&&l!==(l=o[37]+"")&&_e(t,l),s[0]&2&&n!==(n=o[37])&&(e.__value=n,Te(e,e.__value))},d(o){o&&u(e)}}}function Fl(r){let e,l;return e=new vn({props:{value:r[4]}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n[0]&16&&(o.value=t[4]),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Gl(r){let e,l,t,n,o,s;return{c(){e=k("span"),l=Z(`Ref:
          `),t=Z(r[5]),n=O(),o=k("strong"),s=Z(r[4]),this.h()},l(a){e=w(a,"SPAN",{class:!0});var i=I(e);l=W(i,`Ref:
          `),t=W(i,r[5]),n=P(i),o=w(i,"STRONG",{class:!0});var c=I(o);s=W(c,r[4]),c.forEach(u),i.forEach(u),this.h()},h(){h(o,"class","font-semibold text-gray-700"),h(e,"class","bg-blue-100 rounded p-0.5 text-gray-600")},m(a,i){N(a,e,i),g(e,l),g(e,t),g(e,n),g(e,o),g(o,s)},p(a,i){i[0]&32&&_e(t,a[5]),i[0]&16&&_e(s,a[4])},d(a){a&&u(e)}}}function ql(r){let e,l,t,n,o,s;l=new De({props:{name:"star",class:"h-8 w-8 text-gray-400 "+(r[34]<=r[5]?"text-yellow-400":"")+" ",solid:!0}});function a(){return r[23](r[34])}return{c(){e=k("button"),j(l.$$.fragment),t=O()},l(i){e=w(i,"BUTTON",{});var c=I(e);z(l.$$.fragment,c),t=P(c),c.forEach(u)},m(i,c){N(i,e,c),F(l,e,null),g(e,t),n=!0,o||(s=le(e,"click",a),o=!0)},p(i,c){r=i;const f={};c[0]&32&&(f.class="h-8 w-8 text-gray-400 "+(r[34]<=r[5]?"text-yellow-400":"")+" "),l.$set(f)},i(i){n||(C(l.$$.fragment,i),n=!0)},o(i){D(l.$$.fragment,i),n=!1},d(i){i&&u(e),G(l),o=!1,s()}}}function Jl(r){let e,l,t=re(r[4].split(",")),n=[];for(let s=0;s<t.length;s+=1)n[s]=Yl(Rl(r,t,s));const o=s=>D(n[s],1,1,()=>{n[s]=null});return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=ne()},l(s){for(let a=0;a<n.length;a+=1)n[a].l(s);e=ne()},m(s,a){for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(s,a);N(s,e,a),l=!0},p(s,a){if(a[0]&66064){t=re(s[4].split(","));let i;for(i=0;i<t.length;i+=1){const c=Rl(s,t,i);n[i]?(n[i].p(c,a),C(n[i],1)):(n[i]=Yl(c),n[i].c(),C(n[i],1),n[i].m(e.parentNode,e))}for(se(),i=t.length;i<n.length;i+=1)o(i);ie()}},i(s){if(!l){for(let a=0;a<t.length;a+=1)C(n[a]);l=!0}},o(s){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)D(n[a]);l=!1},d(s){s&&u(e),ye(n,s)}}}function Yl(r){let e,l,t,n,o,s,a,i,c,f;t=new De({props:{solid:!0,name:"x",class:"w-4 h-4"}});function d(){return r[22](r[31])}return{c(){e=k("div"),l=k("button"),j(t.$$.fragment),n=O(),o=k("img"),a=O(),this.h()},l(_){e=w(_,"DIV",{class:!0});var m=I(e);l=w(m,"BUTTON",{class:!0});var y=I(l);z(t.$$.fragment,y),y.forEach(u),n=P(m),o=w(m,"IMG",{class:!0,src:!0,alt:!0}),a=P(m),m.forEach(u),this.h()},h(){h(l,"class","text-slate-700 -top-2 -right-2 absolute hover:text-red-600 border rounded-full bg-white"),h(o,"class","h-8 w-auto"),Ge(o.src,s=r[9]&&r[9].getFilePreviewUrl(r[31]))||h(o,"src",s),h(o,"alt",""),h(e,"class","relative")},m(_,m){N(_,e,m),g(e,l),F(t,l,null),g(e,n),g(e,o),g(e,a),i=!0,c||(f=le(l,"click",d),c=!0)},p(_,m){r=_,(!i||m[0]&18&&!Ge(o.src,s=r[9]&&r[9].getFilePreviewUrl(r[31])))&&h(o,"src",s)},i(_){i||(C(t.$$.fragment,_),i=!0)},o(_){D(t.$$.fragment,_),i=!1},d(_){_&&u(e),G(t),c=!1,f()}}}function Zl(r){let e,l,t,n;const o=[es,xo,Qo,Xo,Ko],s=[];function a(i,c){return i[1].ctype===lt?0:i[1].ctype===rt?1:i[1].ctype===Ae?2:i[1].ctype===Qe?3:i[1].ctype===nt?4:-1}return~(l=a(r))&&(t=s[l]=o[l](r)),{c(){e=k("div"),t&&t.c(),this.h()},l(i){e=w(i,"DIV",{class:!0});var c=I(e);t&&t.l(c),c.forEach(u),this.h()},h(){h(e,"class","p-1 border rounded shadow h-64 mt-2 border-green-500 overflow-auto")},m(i,c){N(i,e,c),~l&&s[l].m(e,null),n=!0},p(i,c){let f=l;l=a(i),l===f?~l&&s[l].p(i,c):(t&&(se(),D(s[f],1,1,()=>{s[f]=null}),ie()),~l?(t=s[l],t?t.p(i,c):(t=s[l]=o[l](i),t.c()),C(t,1),t.m(e,null)):t=null)},i(i){n||(C(t),n=!0)},o(i){D(t),n=!1},d(i){i&&u(e),~l&&s[l].d()}}}function Ko(r){let e,l;return e=new go({props:{folder_api:r[9],onFileAdd:r[15]}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p:Y,i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Xo(r){let e,l;return e=new Po({props:{column:r[1],service:r[3],onUserAdd:r[15]}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n[0]&2&&(o.column=t[1]),n[0]&8&&(o.service=t[3]),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Qo(r){let e,l;return e=new Eo({props:{service:r[3],column:r[1],current:r[5],onSelect:r[30]}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n[0]&8&&(o.service=t[3]),n[0]&2&&(o.column=t[1]),n[0]&32&&(o.current=t[5]),n[0]&52&&(o.onSelect=t[30]),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function xo(r){let e,l;return e=new Do({}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p:Y,i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function es(r){let e,l;return e=new fo({props:{onChange:r[29],value:r[4]}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n[0]&20&&(o.onChange=t[29]),n[0]&16&&(o.value=t[4]),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Wl(r){let e,l;return e=new $o({props:{onColorChange:r[14],color:r[6]}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n[0]&64&&(o.color=t[6]),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function ts(r){let e,l,t,n,o,s=(r[1].name||`Column ${r[1].__id}`)+"",a,i,c,f,d,_,m,y,b,v;n=new De({props:{name:vt[r[1].ctype],class:"h-5 w-5 mr-1 text-gray-500",solid:!0}});const $=[Wo,Zo,Yo,Jo,qo,Go,Fo,zo,jo,Ho,Ro,Mo,Uo],T=[];function S(V,L){return V[1].ctype===bt?0:V[1].ctype===kt?1:V[1].ctype===ut?2:V[1].ctype===pt?3:V[1].ctype===nt?4:V[1].ctype===wt?5:V[1].ctype===Ae?6:V[1].ctype===rt?7:V[1].ctype===lt?8:V[1].ctype===qe?9:V[1].ctype===Je?10:V[1].ctype===Qe?11:12}c=S(r),f=T[c]=$[c](r),_=new po({props:{onCellColor:r[28],is_cell_open:r[8],onCellClose:r[12],onPick:r[11],pick_icon:r[13][r[1].ctype]}});let E=r[8]&&Zl(r),p=!r[0]&&r[7]&&Wl(r);return{c(){e=k("div"),l=k("label"),t=k("span"),j(n.$$.fragment),o=O(),a=Z(s),i=O(),f.c(),d=O(),j(_.$$.fragment),m=O(),E&&E.c(),y=O(),p&&p.c(),this.h()},l(V){e=w(V,"DIV",{class:!0,style:!0});var L=I(e);l=w(L,"LABEL",{class:!0,for:!0});var K=I(l);t=w(K,"SPAN",{class:!0});var M=I(t);z(n.$$.fragment,M),o=P(M),a=W(M,s),M.forEach(u),K.forEach(u),i=P(L),f.l(L),d=P(L),z(_.$$.fragment,L),m=P(L),E&&E.l(L),y=P(L),p&&p.l(L),L.forEach(u),this.h()},h(){h(t,"class","inline-flex"),h(l,"class","mb-2 text-sm font-bold text-gray-700 uppercase"),h(l,"for",r[10]),h(e,"class",b="py-2 border-b pl-2 border-l-4 border-l-white rounded border-l-"+r[6]+"-400"),Fe(e,"border-left-color",r[6])},m(V,L){N(V,e,L),g(e,l),g(l,t),F(n,t,null),g(t,o),g(t,a),g(e,i),T[c].m(e,null),g(e,d),F(_,e,null),g(e,m),E&&E.m(e,null),g(e,y),p&&p.m(e,null),v=!0},p(V,L){const K={};L[0]&2&&(K.name=vt[V[1].ctype]),n.$set(K),(!v||L[0]&2)&&s!==(s=(V[1].name||`Column ${V[1].__id}`)+"")&&_e(a,s);let M=c;c=S(V),c===M?T[c].p(V,L):(se(),D(T[M],1,1,()=>{T[M]=null}),ie(),f=T[c],f?f.p(V,L):(f=T[c]=$[c](V),f.c()),C(f,1),f.m(e,d));const A={};L[0]&129&&(A.onCellColor=V[28]),L[0]&256&&(A.is_cell_open=V[8]),L[0]&2&&(A.pick_icon=V[13][V[1].ctype]),_.$set(A),V[8]?E?(E.p(V,L),L[0]&256&&C(E,1)):(E=Zl(V),E.c(),C(E,1),E.m(e,y)):E&&(se(),D(E,1,1,()=>{E=null}),ie()),!V[0]&&V[7]?p?(p.p(V,L),L[0]&129&&C(p,1)):(p=Wl(V),p.c(),C(p,1),p.m(e,null)):p&&(se(),D(p,1,1,()=>{p=null}),ie()),(!v||L[0]&64&&b!==(b="py-2 border-b pl-2 border-l-4 border-l-white rounded border-l-"+V[6]+"-400"))&&h(e,"class",b),(!v||L[0]&64)&&Fe(e,"border-left-color",V[6])},i(V){v||(C(n.$$.fragment,V),C(f),C(_.$$.fragment,V),C(E),C(p),v=!0)},o(V){D(n.$$.fragment,V),D(f),D(_.$$.fragment,V),D(E),D(p),v=!1},d(V){V&&u(e),G(n),T[c].d(),G(_),E&&E.d(),p&&p.d()}}}function ls(r,e,l){let t,{column:n}=e,{open_column:o}=e,{celldata:s={}}=e,{onCellChange:a=J=>{}}=e,{service:i}=e;const c=i.group.folder_api,f=`cell-${n.__id}`;let d=s.value||"",_=s.numval||0,m=s.color,y=!1;const b=()=>{t?l(0,o=null):(l(0,o=n.__id),l(7,y=!1))},v=()=>{t&&l(0,o=null)},$={[lt]:"location-marker",[nt]:"photograph",[Ae]:"paper-clip",[rt]:"external-link",[Qe]:"users"},T=J=>{l(6,m=J.target.value),a({color:m})},S=J=>{let he=d.split(",");he=he.filter(Q=>Q!==""),!he.includes(J)&&(he.push(J),l(4,d=he.join()),a({value:d}))},E=J=>{const he=d.split(",");l(4,d=he.filter(Q=>Q!==J).join()),a({value:d})},p=J=>a({value:J.target.value}),V=J=>{let he="false";J.target.checked&&(he="true"),a({value:he})},L=J=>{a({numval:Number(J.target.value)})},K=J=>a({value:J.target.value}),M=J=>E(J),A=J=>{_===J?l(5,_=0):l(5,_=J),a({numval:_})},B=J=>a({value:J.target.value}),q=J=>a({value:J}),ee=J=>E(J),fe=J=>a({value:J.target.value}),ke=()=>{l(0,o=null),l(7,y=!y)},X=J=>{console.log("@value changed",J),l(4,d=J),a({value:d})},U=J=>{l(4,d=J.ref_value),l(5,_=J.__id),a({value:d,numval:_})};return r.$$set=J=>{"column"in J&&l(1,n=J.column),"open_column"in J&&l(0,o=J.open_column),"celldata"in J&&l(17,s=J.celldata),"onCellChange"in J&&l(2,a=J.onCellChange),"service"in J&&l(3,i=J.service)},r.$$.update=()=>{r.$$.dirty[0]&3&&l(8,t=o===n.__id)},[o,n,a,i,d,_,m,y,t,c,f,b,v,$,T,S,E,s,p,V,L,K,M,A,B,q,ee,fe,ke,X,U]}class wn extends ve{constructor(e){super(),be(this,e,ls,ts,de,{column:1,open_column:0,celldata:17,onCellChange:2,service:3},null,[-1,-1])}}function Kl(r,e,l){const t=r.slice();return t[7]=e[l],t}function Xl(r){let e,l,t;function n(...a){return r[5](r[7],...a)}function o(a){r[6](a)}let s={service:r[3],column:r[7],celldata:r[0][r[7].__id],onCellChange:n};return r[4]!==void 0&&(s.open_column=r[4]),e=new wn({props:s}),Be.push(()=>Re(e,"open_column",o)),{c(){j(e.$$.fragment)},l(a){z(e.$$.fragment,a)},m(a,i){F(e,a,i),t=!0},p(a,i){r=a;const c={};i&8&&(c.service=r[3]),i&4&&(c.column=r[7]),i&5&&(c.celldata=r[0][r[7].__id]),i&7&&(c.onCellChange=n),!l&&i&16&&(l=!0,c.open_column=r[4],Me(()=>l=!1)),e.$set(c)},i(a){t||(C(e.$$.fragment,a),t=!0)},o(a){D(e.$$.fragment,a),t=!1},d(a){G(e,a)}}}function ns(r){let e,l,t=re(r[2]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Xl(Kl(r,t,s));const o=s=>D(n[s],1,1,()=>{n[s]=null});return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=ne()},l(s){for(let a=0;a<n.length;a+=1)n[a].l(s);e=ne()},m(s,a){for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(s,a);N(s,e,a),l=!0},p(s,[a]){if(a&31){t=re(s[2]);let i;for(i=0;i<t.length;i+=1){const c=Kl(s,t,i);n[i]?(n[i].p(c,a),C(n[i],1)):(n[i]=Xl(c),n[i].c(),C(n[i],1),n[i].m(e.parentNode,e))}for(se(),i=t.length;i<n.length;i+=1)o(i);ie()}},i(s){if(!l){for(let a=0;a<t.length;a+=1)C(n[a]);l=!0}},o(s){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)D(n[a]);l=!1},d(s){s&&u(e),ye(n,s)}}}function rs(r,e,l){let{columns:t}=e,{service:n}=e,{current_cells:o={}}=e,{modified_cells:s={}}=e,a;const i=(f,d)=>{const _=o[f.__id]||{};l(0,o[f.__id]={..._,...d},o),l(1,s[f.__id]=!0,s)};function c(f){a=f,l(4,a)}return r.$$set=f=>{"columns"in f&&l(2,t=f.columns),"service"in f&&l(3,n=f.service),"current_cells"in f&&l(0,o=f.current_cells),"modified_cells"in f&&l(1,s=f.modified_cells)},[o,s,t,n,a,i,c]}let os=class extends ve{constructor(e){super(),be(this,e,rs,ns,de,{columns:2,service:3,current_cells:0,modified_cells:1})}};function Ql(r,e,l){const t=r.slice();return t[15]=e[l],t}function xl(r){let e,l,t=r[8][r[15].sheetid]+"",n,o,s=r[15].name+"",a,i,c,f;function d(){return r[11](r[15])}return{c(){e=k("option"),l=Z("#"),n=Z(t),o=Z(`|>
          `),a=Z(s),i=O(),this.h()},l(_){e=w(_,"OPTION",{});var m=I(e);l=W(m,"#"),n=W(m,t),o=W(m,`|>
          `),a=W(m,s),i=P(m),m.forEach(u),this.h()},h(){e.__value=`
          #`+r[8][r[15].sheetid]+`|>
          `+r[15].name+`
        `,Te(e,e.__value)},m(_,m){N(_,e,m),g(e,l),g(e,n),g(e,o),g(e,a),g(e,i),c||(f=le(e,"click",d),c=!0)},p(_,m){r=_},d(_){_&&u(e),c=!1,f()}}}function ss(r){let e,l,t=r[2]&&en(r);return{c(){t&&t.c(),e=ne()},l(n){t&&t.l(n),e=ne()},m(n,o){t&&t.m(n,o),N(n,e,o),l=!0},p(n,o){n[2]?t?(t.p(n,o),o&4&&C(t,1)):(t=en(n),t.c(),C(t,1),t.m(e.parentNode,e)):t&&(se(),D(t,1,1,()=>{t=null}),ie())},i(n){l||(C(t),l=!0)},o(n){D(t),l=!1},d(n){n&&u(e),t&&t.d(n)}}}function is(r){let e,l="Loading...";return{c(){e=k("div"),e.textContent=l},l(t){e=w(t,"DIV",{"data-svelte-h":!0}),ue(e)!=="svelte-194gxkm"&&(e.textContent=l)},m(t,n){N(t,e,n)},p:Y,i:Y,o:Y,d(t){t&&u(e)}}}function en(r){let e,l,t;return l=new yt({props:{editable:!1,cells:r[2].cells||{},columns:r[2].columns||[],rows:r[2].rows||[],selected_rows:[],pick_label:"goto"}}),l.$on("pick_row",r[12]),{c(){e=k("div"),j(l.$$.fragment),this.h()},l(n){e=w(n,"DIV",{class:!0});var o=I(e);z(l.$$.fragment,o),o.forEach(u),this.h()},h(){h(e,"class","p-1 border rounded shadow h-64 mt-2 overflow-auto")},m(n,o){N(n,e,o),F(l,e,null),t=!0},p(n,o){const s={};o&4&&(s.cells=n[2].cells||{}),o&4&&(s.columns=n[2].columns||[]),o&4&&(s.rows=n[2].rows||[]),l.$set(s)},i(n){t||(C(l.$$.fragment,n),t=!0)},o(n){D(l.$$.fragment,n),t=!1},d(n){n&&u(e),G(l)}}}function as(r){let e,l,t,n,o="Select Sheet",s,a,i,c,f=re(r[6]),d=[];for(let b=0;b<f.length;b+=1)d[b]=xl(Ql(r,f,b));const _=[is,ss],m=[];function y(b,v){return b[3]&&b[4]?0:b[3]?1:-1}return~(a=y(r))&&(i=m[a]=_[a](r)),{c(){e=k("div"),l=k("div"),t=k("select"),n=k("option"),n.textContent=o;for(let b=0;b<d.length;b+=1)d[b].c();s=O(),i&&i.c(),this.h()},l(b){e=w(b,"DIV",{class:!0});var v=I(e);l=w(v,"DIV",{class:!0});var $=I(l);t=w($,"SELECT",{class:!0});var T=I(t);n=w(T,"OPTION",{"data-svelte-h":!0}),ue(n)!=="svelte-1macabv"&&(n.textContent=o);for(let S=0;S<d.length;S+=1)d[S].l(T);T.forEach(u),$.forEach(u),s=P(v),i&&i.l(v),v.forEach(u),this.h()},h(){n.__value="Select Sheet",Te(n,n.__value),h(t,"class","p-1 bg-gray-50 border"),h(l,"class","flex justify-end p-1 gap-1"),h(e,"class","w-full p-2 flex flex-col relative")},m(b,v){N(b,e,v),g(e,l),g(l,t),g(t,n);for(let $=0;$<d.length;$+=1)d[$]&&d[$].m(t,null);g(e,s),~a&&m[a].m(e,null),c=!0},p(b,[v]){if(v&832){f=re(b[6]);let T;for(T=0;T<f.length;T+=1){const S=Ql(b,f,T);d[T]?d[T].p(S,v):(d[T]=xl(S),d[T].c(),d[T].m(t,null))}for(;T<d.length;T+=1)d[T].d(1);d.length=f.length}let $=a;a=y(b),a===$?~a&&m[a].p(b,v):(i&&(se(),D(m[$],1,1,()=>{m[$]=null}),ie()),~a?(i=m[a],i?i.p(b,v):(i=m[a]=_[a](b),i.c()),C(i,1),i.m(e,null)):i=null)},i(b){c||(C(i),c=!0)},o(b){D(i),c=!1},d(b){b&&u(e),ye(d,b),~a&&m[a].d()}}}function cs(r,e,l){let t,n,{service:o}=e,{gotoSiblingSheet:s}=e,{rid:a}=e;const i=o.state;Et(r,i,T=>l(14,n=T));const c=n.ref_columns,f=o.group.sheets;Et(r,f,T=>l(13,t=T));const d=t.reduce((T,S)=>(T[S.__id]=S.name,T),{});let _,m=!1,y={};const b=async(T,S)=>{l(4,m=!0),l(3,_=T);const E=await o.get_relations(a,T,S);E.ok&&(l(2,y=gn(E.data)),l(4,m=!1))},v=T=>b(T.sheetid,T.__id),$=({detail:T})=>{s&&s(_,Number(T.__id)),o.close_big_modal()};return r.$$set=T=>{"service"in T&&l(0,o=T.service),"gotoSiblingSheet"in T&&l(1,s=T.gotoSiblingSheet),"rid"in T&&l(10,a=T.rid)},r.$$.update=()=>{r.$$.dirty&4&&console.log("@data",y)},[o,s,y,_,m,i,c,f,d,b,a,v,$]}class fs extends ve{constructor(e){super(),be(this,e,cs,as,de,{service:0,gotoSiblingSheet:1,rid:10})}}function us(r){let e,l,t=r[4][r[0].type]+"";return{c(){e=je("svg"),l=new It(!0),this.h()},l(n){e=ze(n,"svg",{class:!0,viewBox:!0,fill:!0});var o=I(e);l=Nt(o,!0),o.forEach(u),this.h()},h(){l.a=null,h(e,"class","h-5 w-5"),h(e,"viewBox","0 0 16 16"),h(e,"fill","none")},m(n,o){N(n,e,o),l.m(t,e)},p(n,o){o&1&&t!==(t=n[4][n[0].type]+"")&&l.p(t)},d(n){n&&u(e)}}}function _s(r){let e,l,t=r[4][r[0].type]+"";return{c(){e=je("svg"),l=new It(!0),this.h()},l(n){e=ze(n,"svg",{class:!0,viewBox:!0,fill:!0});var o=I(e);l=Nt(o,!0),o.forEach(u),this.h()},h(){l.a=null,h(e,"class","h-5 w-5 text-red-500"),h(e,"viewBox","0 0 20 20"),h(e,"fill","currentColor")},m(n,o){N(n,e,o),l.m(t,e)},p(n,o){o&1&&t!==(t=n[4][n[0].type]+"")&&l.p(t)},d(n){n&&u(e)}}}function ds(r){let e;return{c(){e=je("svg"),this.h()},l(l){e=ze(l,"svg",{class:!0,viewBox:!0,fill:!0}),I(e).forEach(u),this.h()},h(){h(e,"class","h-5 w-5 text-blue-500"),h(e,"viewBox","0 0 20 20"),h(e,"fill","currentColor")},m(l,t){N(l,e,t)},p:Y,d(l){l&&u(e)}}}function hs(r){let e,l,t=r[4][r[0].type]+"";return{c(){e=je("svg"),l=new It(!0),this.h()},l(n){e=ze(n,"svg",{class:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0});var o=I(e);l=Nt(o,!0),o.forEach(u),this.h()},h(){l.a=null,h(e,"class","h-6 w-6 text-green-500"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke","currentColor"),h(e,"stroke-width","2")},m(n,o){N(n,e,o),l.m(t,e)},p(n,o){o&1&&t!==(t=n[4][n[0].type]+"")&&l.p(t)},d(n){n&&u(e)}}}function tn(r){let e,l=r[0].payload+"",t;return{c(){e=k("p"),t=Z(l),this.h()},l(n){e=w(n,"P",{class:!0});var o=I(e);t=W(o,l),o.forEach(u),this.h()},h(){h(e,"class","italic text-gray-700")},m(n,o){N(n,e,o),g(e,t)},p(n,o){o&1&&l!==(l=n[0].payload+"")&&_e(t,l)},d(n){n&&u(e)}}}function ln(r){let e,l,t;return l=new Ln({props:{json:JSON.parse(r[0].payload||"{}")}}),{c(){e=k("div"),j(l.$$.fragment),this.h()},l(n){e=w(n,"DIV",{class:!0});var o=I(e);z(l.$$.fragment,o),o.forEach(u),this.h()},h(){h(e,"class","p-2 border rounded bg-gray-50")},m(n,o){N(n,e,o),F(l,e,null),t=!0},p(n,o){const s={};o&1&&(s.json=JSON.parse(n[0].payload||"{}")),l.$set(s)},i(n){t||(C(l.$$.fragment,n),t=!0)},o(n){D(l.$$.fragment,n),t=!1},d(n){n&&u(e),G(l)}}}function ms(r){let e,l,t,n,o,s,a,i=r[0].user_id+"",c,f,d,_,m,y='<svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M1.33325 14.6667C1.33325 13.2522 1.89516 11.8956 2.89535 10.8954C3.89554 9.89523 5.2521 9.33333 6.66659 9.33333C8.08107 9.33333 9.43763 9.89523 10.4378 10.8954C11.438 11.8956 11.9999 13.2522 11.9999 14.6667H1.33325ZM6.66659 8.66666C4.45659 8.66666 2.66659 6.87666 2.66659 4.66666C2.66659 2.45666 4.45659 0.666664 6.66659 0.666664C8.87659 0.666664 10.6666 2.45666 10.6666 4.66666C10.6666 6.87666 8.87659 8.66666 6.66659 8.66666ZM11.5753 10.1553C12.595 10.4174 13.5061 10.9946 14.1788 11.8046C14.8515 12.6145 15.2515 13.6161 15.3219 14.6667H13.3333C13.3333 12.9267 12.6666 11.3427 11.5753 10.1553ZM10.2266 8.638C10.7852 8.13831 11.232 7.52622 11.5376 6.84183C11.8432 6.15743 12.0008 5.41619 11.9999 4.66666C12.0013 3.75564 11.7683 2.85958 11.3233 2.06466C12.0783 2.21639 12.7576 2.62491 13.2456 3.2208C13.7335 3.81668 14.0001 4.56315 13.9999 5.33333C14.0001 5.80831 13.8987 6.27784 13.7027 6.71045C13.5066 7.14306 13.2203 7.52876 12.863 7.84169C12.5056 8.15463 12.0856 8.38757 11.6309 8.52491C11.1762 8.66224 10.6974 8.7008 10.2266 8.638Z" fill="#047857"></path></svg>',b,v,$,T=Lt(r[0].created_at)+"",S,E,p,V,L;function K(ee,fe){if(ee[0].type===Tt)return hs;if(ee[0].type===St)return ds;if(ee[0].type===Dt)return _s;if(ee[0].type===it)return us}let M=K(r),A=M&&M(r),B=r[0].payload&&tn(r),q=r[1]&&r[0].type!==it&&ln(r);return{c(){e=k("div"),l=k("div"),A&&A.c(),t=O(),n=k("div"),o=k("div"),s=k("p"),a=k("span"),c=Z(i),f=O(),d=Z(r[3]),_=O(),m=k("div"),m.innerHTML=y,b=O(),B&&B.c(),v=O(),$=k("p"),S=Z(T),E=O(),q&&q.c(),this.h()},l(ee){e=w(ee,"DIV",{class:!0});var fe=I(e);l=w(fe,"DIV",{class:!0});var ke=I(l);A&&A.l(ke),ke.forEach(u),t=P(fe),n=w(fe,"DIV",{class:!0});var X=I(n);o=w(X,"DIV",{class:!0});var U=I(o);s=w(U,"P",{tabindex:!0,class:!0});var J=I(s);a=w(J,"SPAN",{class:!0});var he=I(a);c=W(he,i),he.forEach(u),f=P(J),d=W(J,r[3]),J.forEach(u),_=P(U),m=w(U,"DIV",{tabindex:!0,"aria-label":!0,role:!0,class:!0,"data-svelte-h":!0}),ue(m)!=="svelte-1y5zn66"&&(m.innerHTML=y),U.forEach(u),b=P(X),B&&B.l(X),v=P(X),$=w(X,"P",{class:!0});var Q=I($);S=W(Q,T),Q.forEach(u),E=P(X),q&&q.l(X),X.forEach(u),fe.forEach(u),this.h()},h(){h(l,"class","focus:outline-none w-8 h-8 border rounded-full border-gray-200 flex flex-shrink-0 items-center justify-center"),h(a,"class","text-indigo-700"),h(s,"tabindex","0"),h(s,"class","focus:outline-none leading-none"),h(m,"tabindex","0"),h(m,"aria-label","close icon"),h(m,"role","button"),h(m,"class","focus:outline-none cursor-pointer rounded-full border p-2"),h(o,"class","flex items-center justify-between w-full"),h($,"class","focus:outline-none text-xs leading-3 pt-1 text-gray-500"),h(n,"class","pl-3 w-full cursor-pointer"),h(e,"class","w-full p-3 mt-4 bg-white rounded shadow flex flex-shrink-0 border")},m(ee,fe){N(ee,e,fe),g(e,l),A&&A.m(l,null),g(e,t),g(e,n),g(n,o),g(o,s),g(s,a),g(a,c),g(s,f),g(s,d),g(o,_),g(o,m),g(n,b),B&&B.m(n,null),g(n,v),g(n,$),g($,S),g(n,E),q&&q.m(n,null),p=!0,V||(L=le(n,"click",function(){Oe(r[2])&&r[2].apply(this,arguments)}),V=!0)},p(ee,[fe]){r=ee,M===(M=K(r))&&A?A.p(r,fe):(A&&A.d(1),A=M&&M(r),A&&(A.c(),A.m(l,null))),(!p||fe&1)&&i!==(i=r[0].user_id+"")&&_e(c,i),r[0].payload?B?B.p(r,fe):(B=tn(r),B.c(),B.m(n,v)):B&&(B.d(1),B=null),(!p||fe&1)&&T!==(T=Lt(r[0].created_at)+"")&&_e(S,T),r[1]&&r[0].type!==it?q?(q.p(r,fe),fe&3&&C(q,1)):(q=ln(r),q.c(),C(q,1),q.m(n,null)):q&&(se(),D(q,1,1,()=>{q=null}),ie())},i(ee){p||(C(q),p=!0)},o(ee){D(q),p=!1},d(ee){ee&&u(e),A&&A.d(),B&&B.d(),q&&q.d(),V=!1,L()}}}function gs(r,e,l){let{data:t}=e,{expanded:n=!1}=e,{onClick:o}=e;const s={[Tt]:"created new a record",[St]:"updated a record",[Dt]:"deleted a record",[it]:"commented "}[t.type],a={[Tt]:'<path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"/>',[St]:`<path
            d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"
          />
          <path
            fill-rule="evenodd"
            d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"
            clip-rule="evenodd"
          />`,[Dt]:`<path
            fill-rule="evenodd"
            d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z"
            clip-rule="evenodd"
          />`,[it]:`<path
            d="M4.30325 12.6667L1.33325 15V2.66667C1.33325 2.48986 1.40349 2.32029 1.52851 2.19526C1.65354 2.07024 1.82311 2 1.99992 2H13.9999C14.1767 2 14.3463 2.07024 14.4713 2.19526C14.5963 2.32029 14.6666 2.48986 14.6666 2.66667V12C14.6666 12.1768 14.5963 12.3464 14.4713 12.4714C14.3463 12.5964 14.1767 12.6667 13.9999 12.6667H4.30325ZM5.33325 6.66667V8H10.6666V6.66667H5.33325Z"
            fill="#4338CA"
          />`};return r.$$set=i=>{"data"in i&&l(0,t=i.data),"expanded"in i&&l(1,n=i.expanded),"onClick"in i&&l(2,o=i.onClick)},[t,n,o,s,a]}class vs extends ve{constructor(e){super(),be(this,e,gs,ms,de,{data:0,expanded:1,onClick:2})}}function nn(r,e,l){const t=r.slice();return t[7]=e[l],t}function bs(r){let e,l,t=re(r[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=rn(nn(r,t,s));const o=s=>D(n[s],1,1,()=>{n[s]=null});return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=ne()},l(s){for(let a=0;a<n.length;a+=1)n[a].l(s);e=ne()},m(s,a){for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(s,a);N(s,e,a),l=!0},p(s,a){if(a&5){t=re(s[0]);let i;for(i=0;i<t.length;i+=1){const c=nn(s,t,i);n[i]?(n[i].p(c,a),C(n[i],1)):(n[i]=rn(c),n[i].c(),C(n[i],1),n[i].m(e.parentNode,e))}for(se(),i=t.length;i<n.length;i+=1)o(i);ie()}},i(s){if(!l){for(let a=0;a<t.length;a+=1)C(n[a]);l=!0}},o(s){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)D(n[a]);l=!1},d(s){s&&u(e),ye(n,s)}}}function ps(r){let e,l;return e=new tt({}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p:Y,i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function rn(r){let e,l;function t(){return r[5](r[7])}return e=new vs({props:{data:r[7],onClick:t,expanded:r[2]==r[7].id}}),{c(){j(e.$$.fragment)},l(n){z(e.$$.fragment,n)},m(n,o){F(e,n,o),l=!0},p(n,o){r=n;const s={};o&1&&(s.data=r[7]),o&5&&(s.onClick=t),o&5&&(s.expanded=r[2]==r[7].id),e.$set(s)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){D(e.$$.fragment,n),l=!1},d(n){G(e,n)}}}function ks(r){let e,l,t,n;const o=[ps,bs],s=[];function a(i,c){return i[1]?0:1}return l=a(r),t=s[l]=o[l](r),{c(){e=k("div"),t.c(),this.h()},l(i){e=w(i,"DIV",{class:!0});var c=I(e);t.l(c),c.forEach(u),this.h()},h(){h(e,"class","flex flex-col")},m(i,c){N(i,e,c),s[l].m(e,null),n=!0},p(i,[c]){let f=l;l=a(i),l===f?s[l].p(i,c):(se(),D(s[f],1,1,()=>{s[f]=null}),ie(),t=s[l],t?t.p(i,c):(t=s[l]=o[l](i),t.c()),C(t,1),t.m(e,null))},i(i){n||(C(t),n=!0)},o(i){D(t),n=!1},d(i){i&&u(e),s[l].d()}}}function ws(r,e,l){let{service:t}=e,{rid:n}=e,o=[],s=!0;(async()=>{l(1,s=!0);const f=await t.api.get_row_history(t.sheetid,n);f.ok&&(l(0,o=f.data),l(1,s=!1))})();let i;const c=f=>{l(2,i=f.id)};return r.$$set=f=>{"service"in f&&l(3,t=f.service),"rid"in f&&l(4,n=f.rid)},[o,s,i,t,n,c]}class ys extends ve{constructor(e){super(),be(this,e,ws,ks,de,{service:3,rid:4})}}function Cs(r){let e,l,t,n;function o(i){r[9](i)}function s(i){r[10](i)}let a={columns:r[0],service:r[2]};return r[5]!==void 0&&(a.current_cells=r[5]),r[6]!==void 0&&(a.modified_cells=r[6]),e=new os({props:a}),Be.push(()=>Re(e,"current_cells",o)),Be.push(()=>Re(e,"modified_cells",s)),{c(){j(e.$$.fragment)},l(i){z(e.$$.fragment,i)},m(i,c){F(e,i,c),n=!0},p(i,c){const f={};c&1&&(f.columns=i[0]),c&4&&(f.service=i[2]),!l&&c&32&&(l=!0,f.current_cells=i[5],Me(()=>l=!1)),!t&&c&64&&(t=!0,f.modified_cells=i[6],Me(()=>t=!1)),e.$set(f)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){D(e.$$.fragment,i),n=!1},d(i){G(e,i)}}}function Es(r){let e,l;return e=new fs({props:{service:r[2],rid:r[1].__id,gotoSiblingSheet:r[4]}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n&4&&(o.service=t[2]),n&2&&(o.rid=t[1].__id),n&16&&(o.gotoSiblingSheet=t[4]),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Ts(r){let e,l;return e=new ys({props:{service:r[2],rid:r[1].__id}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n&4&&(o.service=t[2]),n&2&&(o.rid=t[1].__id),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Ss(r){let e,l;return e=new kn({props:{title:"Edit Row",onSave:r[11],onDelete:r[12],new_record:!1,$$slots:{history:[Ts],relation:[Es],edit:[Cs]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,[n]){const o={};n&232&&(o.onSave=t[11]),n&6&&(o.onDelete=t[12]),n&8311&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Ds(r,e,l){let{columns:t}=e,{row:n}=e,{cells:o}=e,{service:s}=e,{onSave:a}=e,{gotoSiblingSheet:i=(v,$)=>{}}=e,c=o[n.__id]||{},f={},d="";function _(v){c=v,l(5,c)}function m(v){f=v,l(6,f)}const y=async()=>{const v={...c};Object.keys(v).forEach(T=>{f[T]||delete v[T]});const $=await a(v);$.ok?l(6,f={}):l(7,d=$.data)},b=async()=>{await s.remove_row_cell(String(n.__id)),s.close_big_modal()};return r.$$set=v=>{"columns"in v&&l(0,t=v.columns),"row"in v&&l(1,n=v.row),"cells"in v&&l(8,o=v.cells),"service"in v&&l(2,s=v.service),"onSave"in v&&l(3,a=v.onSave),"gotoSiblingSheet"in v&&l(4,i=v.gotoSiblingSheet)},r.$$.update=()=>{r.$$.dirty&32&&console.log("@current_cells",c)},[t,n,s,a,i,c,f,d,o,_,m,y,b]}class Is extends ve{constructor(e){super(),be(this,e,Ds,Ss,de,{columns:0,row:1,cells:8,service:2,onSave:3,gotoSiblingSheet:4})}}function on(r,e,l){const t=r.slice();return t[9]=e[l],t}function sn(r){let e,l,t;function n(...a){return r[6](r[9],...a)}function o(a){r[7](a)}let s={service:r[4],column:r[9],celldata:r[0][r[9].__id],onCellChange:n};return r[1]!==void 0&&(s.open_column=r[1]),e=new wn({props:s}),Be.push(()=>Re(e,"open_column",o)),{c(){j(e.$$.fragment)},l(a){z(e.$$.fragment,a)},m(a,i){F(e,a,i),t=!0},p(a,i){r=a;const c={};i&16&&(c.service=r[4]),i&4&&(c.column=r[9]),i&5&&(c.celldata=r[0][r[9].__id]),i&5&&(c.onCellChange=n),!l&&i&2&&(l=!0,c.open_column=r[1],Me(()=>l=!1)),e.$set(c)},i(a){t||(C(e.$$.fragment,a),t=!0)},o(a){D(e.$$.fragment,a),t=!1},d(a){G(e,a)}}}function Ns(r){let e,l,t=re(r[2]),n=[];for(let s=0;s<t.length;s+=1)n[s]=sn(on(r,t,s));const o=s=>D(n[s],1,1,()=>{n[s]=null});return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=ne()},l(s){for(let a=0;a<n.length;a+=1)n[a].l(s);e=ne()},m(s,a){for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(s,a);N(s,e,a),l=!0},p(s,a){if(a&23){t=re(s[2]);let i;for(i=0;i<t.length;i+=1){const c=on(s,t,i);n[i]?(n[i].p(c,a),C(n[i],1)):(n[i]=sn(c),n[i].c(),C(n[i],1),n[i].m(e.parentNode,e))}for(se(),i=t.length;i<n.length;i+=1)o(i);ie()}},i(s){if(!l){for(let a=0;a<t.length;a+=1)C(n[a]);l=!0}},o(s){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)D(n[a]);l=!1},d(s){s&&u(e),ye(n,s)}}}function $s(r){let e,l;return e=new kn({props:{title:"Add Row",message:r[5],onSave:r[8],$$slots:{default:[Ns]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,[n]){const o={};n&32&&(o.message=t[5]),n&41&&(o.onSave=t[8]),n&4119&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Vs(r,e,l){let{columns:t}=e,{onSave:n}=e,{service:o}=e,{open_column:s}=e,{dirty_data:a={}}=e,i="";const c=(_,m)=>{const y=a[_.__id]||{};l(0,a[_.__id]={...y,...m},a)};function f(_){s=_,l(1,s)}const d=async()=>{const _=await n(a);_.ok?l(5,i=""):l(5,i=_.data)};return r.$$set=_=>{"columns"in _&&l(2,t=_.columns),"onSave"in _&&l(3,n=_.onSave),"service"in _&&l(4,o=_.service),"open_column"in _&&l(1,s=_.open_column),"dirty_data"in _&&l(0,a=_.dirty_data)},r.$$.update=()=>{r.$$.dirty&1&&console.log("@dirty_data",a)},[a,s,t,n,o,i,c,f,d]}class Ls extends ve{constructor(e){super(),be(this,e,Vs,$s,de,{columns:2,onSave:3,service:4,open_column:1,dirty_data:0})}}function As(r){let e,l,t='<h1 class="block mb-2 text-2xl text-gray-700">Are you sure you want to delete the sheet  ?</h1>',n,o,s,a,i,c,f,d,_,m,y="Yes",b,v,$="No",T,S;return{c(){e=k("div"),l=k("div"),l.innerHTML=t,n=O(),o=k("div"),s=Z("[ "),a=Z(r[0]),i=Z(" / "),c=Z(r[1]),f=Z("]"),d=O(),_=k("div"),m=k("button"),m.textContent=y,b=O(),v=k("button"),v.textContent=$,this.h()},l(E){e=w(E,"DIV",{class:!0});var p=I(e);l=w(p,"DIV",{class:!0,"data-svelte-h":!0}),ue(l)!=="svelte-1u38ifp"&&(l.innerHTML=t),n=P(p),o=w(p,"DIV",{});var V=I(o);s=W(V,"[ "),a=W(V,r[0]),i=W(V," / "),c=W(V,r[1]),f=W(V,"]"),V.forEach(u),d=P(p),_=w(p,"DIV",{class:!0});var L=I(_);m=w(L,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(m)!=="svelte-1b9p0h4"&&(m.textContent=y),b=P(L),v=w(L,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(v)!=="svelte-1l7apan"&&(v.textContent=$),L.forEach(u),p.forEach(u),this.h()},h(){h(l,"class","mb-4"),h(m,"class","px-2 py-1 font-bold text-white bg-blue-500 hover:bg-blue-700 focus:outline-none focus:shadow-outline rounded mt-1 "),h(v,"class","px-2 py-1 font-bold text-white bg-blue-300 hover:bg-blue-400 focus:outline-none focus:shadow-outline rounded mt-1 "),h(_,"class","flex justify-end gap-1 mt-10 border-t"),h(e,"class","flex flex-col h-full")},m(E,p){N(E,e,p),g(e,l),g(e,n),g(e,o),g(o,s),g(o,a),g(o,i),g(o,c),g(o,f),g(e,d),g(e,_),g(_,m),g(_,b),g(_,v),T||(S=[le(m,"click",function(){Oe(r[2])&&r[2].apply(this,arguments)}),le(v,"click",function(){Oe(r[3])&&r[3].apply(this,arguments)})],T=!0)},p(E,[p]){r=E,p&1&&_e(a,r[0]),p&2&&_e(c,r[1])},i:Y,o:Y,d(E){E&&u(e),T=!1,Xe(S)}}}function Bs(r,e,l){let{name:t=""}=e,{sheet_id:n=0}=e,{Confirm:o=()=>{}}=e,{Deny:s=()=>{}}=e;return r.$$set=a=>{"name"in a&&l(0,t=a.name),"sheet_id"in a&&l(1,n=a.sheet_id),"Confirm"in a&&l(2,o=a.Confirm),"Deny"in a&&l(3,s=a.Deny)},[t,n,o,s]}class Os extends ve{constructor(e){super(),be(this,e,Bs,As,de,{name:0,sheet_id:1,Confirm:2,Deny:3})}}function Ps(r){let e,l,t="Name",n,o,s,a,i,c,f="Options",d,_,m,y,b,v,$="Color",T,S,E,p,V,L,K="Ref Sheet",M,A,B,q,ee,fe,ke="Ref Column",X,U,J,he,Q,pe,Ne="Remote Hook",Ee,R,ce,x,H,ae,we="Extra Options",$e,te,me,Ie,Ce,Pe,ot;function xe(oe){r[7](oe)}function et(oe){r[8](oe)}let He={data:r[0].extraopts||{}};return r[2]!==void 0&&(He.modified=r[2]),r[3]!==void 0&&(He.getData=r[3]),te=new $t({props:He}),Be.push(()=>Re(te,"modified",xe)),Be.push(()=>Re(te,"getData",et)),{c(){e=k("div"),l=k("label"),l.textContent=t,n=O(),o=k("input"),a=O(),i=k("div"),c=k("label"),c.textContent=f,d=O(),_=k("input"),y=O(),b=k("div"),v=k("label"),v.textContent=$,T=O(),S=k("input"),p=O(),V=k("div"),L=k("label"),L.textContent=K,M=O(),A=k("input"),q=O(),ee=k("div"),fe=k("label"),fe.textContent=ke,X=O(),U=k("input"),he=O(),Q=k("div"),pe=k("label"),pe.textContent=Ne,Ee=O(),R=k("input"),x=O(),H=k("div"),ae=k("label"),ae.textContent=we,$e=O(),j(te.$$.fragment),this.h()},l(oe){e=w(oe,"DIV",{class:!0});var ge=I(e);l=w(ge,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(l)!=="svelte-jo32ro"&&(l.textContent=t),n=P(ge),o=w(ge,"INPUT",{class:!0,id:!0,type:!0}),ge.forEach(u),a=P(oe),i=w(oe,"DIV",{class:!0});var Le=I(i);c=w(Le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(c)!=="svelte-r5w03c"&&(c.textContent=f),d=P(Le),_=w(Le,"INPUT",{class:!0,id:!0,type:!0}),Le.forEach(u),y=P(oe),b=w(oe,"DIV",{class:!0});var _t=I(b);v=w(_t,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(v)!=="svelte-qjxcts"&&(v.textContent=$),T=P(_t),S=w(_t,"INPUT",{class:!0,id:!0,type:!0}),_t.forEach(u),p=P(oe),V=w(oe,"DIV",{class:!0});var dt=I(V);L=w(dt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(L)!=="svelte-1d3iz7m"&&(L.textContent=K),M=P(dt),A=w(dt,"INPUT",{class:!0,id:!0,type:!0}),dt.forEach(u),q=P(oe),ee=w(oe,"DIV",{class:!0});var ht=I(ee);fe=w(ht,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(fe)!=="svelte-au0sl6"&&(fe.textContent=ke),X=P(ht),U=w(ht,"INPUT",{class:!0,id:!0,type:!0}),ht.forEach(u),he=P(oe),Q=w(oe,"DIV",{class:!0});var mt=I(Q);pe=w(mt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(pe)!=="svelte-1u4tt3w"&&(pe.textContent=Ne),Ee=P(mt),R=w(mt,"INPUT",{class:!0,id:!0,type:!0}),mt.forEach(u),x=P(oe),H=w(oe,"DIV",{class:!0});var gt=I(H);ae=w(gt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ue(ae)!=="svelte-xnldoe"&&(ae.textContent=we),$e=P(gt),z(te.$$.fragment,gt),gt.forEach(u),this.h()},h(){h(l,"class","block mb-2 text-sm font-bold text-gray-700"),h(l,"for","name"),h(o,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"),h(o,"id","name"),h(o,"type","text"),o.value=s=r[0].name,h(e,"class","mb-4"),h(c,"class","block mb-2 text-sm font-bold text-gray-700"),h(c,"for","options"),h(_,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"),h(_,"id","options"),h(_,"type","text"),_.value=m=r[0].opts||"",h(i,"class","mb-4"),h(v,"class","block mb-2 text-sm font-bold text-gray-700"),h(v,"for","color"),h(S,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"),h(S,"id","color"),h(S,"type","color"),S.value=E=r[0].color||"",h(b,"class","mb-4"),h(L,"class","block mb-2 text-sm font-bold text-gray-700"),h(L,"for","refsheet"),h(A,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"),h(A,"id","refsheet"),h(A,"type","number"),A.value=B=r[0].refsheet||0,h(V,"class","mb-4"),h(fe,"class","block mb-2 text-sm font-bold text-gray-700"),h(fe,"for","refcol"),h(U,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"),h(U,"id","refcol"),h(U,"type","number"),U.value=J=r[0].refcolumn||0,h(ee,"class","mb-4"),h(pe,"class","block mb-2 text-sm font-bold text-gray-700"),h(pe,"for","remotehook"),h(R,"class","w-full px-3 py-2 text-sm leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"),h(R,"id","remotehook"),h(R,"type","number"),R.value=ce=r[0].remotehook||0,h(Q,"class","mb-4"),h(ae,"class","block mb-2 text-sm font-bold text-gray-700"),h(ae,"for","extraopts"),h(H,"class","mb-4")},m(oe,ge){N(oe,e,ge),g(e,l),g(e,n),g(e,o),N(oe,a,ge),N(oe,i,ge),g(i,c),g(i,d),g(i,_),N(oe,y,ge),N(oe,b,ge),g(b,v),g(b,T),g(b,S),N(oe,p,ge),N(oe,V,ge),g(V,L),g(V,M),g(V,A),N(oe,q,ge),N(oe,ee,ge),g(ee,fe),g(ee,X),g(ee,U),N(oe,he,ge),N(oe,Q,ge),g(Q,pe),g(Q,Ee),g(Q,R),N(oe,x,ge),N(oe,H,ge),g(H,ae),g(H,$e),F(te,H,null),Ce=!0,Pe||(ot=[le(o,"change",r[5]("name")),le(_,"change",r[5]("opts")),le(S,"change",r[5]("color")),le(A,"change",r[6]("refsheet")),le(U,"change",r[6]("refcolumn")),le(R,"change",r[6]("remotehook"))],Pe=!0)},p(oe,ge){(!Ce||ge&1&&s!==(s=oe[0].name)&&o.value!==s)&&(o.value=s),(!Ce||ge&1&&m!==(m=oe[0].opts||"")&&_.value!==m)&&(_.value=m),(!Ce||ge&1&&E!==(E=oe[0].color||""))&&(S.value=E),(!Ce||ge&1&&B!==(B=oe[0].refsheet||0)&&A.value!==B)&&(A.value=B),(!Ce||ge&1&&J!==(J=oe[0].refcolumn||0)&&U.value!==J)&&(U.value=J),(!Ce||ge&1&&ce!==(ce=oe[0].remotehook||0)&&R.value!==ce)&&(R.value=ce);const Le={};ge&1&&(Le.data=oe[0].extraopts||{}),!me&&ge&4&&(me=!0,Le.modified=oe[2],Me(()=>me=!1)),!Ie&&ge&8&&(Ie=!0,Le.getData=oe[3],Me(()=>Ie=!1)),te.$set(Le)},i(oe){Ce||(C(te.$$.fragment,oe),Ce=!0)},o(oe){D(te.$$.fragment,oe),Ce=!1},d(oe){oe&&(u(e),u(a),u(i),u(y),u(b),u(p),u(V),u(q),u(ee),u(he),u(Q),u(x),u(H)),G(te),Pe=!1,Xe(ot)}}}function Us(r){let e,l;return e=new bn({props:{title:"Edit Column "+r[0].__id,onSave:r[9],onDelete:r[10],$$slots:{default:[Ps]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,[n]){const o={};n&1&&(o.title="Edit Column "+t[0].__id),n&19&&(o.onSave=t[9]),n&3&&(o.onDelete=t[10]),n&4109&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Ms(r,e,l){let{column:t}=e,{service:n}=e,o=!1,s;const a={},i=y=>b=>{l(4,a[y]=b.target.value,a)},c=y=>b=>{l(4,a[y]=Number(b.target.value),a)};function f(y){o=y,l(2,o)}function d(y){s=y,l(3,s)}const _=async()=>{await n.update_column(String(t.__id),a),n.close_small_modal(),n.init()},m=async()=>{await n.remove_column(String(t.__id)),n.close_small_modal(),n.init()};return r.$$set=y=>{"column"in y&&l(0,t=y.column),"service"in y&&l(1,n=y.service)},[t,n,o,s,a,i,c,f,d,_,m]}class Rs extends ve{constructor(e){super(),be(this,e,Ms,Us,de,{column:0,service:1})}}function an(r,e,l){const t=r.slice();return t[13]=e[l],t}function cn(r){let e,l=r[13].name+"",t,n;return{c(){e=k("option"),t=Z(l),this.h()},l(o){e=w(o,"OPTION",{});var s=I(e);t=W(s,l),s.forEach(u),this.h()},h(){e.__value=n=r[13].__id,Te(e,e.__value)},m(o,s){N(o,e,s),g(e,t)},p(o,s){s&2&&l!==(l=o[13].name+"")&&_e(t,l),s&2&&n!==(n=o[13].__id)&&(e.__value=n,Te(e,e.__value))},d(o){o&&u(e)}}}function Hs(r){let e,l,t;return l=new yt({props:{editable:!1,cells:r[5].cells||{},columns:r[5].columns||[],rows:r[5].rows||[],selected_rows:[],pick_label:"goto"}}),l.$on("pick_row",r[12]),{c(){e=k("div"),j(l.$$.fragment),this.h()},l(n){e=w(n,"DIV",{class:!0});var o=I(e);z(l.$$.fragment,o),o.forEach(u),this.h()},h(){h(e,"class","p-1 border rounded shadow overflow-auto")},m(n,o){N(n,e,o),F(l,e,null),t=!0},p(n,o){const s={};o&32&&(s.cells=n[5].cells||{}),o&32&&(s.columns=n[5].columns||[]),o&32&&(s.rows=n[5].rows||[]),l.$set(s)},i(n){t||(C(l.$$.fragment,n),t=!0)},o(n){D(l.$$.fragment,n),t=!1},d(n){n&&u(e),G(l)}}}function js(r){let e,l;return e=new tt({props:{classes:""}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p:Y,i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function zs(r){let e,l,t="Search",n,o,s,a,i,c,f,d,_,m,y,b,v,$,T="Count",S,E,p,V="10",L,K="50",M,A="100",B,q,ee,fe="Column",ke,X,U,J="*",he,Q,pe,Ne,Ee,R,ce;a=new De({props:{name:"search",class:"h-5 w-5"}}),_=new De({props:{name:"search",class:"h-5 w-5"}});let x=re(r[1]),H=[];for(let te=0;te<x.length;te+=1)H[te]=cn(an(r,x,te));const ae=[js,Hs],we=[];function $e(te,me){return te[3]?0:te[5]?1:-1}return~(Q=$e(r))&&(pe=we[Q]=ae[Q](r)),{c(){e=k("form"),l=k("label"),l.textContent=t,n=O(),o=k("div"),s=k("div"),j(a.$$.fragment),i=O(),c=k("input"),f=O(),d=k("button"),j(_.$$.fragment),m=O(),y=k("div"),b=k("div"),v=k("label"),$=k("span"),$.textContent=T,S=O(),E=k("select"),p=k("option"),p.textContent=V,L=k("option"),L.textContent=K,M=k("option"),M.textContent=A,B=O(),q=k("label"),ee=k("span"),ee.textContent=fe,ke=O(),X=k("select"),U=k("option"),U.textContent=J;for(let te=0;te<H.length;te+=1)H[te].c();he=O(),pe&&pe.c(),Ne=ne(),this.h()},l(te){e=w(te,"FORM",{class:!0});var me=I(e);l=w(me,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ue(l)!=="svelte-1teuda"&&(l.textContent=t),n=P(me),o=w(me,"DIV",{class:!0});var Ie=I(o);s=w(Ie,"DIV",{class:!0});var Ce=I(s);z(a.$$.fragment,Ce),Ce.forEach(u),i=P(Ie),c=w(Ie,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),Ie.forEach(u),f=P(me),d=w(me,"BUTTON",{type:!0,class:!0});var Pe=I(d);z(_.$$.fragment,Pe),Pe.forEach(u),me.forEach(u),m=P(te),y=w(te,"DIV",{class:!0});var ot=I(y);b=w(ot,"DIV",{class:!0});var xe=I(b);v=w(xe,"LABEL",{class:!0});var et=I(v);$=w(et,"SPAN",{class:!0,"data-svelte-h":!0}),ue($)!=="svelte-lf4cij"&&($.textContent=T),S=P(et),E=w(et,"SELECT",{class:!0});var He=I(E);p=w(He,"OPTION",{"data-svelte-h":!0}),ue(p)!=="svelte-y0h8wa"&&(p.textContent=V),L=w(He,"OPTION",{"data-svelte-h":!0}),ue(L)!=="svelte-dy0itu"&&(L.textContent=K),M=w(He,"OPTION",{"data-svelte-h":!0}),ue(M)!=="svelte-1xd1rlo"&&(M.textContent=A),He.forEach(u),et.forEach(u),B=P(xe),q=w(xe,"LABEL",{class:!0});var oe=I(q);ee=w(oe,"SPAN",{class:!0,"data-svelte-h":!0}),ue(ee)!=="svelte-ru32ta"&&(ee.textContent=fe),ke=P(oe),X=w(oe,"SELECT",{class:!0});var ge=I(X);U=w(ge,"OPTION",{"data-svelte-h":!0}),ue(U)!=="svelte-1rvf98a"&&(U.textContent=J);for(let Le=0;Le<H.length;Le+=1)H[Le].l(ge);ge.forEach(u),oe.forEach(u),xe.forEach(u),ot.forEach(u),he=P(te),pe&&pe.l(te),Ne=ne(),this.h()},h(){h(l,"for","simple-search"),h(l,"class","sr-only"),h(s,"class","flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"),h(c,"type","text"),h(c,"id","simple-search"),h(c,"class","bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"),h(c,"placeholder","Search"),c.required=!0,h(o,"class","relative w-full"),h(d,"type","submit"),h(d,"class","p-2.5 ml-2 text-sm font-medium text-white bg-blue-700 rounded-lg border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"),h(e,"class","flex items-center"),h($,"class","ml-2 text-gray-700"),p.__value="10",Te(p,p.__value),L.__value="50",Te(L,L.__value),M.__value="100",Te(M,M.__value),h(E,"class","font-medium rounded text-sm p-1"),r[6]===void 0&&at(()=>r[10].call(E)),h(v,"class","inline-flex items-center"),h(ee,"class","ml-2 text-gray-700"),U.__value="",Te(U,U.__value),h(X,"class","font-medium rounded text-sm p-1"),r[4]===void 0&&at(()=>r[11].call(X)),h(q,"class","inline-flex items-center"),h(b,"class","flex flex-wrap text-sm p-1 gap-1"),h(y,"class","flex flex-wrap justify-between text-sm")},m(te,me){N(te,e,me),g(e,l),g(e,n),g(e,o),g(o,s),F(a,s,null),g(o,i),g(o,c),Te(c,r[2]),g(e,f),g(e,d),F(_,d,null),N(te,m,me),N(te,y,me),g(y,b),g(b,v),g(v,$),g(v,S),g(v,E),g(E,p),g(E,L),g(E,M),Ve(E,r[6],!0),g(b,B),g(b,q),g(q,ee),g(q,ke),g(q,X),g(X,U);for(let Ie=0;Ie<H.length;Ie+=1)H[Ie]&&H[Ie].m(X,null);Ve(X,r[4],!0),N(te,he,me),~Q&&we[Q].m(te,me),N(te,Ne,me),Ee=!0,R||(ce=[le(c,"input",r[8]),le(d,"click",En(r[9])),le(E,"change",r[10]),le(X,"change",r[11])],R=!0)},p(te,[me]){if(me&4&&c.value!==te[2]&&Te(c,te[2]),me&64&&Ve(E,te[6]),me&2){x=re(te[1]);let Ce;for(Ce=0;Ce<x.length;Ce+=1){const Pe=an(te,x,Ce);H[Ce]?H[Ce].p(Pe,me):(H[Ce]=cn(Pe),H[Ce].c(),H[Ce].m(X,null))}for(;Ce<H.length;Ce+=1)H[Ce].d(1);H.length=x.length}me&18&&Ve(X,te[4]);let Ie=Q;Q=$e(te),Q===Ie?~Q&&we[Q].p(te,me):(pe&&(se(),D(we[Ie],1,1,()=>{we[Ie]=null}),ie()),~Q?(pe=we[Q],pe?pe.p(te,me):(pe=we[Q]=ae[Q](te),pe.c()),C(pe,1),pe.m(Ne.parentNode,Ne)):pe=null)},i(te){Ee||(C(a.$$.fragment,te),C(_.$$.fragment,te),C(pe),Ee=!0)},o(te){D(a.$$.fragment,te),D(_.$$.fragment,te),D(pe),Ee=!1},d(te){te&&(u(e),u(m),u(y),u(he),u(Ne)),G(a),G(_),ye(H,te),~Q&&we[Q].d(te),R=!1,Xe(ce)}}}function Fs(r,e,l){let{service:t}=e,{columns:n}=e,o="",s=!1,a="",i,c="10";const f=async()=>{l(3,s=!0);let v=0,$=ft;if(a){const S=n.filter(E=>E.__id!==Number(a))[0];S&&(v=S.__id,$=S.ctype)}const T=await t.search({search_term:o,column_id:v,column_type:$,count:Number(c)});if(!T.ok){console.log("@resp",T);return}l(5,i=gn({...T.data,sheet_id:t.sheetid})),l(3,s=!1)};function d(){o=this.value,l(2,o)}const _=()=>f();function m(){c=st(this),l(6,c)}function y(){a=st(this),l(4,a),l(1,n)}const b=v=>{t.goto_row(v.detail.__id),t.close_big_modal()};return r.$$set=v=>{"service"in v&&l(0,t=v.service),"columns"in v&&l(1,n=v.columns)},[t,n,o,s,a,i,c,f,d,_,m,y,b]}class Gs extends ve{constructor(e){super(),be(this,e,Fs,zs,de,{service:0,columns:1})}}function qs(r){let e,l,t='<h1 class="block mb-2 text-2xl text-gray-700">Do you want to goto record ?</h1>',n,o,s,a=`${r[2]} ${r[3]}`,i,c,f=` ${r[5]} ${r[4]}`,d,_,m,y,b,v="Yes",$,T,S="No",E,p;return{c(){e=k("div"),l=k("div"),l.innerHTML=t,n=O(),o=k("div"),s=Z("[ "),i=Z(a),c=Z(" / "),d=Z(f),_=Z(" ]"),m=O(),y=k("div"),b=k("button"),b.textContent=v,$=O(),T=k("button"),T.textContent=S,this.h()},l(V){e=w(V,"DIV",{class:!0});var L=I(e);l=w(L,"DIV",{class:!0,"data-svelte-h":!0}),ue(l)!=="svelte-6w4l8f"&&(l.innerHTML=t),n=P(L),o=w(L,"DIV",{});var K=I(o);s=W(K,"[ "),i=W(K,a),c=W(K," / "),d=W(K,f),_=W(K," ]"),K.forEach(u),m=P(L),y=w(L,"DIV",{class:!0});var M=I(y);b=w(M,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(b)!=="svelte-ijzpk2"&&(b.textContent=v),$=P(M),T=w(M,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(T)!=="svelte-e9wytc"&&(T.textContent=S),M.forEach(u),L.forEach(u),this.h()},h(){h(l,"class","mb-4"),h(b,"class","px-2 py-1 font-bold text-white bg-blue-500 hover:bg-blue-700 focus:outline-none focus:shadow-outline rounded mt-1"),h(T,"class","px-2 py-1 font-bold text-white bg-blue-300 hover:bg-blue-400 focus:outline-none focus:shadow-outline rounded mt-1"),h(y,"class","flex justify-end gap-1 mt-10 border-t"),h(e,"class","flex flex-col h-full")},m(V,L){N(V,e,L),g(e,l),g(e,n),g(e,o),g(o,s),g(o,i),g(o,c),g(o,d),g(o,_),g(e,m),g(e,y),g(y,b),g(y,$),g(y,T),E||(p=[le(b,"click",function(){Oe(r[1])&&r[1].apply(this,arguments)}),le(T,"click",r[6])],E=!0)},p(V,[L]){r=V,L&12&&a!==(a=`${r[2]} ${r[3]}`)&&_e(i,a),L&48&&f!==(f=` ${r[5]} ${r[4]}`)&&_e(d,f)},i:Y,o:Y,d(V){V&&u(e),E=!1,Xe(p)}}}function Js(r,e,l){let{service:t}=e,{onYes:n=()=>{}}=e,{sheet_name:o}=e,{sheet_id:s}=e,{row_id:a}=e,{row_name:i}=e;const c=()=>{t.close_small_modal()};return r.$$set=f=>{"service"in f&&l(0,t=f.service),"onYes"in f&&l(1,n=f.onYes),"sheet_name"in f&&l(2,o=f.sheet_name),"sheet_id"in f&&l(3,s=f.sheet_id),"row_id"in f&&l(4,a=f.row_id),"row_name"in f&&l(5,i=f.row_name)},[t,n,o,s,a,i,c]}class Ys extends ve{constructor(e){super(),be(this,e,Js,qs,de,{service:0,onYes:1,sheet_name:2,sheet_id:3,row_id:4,row_name:5})}}function fn(r,e,l){const t=r.slice();return t[3]=e[l],t}function un(r){let e,l,t,n,o,s,a=r[3].name+"",i,c,f,d=r[3].info+"",_,m,y,b,v;return t=new De({props:{name:r[3].icon,class:"text-gray-700"}}),{c(){e=k("button"),l=k("div"),j(t.$$.fragment),n=O(),o=k("div"),s=k("p"),i=Z(a),c=O(),f=k("span"),_=Z(d),m=O(),this.h()},l($){e=w($,"BUTTON",{class:!0});var T=I(e);l=w(T,"DIV",{class:!0});var S=I(l);z(t.$$.fragment,S),S.forEach(u),n=P(T),o=w(T,"DIV",{class:!0});var E=I(o);s=w(E,"P",{class:!0});var p=I(s);i=W(p,a),p.forEach(u),c=P(E),f=w(E,"SPAN",{class:!0});var V=I(f);_=W(V,d),V.forEach(u),E.forEach(u),m=P(T),T.forEach(u),this.h()},h(){h(l,"class","flex h-12 w-12 items-center rounded-lg bg-gray-200 text-black group-hover:bg-blue-200"),h(s,"class","text-[15px]"),h(f,"class","text-xs font-light text-gray-400"),h(o,"class","flex flex-col items-start justify-between font-light text-gray-600"),h(e,"class","group flex gap-y-2 items-center gap-x-5 rounded-md px-2.5 py-2 transition-all duration-75 hover:bg-blue-100")},m($,T){N($,e,T),g(e,l),F(t,l,null),g(e,n),g(e,o),g(o,s),g(s,i),g(o,c),g(o,f),g(f,_),g(e,m),y=!0,b||(v=le(e,"click",r[3].func),b=!0)},p($,T){r=$},i($){y||(C(t.$$.fragment,$),y=!0)},o($){D(t.$$.fragment,$),y=!1},d($){$&&u(e),G(t),b=!1,v()}}}function Zs(r){let e,l,t=re(r[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=un(fn(r,t,s));const o=s=>D(n[s],1,1,()=>{n[s]=null});return{c(){e=k("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){e=w(s,"DIV",{class:!0});var a=I(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(u),this.h()},h(){h(e,"class","flex flex-col gap-2")},m(s,a){N(s,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);l=!0},p(s,[a]){if(a&1){t=re(s[0]);let i;for(i=0;i<t.length;i+=1){const c=fn(s,t,i);n[i]?(n[i].p(c,a),C(n[i],1)):(n[i]=un(c),n[i].c(),C(n[i],1),n[i].m(e,null))}for(se(),i=t.length;i<n.length;i+=1)o(i);ie()}},i(s){if(!l){for(let a=0;a<t.length;a+=1)C(n[a]);l=!0}},o(s){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)D(n[a]);l=!1},d(s){s&&u(e),ye(n,s)}}}function Ws(r,e,l){let{service:t}=e,o=[{name:"Export",icon:"download",info:"Export data as json.",func:()=>{t.export()}},{name:"Import",icon:"upload",info:"Import data as json.",func:()=>{}},{name:"View Options",icon:"adjustments",info:"Set view options.",func:()=>{}}];return r.$$set=s=>{"service"in s&&l(1,t=s.service)},[o,t]}class Ks extends ve{constructor(e){super(),be(this,e,Ws,Zs,de,{service:1})}}function Xs(r){let e=r[12],l,t,n=_n(r);return{c(){n.c(),l=ne()},l(o){n.l(o),l=ne()},m(o,s){n.m(o,s),N(o,l,s),t=!0},p(o,s){s[0]&4096&&de(e,e=o[12])?(se(),D(n,1,1,Y),ie(),n=_n(o),n.c(),C(n,1),n.m(l.parentNode,l)):n.p(o,s)},i(o){t||(C(n),t=!0)},o(o){D(n),t=!1},d(o){o&&u(l),n.d(o)}}}function Qs(r){let e,l;return e=new tt({}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p:Y,i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function _n(r){let e,l,t;function n(s){r[27](s)}let o={folder_api:r[7],active_sheet:Number(r[2]),cells:r[10].cells,columns:r[10].columns,rows:r[10].rows,sheets:r[11],widgets:r[10].widgets,profile_genrator:r[6].profile_genrator};return r[9]!==void 0&&(o.selected_rows=r[9]),e=new br({props:o}),Be.push(()=>Re(e,"selected_rows",n)),e.$on("add_column",r[16]),e.$on("action_goto_history",r[28]),e.$on("action_goto_rawtable",r[29]),e.$on("add_row",r[30]),e.$on("edit_row",r[18]),e.$on("action_refresh",r[31]),e.$on("add_sheet",r[14]),e.$on("change_sheet",r[32]),e.$on("mounted",r[33]),e.$on("action_extra",r[24]),e.$on("ref_preview",r[22]),e.$on("remove_sheet",r[15]),e.$on("edit_column",r[17]),e.$on("action_search",r[20]),e.$on("action_run_widget",r[21]),e.$on("action_delete_trash",r[23]),e.$on("scroll_top",function(){Oe(r[6].scroll_top)&&r[6].scroll_top.apply(this,arguments)}),e.$on("scroll_bottom",function(){Oe(r[6].scroll_bottom)&&r[6].scroll_bottom.apply(this,arguments)}),e.$on("action_clear_selects",r[25]),e.$on("action_clone",r[26]),{c(){j(e.$$.fragment)},l(s){z(e.$$.fragment,s)},m(s,a){F(e,s,a),t=!0},p(s,a){r=s;const i={};a[0]&128&&(i.folder_api=r[7]),a[0]&4&&(i.active_sheet=Number(r[2])),a[0]&1024&&(i.cells=r[10].cells),a[0]&1024&&(i.columns=r[10].columns),a[0]&1024&&(i.rows=r[10].rows),a[0]&2048&&(i.sheets=r[11]),a[0]&1024&&(i.widgets=r[10].widgets),a[0]&64&&(i.profile_genrator=r[6].profile_genrator),!l&&a[0]&512&&(l=!0,i.selected_rows=r[9],Me(()=>l=!1)),e.$set(i)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function xs(r){let e,l,t,n;const o=[Qs,Xs],s=[];function a(i,c){return i[4]||i[10].loading?0:1}return e=a(r),l=s[e]=o[e](r),{c(){l.c(),t=ne()},l(i){l.l(i),t=ne()},m(i,c){s[e].m(i,c),N(i,t,c),n=!0},p(i,c){let f=e;e=a(i),e===f?s[e].p(i,c):(se(),D(s[f],1,1,()=>{s[f]=null}),ie(),l=s[e],l?l.p(i,c):(l=s[e]=o[e](i),l.c()),C(l,1),l.m(t.parentNode,t))},i(i){n||(C(l),n=!0)},o(i){D(l),n=!1},d(i){i&&u(t),s[e].d(i)}}}function ei(r,e,l){let t,n=Y,o=()=>(n(),n=Vt(b,H=>l(10,t=H)),b),s,a=Y,i=()=>(a(),a=Vt(S,H=>l(11,s=H)),S),c;r.$$.on_destroy.push(()=>n()),r.$$.on_destroy.push(()=>a());let{source:f}=e,{group:d}=e,{sheetid:_}=e;const m=Tn("__app__");let y=!0,b,v,$,T,S,E=[];(async()=>{const ae=await(await m.get_data_service()).group_sheet(f,d);if(Ct(ae.sheets).length===0)return;i(l(8,S=ae.sheets));let we;m.nav.options&&(we=m.nav.options.row_cursor_id,l(3,m.nav.options={},m));const $e=await ae.get_sheet_service(_,we);l(6,v=$e),o(l(5,b=$e.state)),v.force_render_index,l(7,T=v.group.folder_api),l(4,y=!1)})();const V=()=>{m.utils.small_modal_open(Ur,{onAdd:async(H,ae)=>{await v.add_sheet(H,ae),m.utils.small_modal_close()}})},L=()=>{const H=Ct(v.group.sheets).filter(ae=>ae.__id===Number(_))[0];m.utils.small_modal_open(Os,{name:H.name,sheet_id:_,Confirm:async()=>{await v.remove_sheet(),m.utils.small_modal_close(),m.nav.data_sheets_page(f,d)},Deny:()=>m.utils.small_modal_close()})},K=()=>{m.utils.small_modal_open($r,{sheets:s,sheetid:_,service:v,onAdd:async H=>{await v.add_column(H),m.utils.small_modal_close()}})},M=H=>{m.utils.small_modal_open(Rs,{column:H.detail,service:v})},A=H=>{m.utils.big_modal_open(Is,{columns:t.columns,cells:t.cells,service:v,row:H.detail,folder_api:T,gotoSiblingSheet:he,onSave:async ae=>{const we=await v.update_row_cell(H.detail.__id,ae);return we.ok&&m.utils.big_modal_close(),we}})},B=(H={})=>{m.utils.big_modal_open(Ls,{columns:t.columns,service:v,dirty_data:H,onSave:async ae=>{const we=await v.add_row_cell(ae);return we.ok&&m.utils.big_modal_close(),we}})},q=()=>{m.utils.big_modal_open(Gs,{service:v,columns:t.columns})},ee=H=>{const ae=H.detail;console.log("@widget",ae),m.launcher.instance_by_target({invoker_name:"data_sheet",target_id:String(ae.id),target_name:ae.name,target_type:Rn,startup_payload:v.get_exec_data(E),invoker:v.get_invoker(ae,m.launcher)}),Sn().then(()=>{m.launcher.plane_float()})},fe=({detail:H})=>{console.log("@ref_preview",H);const we=Ct(v.group.sheets).filter($e=>$e.__id!=H.sheetid)[0];m.utils.small_modal_open(Ys,{service:v,onYes:()=>{he(we.__id,Number(H.numval)-1),m.utils.small_modal_close()},sheet_name:we.name,sheet_id:we.__id,row_id:H.numval,row_name:H.value||""})},ke=({detail:H})=>{v.remove_row_cell(H),l(9,E=[])},X=()=>{m.utils.small_modal_open(Ks,{service:v})},U=()=>{l(9,E=[])},J=()=>{const H=E[0];if(!H)return;const ae=t.cells[H]||{};delete ae.__id,B(ae)},he=(H,ae)=>{m.nav.data_sheet_render_page(f,d,H,{row_cursor_id:ae})};function Q(H){E=H,l(9,E)}const pe=()=>m.nav.admin_data_activity(f,d,"scells"),Ne=()=>m.nav.data_group_page(f,d),Ee=()=>B(),R=()=>v.init(),ce=H=>{m.nav.data_sheet_render_page(f,d,H.detail)},x=({detail:H})=>{l(6,v.scroller=H.scroller,v),l(6,v.close_big_modal=m.utils.big_modal_close,v),l(6,v.close_small_modal=m.utils.small_modal_close,v)};return r.$$set=H=>{"source"in H&&l(0,f=H.source),"group"in H&&l(1,d=H.group),"sheetid"in H&&l(2,_=H.sheetid)},[f,d,_,m,y,b,v,T,S,E,t,s,c,$,V,L,K,M,A,B,q,ee,fe,ke,X,U,J,Q,pe,Ne,Ee,R,ce,x]}class ti extends ve{constructor(e){super(),be(this,e,ei,xs,de,{source:0,group:1,sheetid:2},null,[-1,-1])}}function dn(r){let e,l;return e=new ti({props:{group:r[2],sheetid:r[1],source:r[0]}}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){F(e,t,n),l=!0},p(t,n){const o={};n&4&&(o.group=t[2]),n&2&&(o.sheetid=t[1]),n&1&&(o.source=t[0]),e.$set(o)},i(t){l||(C(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function li(r){let e=r[1],l,t,n=dn(r);return{c(){n.c(),l=ne()},l(o){n.l(o),l=ne()},m(o,s){n.m(o,s),N(o,l,s),t=!0},p(o,[s]){s&2&&de(e,e=o[1])?(se(),D(n,1,1,Y),ie(),n=dn(o),n.c(),C(n,1),n.m(l.parentNode,l)):n.p(o,s)},i(o){t||(C(n),t=!0)},o(o){D(n),t=!1},d(o){o&&u(l),n.d(o)}}}function ni(r,e,l){let t,n,o,s;return Et(r,Hn,a=>l(3,s=a)),r.$$.update=()=>{r.$$.dirty&8&&l(2,t=s.dgroup||s.group),r.$$.dirty&8&&l(1,n=s.dsheet||s.sheetid),r.$$.dirty&8&&l(0,o=s.dsource||s.source||"default")},[o,n,t,s]}class Ci extends ve{constructor(e){super(),be(this,e,ni,li,de,{})}}export{Ci as component};
