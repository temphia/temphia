var cs=Object.defineProperty;var ds=(i,e,t)=>e in i?cs(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var a=(i,e,t)=>(ds(i,typeof e!="symbol"?e+"":e,t),t);import{s as ne,e as xe,i as P,D as F,d as b,B as je,E as dt,F as it,G as $t,u as qe,f as $,g as y,h as x,j as h,w,H as hs,x as Ge,y as We,z as Je,I as yt,J as Ke,K as ut,p as Ve,L as ye,a as B,c as N,C as ae,M as _s,A as H,N as re,O as ie,P as ts,b as fs,k as ps,Q as Fe,l as Se,m as Ie,n as ze,q as Ne,R as gs,S as ms,T as ct,U as tt,o as ss,r as bs}from"../chunks/scheduler.e2ee220a.js";import{S as de,i as he,a as E,g as X,t as S,c as Y,f as Et,h as xt,b as O,d as q,m as V,e as j,j as st}from"../chunks/index.4aee2103.js";import{H as Ze,b as rs,S as is}from"../chunks/routes_v2.65e45c81.js";import{w as Be,d as ws}from"../chunks/index.8ae06d0c.js";import{g as Re}from"../chunks/index.3b48e8d3.js";import{g as vs}from"../chunks/navigation.71e96a7c.js";import{g as ks}from"../chunks/formatter.40160f5e.js";import{D as $s,a as ys,b as Es}from"../chunks/table_types.a80667dc.js";import{f as xs,a as Ls}from"../chunks/format.8ac0f50c.js";import"../chunks/loading_spinner.svelte_svelte_type_style_lang.9f9ec163.js";import{L as as}from"../chunks/loading_spinner.4ceee987.js";import{e as Ae}from"../chunks/each.e59479a4.js";import{I as at,g as nt,a as ot}from"../chunks/Icon.9e22c3e4.js";import{U as Lt}from"../chunks/user.57c56987.js";import{G as Ts,S as Ss}from"../chunks/store2.b3ed835e.js";import"../chunks/paths.555c70f8.js";import{E as Is}from"../chunks/eframe.509c607f.js";import{g as ns}from"../chunks/stores.992a7bfe.js";import{p as As}from"../chunks/ProgressBar.svelte_svelte_type_style_lang.64bc79c7.js";import{g as Ds}from"../chunks/globals.7f7f1b26.js";import{f as Tt,a as St}from"../chunks/index.c225705b.js";import{t as It}from"../chunks/index.0864d2d3.js";function Ms(i,e){const t='a[href], button, input, textarea, select, details, [tabindex]:not([tabindex="-1"])';let s,r;function n(p){p.shiftKey&&p.code==="Tab"&&(p.preventDefault(),r.focus())}function o(p){!p.shiftKey&&p.code==="Tab"&&(p.preventDefault(),s.focus())}const l=p=>{if(e===!1)return;const k=Array.from(i.querySelectorAll(t));k.length&&(s=k[0],r=k[k.length-1],p||s.focus(),s.addEventListener("keydown",n),r.addEventListener("keydown",o))};l(!1);function c(){s&&s.removeEventListener("keydown",n),r&&r.removeEventListener("keydown",o)}const u=(p,k)=>(p.length&&(c(),l(!0)),k),_=new MutationObserver(u);return _.observe(i,{childList:!0,subtree:!0}),{update(p){e=p,p?l(!1):c()},destroy(){c(),_.disconnect()}}}function rt(i,e){const{transition:t,params:s,enabled:r}=e;return r?t(i,s):"duration"in s?t(i,{duration:0}):{duration:0}}const{window:Cs}=Ds;function At(i){let e,t,s,r,n,o,l,c,u,_,p;const k=i[31].default,g=qe(k,i,i[30],null);return{c(){e=$("div"),t=$("div"),g&&g.c(),this.h()},l(v){e=y(v,"DIV",{class:!0,"data-testid":!0});var f=x(e);t=y(f,"DIV",{class:!0,"data-testid":!0,role:!0,"aria-modal":!0,"aria-labelledby":!0,"aria-describedby":!0});var d=x(t);g&&g.l(d),d.forEach(b),f.forEach(b),this.h()},h(){h(t,"class",s="drawer "+i[7]),h(t,"data-testid","drawer"),h(t,"role","dialog"),h(t,"aria-modal","true"),h(t,"aria-labelledby",i[0]),h(t,"aria-describedby",i[1]),h(e,"class",o="drawer-backdrop "+i[8]),h(e,"data-testid","drawer-backdrop")},m(v,f){P(v,e,f),w(e,t),g&&g.m(t,null),i[35](t),i[36](e),u=!0,_||(p=[F(e,"mousedown",i[11]),F(e,"touchstart",i[32]),F(e,"touchend",i[33]),F(e,"keypress",i[34]),hs(Ms.call(null,e,!0))],_=!0)},p(v,f){i=v,g&&g.p&&(!u||f[0]&1073741824)&&Ge(g,k,i,i[30],u?Je(k,i[30],f,null):We(i[30]),null),(!u||f[0]&128&&s!==(s="drawer "+i[7]))&&h(t,"class",s),(!u||f[0]&1)&&h(t,"aria-labelledby",i[0]),(!u||f[0]&2)&&h(t,"aria-describedby",i[1]),(!u||f[0]&256&&o!==(o="drawer-backdrop "+i[8]))&&h(e,"class",o)},i(v){u||(E(g,v),v&&yt(()=>{u&&(n&&n.end(1),r=Et(t,rt,{transition:Tt,params:{x:i[6].x,y:i[6].y,duration:150,opacity:i[2]?void 0:1},enabled:i[3]}),r.start())}),v&&yt(()=>{u&&(c&&c.end(1),l=Et(e,rt,{transition:St,params:{duration:150},enabled:i[3]&&i[2]}),l.start())}),u=!0)},o(v){S(g,v),r&&r.invalidate(),v&&(n=xt(t,rt,{transition:Tt,params:{x:i[6].x,y:i[6].y,duration:150,opacity:i[2]?void 0:1},enabled:i[3]})),l&&l.invalidate(),v&&(c=xt(e,rt,{transition:St,params:{duration:150},enabled:i[3]&&i[2]})),u=!1},d(v){v&&b(e),g&&g.d(v),i[35](null),v&&n&&n.end(),i[36](null),v&&c&&c.end(),_=!1,Ke(p)}}}function Bs(i){let e,t,s,r,n=i[9].open===!0&&At(i);return{c(){n&&n.c(),e=xe()},l(o){n&&n.l(o),e=xe()},m(o,l){n&&n.m(o,l),P(o,e,l),t=!0,s||(r=F(Cs,"keydown",i[12]),s=!0)},p(o,l){o[9].open===!0?n?(n.p(o,l),l[0]&512&&E(n,1)):(n=At(o),n.c(),E(n,1),n.m(e.parentNode,e)):n&&(X(),S(n,1,1,()=>{n=null}),Y())},i(o){t||(E(n),t=!0)},o(o){S(n),t=!1},d(o){o&&b(e),n&&n.d(o),s=!1,r()}}}const Ns="fixed top-0 left-0 right-0 bottom-0 flex",Ps="overflow-y-auto transition-transform";function Hs(i,e,t){let s,r,n,o,l,c,u,_;je(i,As,L=>t(37,_=L));let{$$slots:p={},$$scope:k}=e;const g=dt();let{position:v="left"}=e,{bgBackdrop:f="bg-surface-backdrop-token"}=e,{blur:d=""}=e,{padding:m=""}=e,{bgDrawer:T="bg-surface-100-800-token"}=e,{border:I=""}=e,{rounded:A=""}=e,{shadow:D="shadow-xl"}=e,{width:W=""}=e,{height:z=""}=e,{zIndex:J="z-40"}=e,{regionBackdrop:oe=""}=e,{regionDrawer:U=""}=e,{labelledby:ee=""}=e,{describedby:le=""}=e,{transitions:Le=!_}=e,{opacityTransition:me=!0}=e;const C={top:{alignment:"items-start",width:"w-full",height:"h-[50%]",rounded:"rounded-bl-container-token rounded-br-container-token"},bottom:{alignment:"items-end",width:"w-full",height:" h-[50%]",rounded:"rounded-tl-container-token rounded-tr-container-token"},left:{alignment:"justify-start",width:"w-[90%]",height:"h-full",rounded:"rounded-tr-container-token rounded-br-container-token"},right:{alignment:"justify-end",width:"w-[90%]",height:"h-full",rounded:"rounded-tl-container-token rounded-bl-container-token"}};let _e,Te,ue={x:0,y:0};const fe=ns();je(i,fe,L=>t(9,u=L));const R={position:v,bgBackdrop:f,blur:d,padding:m,bgDrawer:T,border:I,rounded:A,shadow:D,width:W,height:z,opacityTransition:me,labelledby:ee,describedby:le,regionBackdrop:oe,regionDrawer:U};function Me(L){t(13,v=L.position||R.position),t(14,f=L.bgBackdrop||R.bgBackdrop),t(15,d=L.blur||R.blur),t(16,m=L.padding||R.padding),t(17,T=L.bgDrawer||R.bgDrawer),t(18,I=L.border||R.border),t(19,A=L.rounded||R.rounded),t(20,D=L.shadow||R.shadow),t(21,W=L.width||R.width),t(22,z=L.height||R.height),t(2,me=L.opacityTransition||R.opacityTransition),t(23,oe=L.regionBackdrop||R.regionBackdrop),t(24,U=L.regionDrawer||R.regionDrawer),t(0,ee=L.labelledby||R.labelledby),t(1,le=L.describedby||R.describedby)}function K(){switch(v){case"top":t(6,ue={x:0,y:-window.innerWidth});break;case"bottom":t(6,ue={x:0,y:window.innerWidth});break;case"left":t(6,ue={x:-window.innerHeight,y:0});break;case"right":t(6,ue={x:window.innerHeight,y:0});break;default:console.error("Error: unknown position property value.");break}}function Z(L){L.target===_e?(fe.close(),g("backdrop",L)):g("drawer",L)}function be(L){u&&L.code==="Escape"&&fe.close()}fe.subscribe(L=>{L.open===!0&&(Me(L),K())});function ke(L){ut.call(this,i,L)}function we(L){ut.call(this,i,L)}function $e(L){ut.call(this,i,L)}function Ee(L){Ve[L?"unshift":"push"](()=>{Te=L,t(5,Te)})}function De(L){Ve[L?"unshift":"push"](()=>{_e=L,t(4,_e)})}return i.$$set=L=>{t(43,e=it(it({},e),$t(L))),"position"in L&&t(13,v=L.position),"bgBackdrop"in L&&t(14,f=L.bgBackdrop),"blur"in L&&t(15,d=L.blur),"padding"in L&&t(16,m=L.padding),"bgDrawer"in L&&t(17,T=L.bgDrawer),"border"in L&&t(18,I=L.border),"rounded"in L&&t(19,A=L.rounded),"shadow"in L&&t(20,D=L.shadow),"width"in L&&t(21,W=L.width),"height"in L&&t(22,z=L.height),"zIndex"in L&&t(25,J=L.zIndex),"regionBackdrop"in L&&t(23,oe=L.regionBackdrop),"regionDrawer"in L&&t(24,U=L.regionDrawer),"labelledby"in L&&t(0,ee=L.labelledby),"describedby"in L&&t(1,le=L.describedby),"transitions"in L&&t(3,Le=L.transitions),"opacityTransition"in L&&t(2,me=L.opacityTransition),"$$scope"in L&&t(30,k=L.$$scope)},i.$$.update=()=>{i.$$.dirty[0]&8192&&t(29,s=C[v].alignment),i.$$.dirty[0]&2105344&&t(28,r=W||C[v].width),i.$$.dirty[0]&4202496&&t(27,n=z||C[v].height),i.$$.dirty[0]&532480&&t(26,o=A||C[v].rounded),t(8,l=`${Ns} ${f} ${m} ${d} ${s} ${oe} ${J} ${e.class??""}`),i.$$.dirty[0]&488505344&&t(7,c=`${Ps} ${T} ${I} ${A} ${D} ${r} ${n} ${o} ${U}`)},e=$t(e),[ee,le,me,Le,_e,Te,ue,c,l,u,fe,Z,be,v,f,d,m,T,I,A,D,W,z,oe,U,J,o,n,r,s,k,p,ke,we,$e,Ee,De]}class Os extends de{constructor(e){super(),he(this,e,Hs,Bs,ne,{position:13,bgBackdrop:14,blur:15,padding:16,bgDrawer:17,border:18,rounded:19,shadow:20,width:21,height:22,zIndex:25,regionBackdrop:23,regionDrawer:24,labelledby:0,describedby:1,transitions:3,opacityTransition:2},null,[-1,-1])}}class Vs{constructor(e,t){a(this,"base");a(this,"source");this.source=e,this.base=t}listRoot(){return this.base.get(`/cabinet/${this.source}/`)}listFolder(e){return this.base.get(`/cabinet/${this.source}/folder/${e}`)}newFolder(e){return this.base.post(`/cabinet/${this.source}/folder`,{folder:e})}getFile(e,t){return this.base.get(`/cabinet/${this.source}/file/${e}/${t}`)}uploadFile(e,t,s){return this.base.postForm(`/cabinet/${this.source}/file/${e}/${t}`,!0,s)}deleteFile(e,t){return this.base.delete(`/cabinet/${this.source}/file/${e}/${t}`)}getFilePreview(e,t){return`${this.base.api_base_url}/cabinet/${this.source}/preview/${e}/${t}?token=${this.base.user_token}`}}class ht{constructor(e,t){a(this,"http");a(this,"ticket");a(this,"base_url");this.http=new Ze(e,{}),this.ticket=t,this.base_url=e}list(){return this.http.get(`/folder/${this.ticket}`)}getFile(e){return this.http.get(`/folder/${this.ticket}/${e}`)}getFileUrl(e){return`${this.base_url}/folder/${this.ticket}/${e}`}getFilePreviewUrl(e){return`${this.base_url}/folder/${this.ticket}/${e}/preview`}uploadFile(e,t){return this.http.post(`/folder/${this.ticket}/${e}`,t)}deleteFile(e){return this.http.delete(`/folder/${this.ticket}/${e}`)}}class js{constructor(e,t){a(this,"http");a(this,"base_url");a(this,"token");a(this,"list_users",e=>this.http.post("/data/utils/user",e));this.http=new Ze(e,{"Content-Type":"application/json",Authorization:t}),this.token=t,this.base_url=e}list_sheet_group(){return this.http.post("/data/sheet/list",{})}export(e){return this.http.post("/data/sheet/export",e)}load_sheet(e,t){return this.http.post(`/data/sheet/${e}/load`,t)}query_sheet(e,t){return this.http.post(`/data/sheet/${e}/query`,t)}ref_query_sheet(e,t){return this.http.post(`/data/sheet/${e}/ref_query`,t)}get_row_relation(e,t,s,r){return this.http.get(`/data/sheet/${e}/relation/${t}/ref/${s}/column/${r}`)}get_row_history(e,t){return this.http.get(`/data/sheet/${e}/history/${t}`)}list_sheets(){return this.http.get("/data/sheet")}get_sheet(e){return this.http.get(`/data/sheet/${e}`)}new_sheet(e){return this.http.post("/data/sheet",e)}update_sheet(e,t){return this.http.post(`/data/sheet/${e}`,t)}delete_sheet(e){return this.http.delete(`/data/sheet/${e}`)}list_columns(e){return this.http.get(`/data/sheet/${e}/column`)}get_column(e,t){return this.http.get(`/data/sheet/${e}/column/${t}`)}new_column(e,t){return this.http.post(`/data/sheet/${e}/column`,t)}update_column(e,t,s){return this.http.post(`/data/sheet/${e}/column/${t}`,s)}delete_column(e,t){return this.http.delete(`/data/sheet/${e}/column/${t}`)}new_row_cell(e,t){return this.http.post(`/data/sheet/${e}/row_cell`,t)}get_row_cell(e,t){return this.http.get(`/data/sheet/${e}/row_cell/${t}`)}update_row_cell(e,t,s){return this.http.post(`/data/sheet/${e}/row_cell/${t}`,s)}delete_row_cell(e,t){return this.http.delete(`/data/sheet/${e}/row_cell/${t}`)}search(e,t){return this.http.post(`/data/sheet/${e}/search`,t)}}class zs{constructor(e,t){a(this,"http");a(this,"api_base_url");a(this,"token");a(this,"sockd_url",()=>`${this.api_base_url}/data_ws/?token=${this.token}`);a(this,"sheet_api",()=>new js(this.api_base_url,this.token));a(this,"list_users",e=>this.http.post("/data/utils/user",e));this.http=new Ze(e,{"Content-Type":"application/json",Authorization:t}),this.token=t,this.api_base_url=e}load(){return this.http.get("/data")}new_row(e,t){return this.http.post(`/data/table/${e}/row`,t)}get_row(e,t){return this.http.get(`/data/table/${e}/row/${t}`)}update_row(e,t,s){return this.http.post(`/data/table/${e}/row/${t}`,s)}delete_row(e,t){return this.http.delete(`/data/table/${e}/row/${t}`)}load_table(e,t){return this.http.post(`/data/table/${e}/load`,t)}simple_query(e,t){return this.http.post(`/data/table/${e}/simple_query`,t)}fts_query(e,t){return this.http.post(`/data/table/${e}/fts_query`,t)}ref_load(e,t){return this.http.post(`/data/table/${e}/ref_load`,t)}ref_resolve(e,t){return this.http.post(`/data/table/${e}/ref_resolve`,t)}reverse_ref_load(e,t){return this.http.post(`/data/table/${e}/rev_ref_load`,t)}list_activity(e,t){return this.http.get(`/data/table/${e}/activity/${t}`)}comment_row(e,t,s){return this.http.post(`/data/table/${e}/activity/${t}`,s)}}class Us{constructor(e){a(this,"base");this.base=e}list(){return this.base.get("/repo/")}load(e){return this.base.get(`/repo/${e}`)}getBprint(e,t,s){return this.base.get(`/repo/${e}/${t}/${s}`)}getBprintZip(e,t,s,r){return this.base.get(`/repo/${e}/${t}/${s}/zip?version=${r||""}`)}}class Rs{constructor(e){a(this,"base");this.base=e}load(){return this.base.get("/self/load")}self(){return this.base.get("/self/self")}self_ws_url(){return`${this.base.api_base_url}/self/self/ws?token=${this.base.http.headers.Authorization}`}user_profile(e){return this.base.get(`/self/user/${e}`)}user_message(e,t){return this.base.post(`/self/user/${e}`,t)}self_update(e){return this.base.post("/self/self",e)}sessions(){return this.base.get("/self/session")}email_change(e){return this.base.post("/self/email/change",e)}list_message(){return this.base.get("/self/message")}modify_message(e){return this.base.post("/self/message",e)}issue_data(e){return this.base.post("/self/issue/data",e)}issue_folder(e){return this.base.post("/self/issue/folder",e)}issue_ugroup(e){return this.base.post("/self/issue/ugroup",e)}list_cabinet_sources(){return this.base.get("/self/system/cabinet")}list_data_sources(){return this.base.get("/self/system/datatable")}list_adapter_providers(){return this.base.get("/self/system/adapter")}list_executors(){return this.base.get("/self/system/executor")}list_modules(){return this.base.get("/self/system/module")}list_repo_sources(){return this.base.get("/self/system/repo")}list_sheet_templates(){return this.base.get("/self/sheet/template")}instance_sheet_template(e,t,s){return this.base.post("/self/sheet/template",{name:e,info:t,template:s})}list_devices(){return this.base.get("/self/device/")}add_device(e){return this.base.post("/self/device/",e)}get_device(e){return this.base.get(`/self/device/${e}`)}delete_device(e){return this.base.delete(`/self/device/${e}`)}}class Fs{constructor(e){a(this,"base");this.base=e}list(){return this.base.get("/admin/bprint/")}create(e){return this.base.post("/admin/bprint/",e)}create_from_zip(e){return this.base.patchForm("/admin/bprint/",!0,e)}import(e){return this.base.put("/admin/bprint/",e)}get(e){return this.base.get(`/admin/bprint/${e}`)}update(e,t){return this.base.post(`/admin/bprint/${e}`,t)}delete(e){return this.base.delete(`/admin/bprint/${e}`)}list_file(e){return this.base.get(`/admin/bprint/${e}/file`)}get_file(e,t){return this.base.get(`/admin/bprint/${e}/file/${t}`)}add_file(e,t,s){return this.base.postForm(`/admin/bprint/${e}/file/${t}`,!0,s)}update_file(e,t,s){return this.base.patchForm(`/admin/bprint/${e}/file/${t}`,!0,s)}delete_file(e,t){return this.base.delete(`/admin/bprint/${e}/file/${t}`)}instance(e,t){return this.base.post(`/admin/bprint/${e}/instance`,t)}issue(e,t){return this.base.post(`/admin/bprint/${e}/issue`,t)}issue_encoded(e,t){return this.base.post(`/admin/bprint/${e}/issue/encoded`,t)}list_plugs(e){return this.base.get(`/admin/bprint/${e}/plug`)}}class qs{constructor(e){a(this,"base");this.base=e}bprint(e){this.base.get(`check/bprint/${e}`)}plug(e){this.base.get(`check/plug/${e}`)}dataGroup(e){this.base.get(`check/dgroup/${e}`)}}class Gs{constructor(e){a(this,"base");a(this,"seed_table",(e,t,s,r)=>this.base.get(`/admin/data/${e}/group/${t}/table/${s}/seed?max=${r}`));a(this,"query",(e,t,s)=>this.base.post(`/admin/data/${e}/group/${t}/query`,s));a(this,"list_table_activity",(e,t,s,r)=>this.base.get(`/admin/data/${e}/group/${t}/table/${s}/activity?offset=${r}`));a(this,"list_sheet",(e,t)=>this.base.get(`/admin/data/${e}/group/${t}/sheet`));this.base=e}list_group(e){return this.base.get(`/admin/data/${e}/group`)}new_group(e,t){return this.base.post(`/admin/data/${e}/group`,t)}get_group(e,t){return this.base.get(`/admin/data/${e}/group/${t}`)}edit_group(e,t,s){return this.base.patch(`/admin/data/${e}/group/${t}`,s)}delete_group(e,t){return this.base.delete(`/admin/data/${e}/group/${t}`)}list_tables(e,t){return this.base.get(`/admin/data/${e}/group/${t}/table`)}get_table(e,t,s){return this.base.get(`/admin/data/${e}/group/${t}/table/${s}`)}edit_table(e,t,s,r){return this.base.patch(`/admin/data/${e}/group/${t}/table/${s}`,r)}delete_table(e,t,s){return this.base.delete(`/admin/data/${e}/group/${t}/table/${s}`)}list_column(e,t,s){return this.base.get(`/admin/data/${e}/group/${t}/table/${s}/column`)}get_column(e,t,s,r){return this.base.get(`/admin/data/${e}/group/${t}/table/${s}/column/${r}`)}edit_column(e,t,s,r,n){return this.base.patch(`/admin/data/${e}/group/${t}/table/${s}/column/${r}`,n)}delete_column(e,t,s,r){return this.base.delete(`/admin/data/${e}/group/${t}/table/${s}/column/${r}`)}list_view(e,t,s){return this.base.get(`/admin/data/${e}/group/${t}/table/${s}/view`)}add_view(e,t,s,r){return this.base.post(`/admin/data/${e}/group/${t}/table/${s}/view`,r)}get_view(e,t,s,r){return this.base.get(`/admin/data/${e}/group/${t}/table/${s}/view/${r}`)}edit_view(e,t,s,r,n){return this.base.post(`/admin/data/${e}/group/${t}/table/${s}/view/${r}`,n)}delete_view(e,t,s,r){return this.base.delete(`/admin/data/${e}/group/${t}/table/${s}/view/${r}`)}}class Ws{constructor(e){a(this,"base");this.base=e}list_plug(){return this.base.get("/admin/plug/")}new_plug(e){return this.base.post("/admin/plug/",e)}get_plug(e){return this.base.get(`/admin/plug/${e}`)}update_plug(e,t){return this.base.post(`/admin/plug/${e}`,t)}delete_plug(e){return this.base.delete(`/admin/plug/${e}`)}flowmap(e){return this.base.get(`/admin/plug/${e}/flowmap`)}list_agent(e){return this.base.get(`/admin/plug/${e}/agent`)}new_agent(e,t){return this.base.post(`/admin/plug/${e}/agent`,t)}get_agent(e,t){return this.base.get(`/admin/plug/${e}/agent/${t}`)}update_agent(e,t,s){return this.base.post(`/admin/plug/${e}/agent/${t}`,s)}delete_agent(e,t){return this.base.delete(`/admin/plug/${e}/agent/${t}`)}list_agent_link(e,t){return this.base.get(`/admin/plug/${e}/agent/${t}/link`)}new_agent_link(e,t,s){return this.base.post(`/admin/plug/${e}/agent/${t}/link`,s)}update_agent_link(e,t,s,r){return this.base.post(`/admin/plug/${e}/agent/${t}/link/${s}`,r)}get_agent_link(e,t,s){return this.base.get(`/admin/plug/${e}/agent/${t}/link/${s}`)}delete_agent_link(e,t,s){return this.base.delete(`/admin/plug/${e}/agent/${t}/link/${s}`)}list_agent_ext(e,t){return this.base.get(`/admin/plug/${e}/agent/${t}/extension`)}new_agent_ext(e,t,s){return this.base.post(`/admin/plug/${e}/agent/${t}/extension`,s)}update_agent_ext(e,t,s,r){return this.base.post(`/admin/plug/${e}/agent/${t}/extension/${s}`,r)}get_agent_ext(e,t,s){return this.base.get(`/admin/plug/${e}/agent/${t}/extension/${s}`)}delete_agent_ext(e,t,s){return this.base.delete(`/admin/plug/${e}/agent/${t}/extension/${s}`)}list_agent_resource(e,t){return this.base.get(`/admin/plug/${e}/agent/${t}/resource`)}new_agent_resource(e,t,s){return this.base.post(`/admin/plug/${e}/agent/${t}/resource`,s)}update_agent_resource(e,t,s,r){return this.base.post(`/admin/plug/${e}/agent/${t}/resource/${s}`,r)}get_agent_resource(e,t,s){return this.base.get(`/admin/plug/${e}/agent/${t}/resource/${s}`)}delete_agent_resource(e,t,s){return this.base.delete(`/admin/plug/${e}/agent/${t}/resource/${s}`)}list_plug_state(e,t){const s=new URLSearchParams;return s.set("page",String(t.page||0)),s.set("key_cursor",t.key_cursor||""),this.base.get(`/admin/plug/${e}/state/?${s.toString()}`)}new_plug_state(e,t){return this.base.post(`/admin/plug/${e}/state/`,t)}export_plug_state(e){return this.base.get(`/admin/plug/${e}/state_export`)}import_plug_state(e,t,s){return this.base.raw_fetch(`/admin/plug/${e}/state_import?clear=${t}`,"POST",!0,!0,s)}get_plug_state(e,t){return this.base.get(`/admin/plug/${e}/state/${t}`)}update_plug_state(e,t,s){return this.base.post(`/admin/plug/${e}/state/${t}`,s)}delete_plug_state(e,t){return this.base.delete(`/admin/plug/${e}/state/${t}`)}}class Js{constructor(e){a(this,"base");this.base=e}list(){return this.base.get("/admin/repo/")}new(e){return this.base.post("/admin/repo/",e)}get(e){return this.base.get(`/admin/repo/${e}`)}update(e,t){return this.base.post(`/admin/repo/${e}`,t)}delete(e){return this.base.delete(`/admin/repo/${e}`)}}class Ks{constructor(e){a(this,"base");this.base=e}list(){return this.base.get("/admin/resource/")}new(e){return this.base.post("/admin/resource/",e)}get(e){return this.base.get(`/admin/resource/${e}`)}update(e,t){return this.base.post(`/admin/resource/${e}`,t)}delete(e){return this.base.delete(`/admin/resource/${e}`)}}class Zs{constructor(e){a(this,"base");this.base=e}edit(e){return this.base.post("/admin/tenant/",e)}get(){return this.base.get("/admin/tenant/")}get_domains(){return this.base.get("/admin/tenant/domain")}new_domain(e){return this.base.post("/admin/tenant/domain",e)}get_domain(e){return this.base.get(`/admin/tenant/domain/${e}`)}edit_domain(e,t){return this.base.post(`/admin/tenant/domain/${e}`,t)}delete_domain(e){return this.base.delete(`/admin/tenant/domain/${e}`)}domain_issue_adapter_editor(e){return this.base.get(`/admin/tenant/domain/${e}/issue/adapter_editor`)}domain_adapter_reset(e){return this.base.get(`/admin/tenant/domain/${e}/reset`)}list_system_kv({last:e,etype:t,prefix:s}){const r=new URLSearchParams;return r.set("last",e||""),r.set("etype",t||""),r.set("prefix",s||""),this.base.get(`/admin/tenant/system/kv?${r.toString()}`)}list_system_event({last:e,etype:t}){const s=new URLSearchParams;return s.set("last",e||""),s.set("etype",t||""),this.base.get(`/admin/tenant/system/event?${s.toString()}`)}}class Qs{constructor(e){a(this,"base");this.base=e}list(){return this.base.get("/admin/ugroup/")}new(e){return this.base.post("/admin/ugroup/",e)}get(e){return this.base.get(`/admin/ugroup/${e}`)}update(e,t){return this.base.post(`/admin/ugroup/${e}`,t)}delete(e){return this.base.delete(`/admin/ugroup/${e}`)}listData(e){return this.base.get(`/admin/ugroup/${e}/data`)}newData(e,t){return this.base.post(`/admin/ugroup/${e}/data`,t)}getData(e,t){return this.base.get(`/admin/ugroup/${e}/data/${t}`)}updateData(e,t,s){return this.base.post(`/admin/ugroup/${e}/data/${t}`,s)}deleteData(e,t){return this.base.delete(`/admin/ugroup/${e}/data/${t}`)}listAuth(e){return this.base.get(`/admin/ugroup/${e}/auth`)}newAuth(e,t){return this.base.post(`/admin/ugroup/${e}/auth`,t)}getAuth(e,t){return this.base.get(`/admin/ugroup/${e}/auth/${t}`)}updateAuth(e,t,s){return this.base.post(`/admin/ugroup/${e}/auth/${t}`,s)}deleteAuth(e,t){return this.base.delete(`/admin/ugroup/${e}/auth/${t}`)}}class Xs{constructor(e){a(this,"base");this.base=e}list(){return this.base.get("/admin/user_tkt/")}get(e){return this.base.get(`/admin/user_tkt/${e}`)}new(e){return this.base.post("/admin/user_tkt/",e)}update(e,t){return this.base.post(`/admin/user_tkt/${e}`,t)}delete(e){return this.base.delete(`/admin/user_tkt/${e}`)}}class Ys{constructor(e){a(this,"base");this.base=e}list(){return this.base.get("/admin/user/")}get(e){return this.base.get(`/admin/user/${e}`)}new(e){return this.base.post("/admin/user/",e)}update(e,t){return this.base.post(`/admin/user/${e}`,t)}delete(e){return this.base.delete(`/admin/user/${e}`)}}class er{constructor(e){a(this,"base");this.base=e}query(e){return this.base.post("/admin/lens/query",e)}}class Dt{constructor(e,t,s){a(this,"http");a(this,"api_base_url");a(this,"tenant_id");a(this,"user_token");this.api_base_url=e,this.tenant_id=t,this.user_token=s,console.log("@api_base =>",this),this.http=new Ze(e,{"Content-Type":"application/json",Authorization:s})}async raw_fetch(e,t,s,r,n){return this.http.rawFetch(e,t,s,r,n)}async get(e){return this.http.get(e)}async post(e,t){return this.http.post(e,t)}async postForm(e,t,s){return this.http.postForm(e,t,s)}async patchForm(e,t,s){return this.http.patchForm(e,t,s)}async put(e,t){return this.http.put(e,t)}async patch(e,t){return this.http.patch(e,t)}async delete(e,t){return this.http.delete(e,t)}}class tr{constructor(e){a(this,"base");this.base=e}listApp(){return this.base.get("/admin/target/app")}listAppByType(e,t=""){return this.base.get(`/admin/target/app/${e}?target=${t}`)}newApp(e,t){return this.base.post(`/admin/target/app/${e}`,t)}getApp(e,t){return this.base.get(`/admin/target/app/${e}/${t}`)}updateApp(e,t,s){return this.base.post(`/admin/target/app/${e}/${t}`,s)}deleteApp(e,t){return this.base.delete(`/admin/target/app/${e}/${t}`)}listHook(){return this.base.get("/admin/target/hook")}listHookByType(e,t=""){return this.base.get(`/admin/target/hook/${e}?target=${t}`)}newHook(e,t){return this.base.post(`/admin/target/hook/${e}`,t)}getHook(e,t){return this.base.get(`/admin/target/hook/${e}/${t}`)}updateHook(e,t,s){return this.base.post(`/admin/target/hook/${e}/${t}`,s)}deleteHook(e,t){return this.base.delete(`/admin/target/hook/${e}/${t}`)}}class sr{constructor(e,t){a(this,"http");a(this,"token");a(this,"base_url");this.http=new Ze(e,{Authorization:t}),this.token=t,this.base_url=e}bprint_list_file(){return this.http.get("/dev/bprint/file")}bprint_push_file(e){return this.http.postForm("/dev/bprint/file",!0,e)}bprint_get_file(e){return this.http.get(`/dev/bprint/file/${e}`)}bprint_del_file(e){return this.http.delete(`/dev/bprint/file/${e}`)}exec_watch_agents_url(e,t){return`${this.base_url}/dev/exec/watch/plug/${e}/agent/${t}`}exec_reset_plug(e,t,s){return this.http.post(`/dev/exec/reset/plug/${e}/agent/${t}`,s)}exec_run_agent_action(e,t,s,r){return this.http.post(`/dev/exec/run/plug/${e}/agent/${t}/${s}`,r)}}class rr{constructor(e){a(this,"base");this.base=e}launch_target(e){return this.base.post("/engine/launch/target",e)}launch_agent(e){return this.base.post("/engine/launch/agent",e)}launch_editor(e){return this.base.post("/engine/launch/editor",e)}reset(e,t){return this.base.post("/engine/reset",{plug_id:e,agent_id:t})}}class ir{constructor(e,t,s){a(this,"base_url");a(this,"api_base_url");a(this,"tenant_id");a(this,"user_token");a(this,"session_token");a(this,"base");a(this,"self_api");a(this,"self_data");a(this,"get_repo_api",()=>new Us(this.base));a(this,"get_engine_api",()=>new rr(this.base));a(this,"get_cabinet",e=>new Vs(e,this.base));a(this,"get_data_api",async(e,t)=>{const s={source:e,group:t};console.log("##",s);const r=await this.self_api.issue_data(s);if(!r.ok){console.log("@@err",r);return}return new zs(this.api_base_url,r.data.data_token)});a(this,"get_folder_api",async(e,t)=>{const s=await this.self_api.issue_folder({source:e,folder:t});if(!s.ok){console.log("@@err",s);return}return new ht(this.api_base_url,s.data.folder_token)});a(this,"get_admin_bprint_api",()=>new Fs(this.base));a(this,"get_admin_plug_api",()=>new Ws(this.base));a(this,"get_admin_repo_api",()=>new Js(this.base));a(this,"get_admin_data_api",()=>new Gs(this.base));a(this,"get_admin_resource_api",()=>new Ks(this.base));a(this,"get_admin_target_api",()=>new tr(this.base));a(this,"get_admin_tenant_api",()=>new Zs(this.base));a(this,"get_admin_ugroup_api",()=>new Qs(this.base));a(this,"get_admin_user_api",()=>new Ys(this.base));a(this,"get_admin_check_api",()=>new qs(this.base));a(this,"get_admin_lens_api",()=>new er(this.base));a(this,"get_ugroup_tkt_api",async e=>{let t=this.self_data.user_mgmt_tkt_api[e];if(t)return t;const s=await this.self_api.issue_ugroup({ugroup:e});if(!s.ok){console.log("ERR RESP ",s);return}return t=new Xs(new Dt(this.api_base_url,this.tenant_id,s.data.ugroup_token)),this.self_data.user_mgmt_tkt_api[e]=t,t});a(this,"get_dev_plug_tkt_api",e=>new sr(this.api_base_url,e));this.base_url=e,this.api_base_url=`${e}/z/api/${t}/v2`,this.tenant_id=t,this.user_token=s}async init(){const e=await fetch(`${rs()}/z/auth/refresh`,{body:JSON.stringify({user_token:this.user_token,options:{},old_token:this.session_token}),method:"POST"});if(!e.ok)return await e.text();const t=await e.json();if(!t.status_ok)return"Status error";this.session_token=t.token,this.base=new Dt(this.api_base_url,this.tenant_id,this.session_token),this.self_api=new Rs(this.base);const s=await this.self_api.load();if(!s.ok)return s.data;this.self_data=new ar(this,s.data)}get_self_api(){return this.self_api}}class ar{constructor(e,t){a(this,"data_sources");a(this,"repo_sources");a(this,"user_apps");a(this,"user_mgmt_tkt_api");a(this,"api_manager");this.api_manager=e,this.user_apps=t.apps||[],this.user_mgmt_tkt_api={}}async get_repo_sources(){if(this.repo_sources)return this.repo_sources;const e=await this.api_manager.self_api.list_repo_sources();return e.ok?(this.repo_sources=e.data,this.repo_sources):[]}async get_data_sources(){if(this.data_sources)return this.data_sources;const e=await this.api_manager.self_api.list_data_sources();return e.ok?(this.data_sources=e.data,this.data_sources):[]}get_user_apps(){return this.user_apps?this.user_apps:[]}}class nr{constructor(){a(this,"state");a(this,"bootloader");a(this,"last_startup_payload");a(this,"target_index");a(this,"handle_channel",e=>t=>{console.log("@instance",e,t)});this.state=Be({display:"HIDDEN",instances:[]}),this.target_index={},this.state.subscribe(e=>{this.target_index={},e.instances.forEach(t=>{this.target_index[t.target_id]=t.id})}),this.state.subscribe(e=>console.log("@launcher_state",e))}plane_hide(){this.state.update(e=>({...e,display:"HIDDEN"}))}plane_not_float(){ye(this.state).display==="FLOATING"&&this.state.update(e=>({...e,display:"HIDDEN"}))}plane_float(){this.state.update(e=>({...e,display:"FLOATING"}))}plane_show(){this.state.update(e=>({...e,display:"SHOW"}))}instance_by_target(e){const s=ye(this.state).instances.filter(o=>o.target_id===e.target_id);if(s.length>0)return this.instance_change(s[0].id),"";const r=Re();this.last_startup_payload=e.startup_payload;const n=new MessageChannel;return n.port1.onmessage=this.handle_channel(r),this.state.update(o=>({...o,active_instance:r,instances:[...o.instances,{id:r,invoker_name:e.invoker_name||"",name:e.target_name||"",target_type:e.target_type||"",target_id:e.target_id,invoker:e.invoker,channel:n}]})),r}instance_change(e){this.state.update(t=>({...t,active_instance:e}))}instance_close(e){this.state.update(t=>{const s=t.instances.filter(n=>n.id!==e);let r=t.display;return s.length===0&&r=="FLOATING"&&(r="HIDDEN"),{...t,display:r,active_instance:s.length>0?s[0].id:void 0,instances:s}})}}class or{constructor(){a(this,"options");a(this,"set",(e,t)=>{this.options=t,vs(`/z/pages/portal/${e}`)});a(this,"start",()=>{this.set("")});a(this,"data_page",e=>{this.set(`data?dsource=${e}`)});a(this,"data_group_page",(e,t)=>{this.set(`data/table?dsource=${e}&dgroup=${t}`)});a(this,"data_table_render_page",(e,t,s,r="")=>{r==="vcard"?this.set(`data/table/render?dsource=${e}&dgroup=${t}&dtable=${s}`):this.set(`data/table/render?dsource=${e}&dgroup=${t}&dtable=${s}`)});a(this,"cab_loader",()=>{this.set("cabinet/listings/")});a(this,"cab_uploader",(e,t)=>{this.set(`cabinet/upload?source=${e}&folder=${t}`)});a(this,"cab_folders",e=>{this.set(`cabinet/listings?source=${e}`)});a(this,"cab_folder",(e,t)=>{this.set(`cabinet/listings/folder?source=${e}&folder=${t}`)});a(this,"cab_file",(e,t,s)=>{this.set(`cabinet/listings/file?source=${e}&folder=${t}&file=${s}`)});a(this,"cab_text_file",(e,t,s)=>{this.set(`cabinet/listings/file/text?source=${e}&folder=${t}&file=${s}`)});a(this,"cab_image_file",(e,t,s)=>{this.set(`cabinet/listings/file/image?source=${e}&folder=${t}&file=${s}`)});a(this,"repo_loader",()=>{this.set("repo")});a(this,"repo_source",e=>{this.set(`repo/source?source=${e}`)});a(this,"repo_item",(e,t,s)=>{const r=new URLSearchParams({source:e,group:t,item:s});this.set(`repo/item?${r.toString()}`)});a(this,"self_profile",()=>{this.set("profile/self")});a(this,"user_profile",e=>{this.set(`profile/user?id=${e}`)});a(this,"self_devices",()=>{this.set("profile/device")});a(this,"self_device_new",()=>{this.set("profile/device/new")});a(this,"admin_bprints",()=>{this.set("admin/bprint")});a(this,"admin_bprint",e=>{this.set(`admin/bprint/edit?bid=${e}`)});a(this,"admin_bprint_export_zip",e=>{this.set(`admin/bprint/zipit?bid=${e}`)});a(this,"admin_bprint_new",()=>{this.set("admin/bprint/new")});a(this,"admin_bprint_new_zip",()=>{this.set("admin/bprint/zip")});a(this,"admin_bprint_instancer",(e,t)=>{this.set(`admin/bprint/instancer?bid=${e}`,t)});a(this,"admin_plugs",()=>{this.set("admin/plug/")});a(this,"admin_plug_new",()=>{this.set("admin/plug/new")});a(this,"admin_plug_edit",e=>{this.set(`admin/plug/edit?pid=${e}`)});a(this,"admin_plug_states",e=>{this.set(`admin/plug/states?pid=${e}`)});a(this,"admin_plug_state_new",e=>{this.set(`admin/plug/states/new?pid=${e}`)});a(this,"admin_plug_state_edit",(e,t)=>{this.set(`admin/plug/states/edit?pid=${e}&skey=${t}`)});a(this,"admin_agents",e=>{this.set(`admin/plug/agent?pid=${e}`)});a(this,"admin_agent_new",e=>{this.set(`admin/plug/agent/new?pid=${e}`)});a(this,"admin_agent_edit",(e,t)=>{this.set(`admin/plug/agent/edit?pid=${e}&aid=${t}`)});a(this,"admin_plug_dev_execute",(e,t)=>{this.set(`admin/plug/agent/execute?pid=${e}&aid=${t}`)});a(this,"admin_agent_links",(e,t)=>{this.set(`admin/plug/agent/link?pid=${e}&aid=${t}`)});a(this,"admin_agent_link_new",(e,t,s)=>{this.set(`admin/plug/agent/link/new?pid=${e}&aid=${t}`,s)});a(this,"admin_agent_link_edit",(e,t,s)=>{this.set(`admin/plug/agent/link/edit?pid=${e}&aid=${t}&lid=${s}`)});a(this,"admin_agent_ext",(e,t)=>{this.set(`admin/plug/agent/ext?pid=${e}&aid=${t}`)});a(this,"admin_agent_ext_new",(e,t)=>{this.set(`admin/plug/agent/ext/new?pid=${e}&aid=${t}`)});a(this,"admin_agent_ext_edit",(e,t,s)=>{this.set(`admin/plug/agent/ext/edit?pid=${e}&aid=${t}&eid=${s}`)});a(this,"admin_agent_res",(e,t)=>{this.set(`admin/plug/agent/res?pid=${e}&aid=${t}`)});a(this,"admin_agent_res_new",(e,t,s)=>{this.set(`admin/plug/agent/res/new?pid=${e}&aid=${t}`,s)});a(this,"admin_agent_res_edit",(e,t,s)=>{this.set(`admin/plug/agent/res/edit?pid=${e}&aid=${t}&rid=${s}`)});a(this,"admin_plug_dev_flowmap",e=>{this.set(`#/admin/plug/dev/flowmap?pid=${e}`)});a(this,"admin_plug_dev_live_shell",(e,t)=>{this.set(`#/admin/plug/${e}/dev/liveshell/${t}`)});a(this,"admin_plug_dev_ipc_shell",(e,t)=>{this.set(`#/admin/plug/${e}/dev/ipcshell/${t}`)});a(this,"admin_plug_dev_docs",(e,t)=>{this.set(`#/admin/plug/${e}/dev/docs/${t}`)});a(this,"admin_plug_dev_logs",(e,t)=>{this.set(`#/admin/plug/${e}/dev/logs/${t}`)});a(this,"admin_repos",()=>{this.set("admin/repo/")});a(this,"admin_repo_edit",e=>{this.set(`admin/repo/edit/${e}`)});a(this,"admin_repo_new",()=>{this.set("admin/repo/new")});a(this,"admin_data_loader",()=>{this.set("admin/data/")});a(this,"admin_data_groups",e=>{this.set(`admin/data/dgroup?source=${e}`)});a(this,"admin_data_group",(e,t)=>{this.set(`admin/data/dgroup/edit?source=${e}&group=${t}`)});a(this,"admin_data_tables",(e,t)=>{this.set(`admin/data/dtable?source=${e}&group=${t}`)});a(this,"admin_data_table",(e,t,s)=>{this.set(`admin/data/dtable/edit?source=${e}&group=${t}&table=${s}`)});a(this,"admin_data_columns",(e,t,s)=>{this.set(`admin/data/dcolumn?source=${e}&group=${t}&table=${s}`)});a(this,"admin_data_column",(e,t,s,r)=>{this.set(`admin/data/dcolumn/edit?source=${e}&group=${t}&table=${s}&column=${r}`)});a(this,"admin_data_hooks",(e,t,s)=>{this.set(`#/admin/data/${e}/hook/${t}/${s}`)});a(this,"admin_data_hook",(e,t,s)=>{this.set(`#/admin/data/${e}/hook/${t}/${s}/new`)});a(this,"admin_data_apps",(e,t,s)=>{this.set(`#/admin/data/${e}/app/${t}/${s}`)});a(this,"admin_data_app",(e,t,s)=>{this.set(`#/admin/data/${e}/app/${t}/${s}/new`)});a(this,"admin_data_views",(e,t,s)=>{this.set(`#/admin/data/${e}/view/${t}/${s}`)});a(this,"admin_data_view_new",(e,t,s)=>{this.set(`#/admin/data/${e}/view/${t}/${s}/new`)});a(this,"admin_data_view_edit",(e,t,s,r)=>{this.set(`#/admin/data/${e}/view/${t}/${s}/${r}/edit`)});a(this,"admin_resources",()=>{this.set("admin/resource/")});a(this,"admin_resource_edit",e=>{this.set(`admin/resource/edit/${e}`)});a(this,"admin_resource_new",e=>{this.set("admin/resource/new",e)});a(this,"admin_target_apps",()=>{this.set("admin/target/app")});a(this,"admin_target_app_edit",(e,t)=>{this.set(`admin/target/app/edit?ttype=${e}&id=${t}`)});a(this,"admin_target_app_new",e=>{this.set("admin/target/app/new",e)});a(this,"admin_target_hooks",()=>{this.set("admin/target/hook/")});a(this,"admin_target_hook_edit",(e,t)=>{this.set(`admin/target/hook/edit?ttype=${e}&id=${t}`)});a(this,"admin_target_hook_new",()=>{this.set("admin/target/hook/new")});this.options=null}launch_target(e,t){const s=t||{},r=s.name?window.btoa(s.name):"";this.set(`launch?target=${e}&name=${r}`,t)}launcher(){this.set("launch/")}notifications(){this.set("notification/")}data_sheets_page(e,t){this.set(`data/sheet/loader?dsource=${e}&dgroup=${t}`)}data_sheet_render_page(e,t,s,r){const n=s?`&sheetid=${s}`:"";this.set(`data/sheet?dsource=${e}&dgroup=${t}${n}`,r)}data_sheets_new(){this.set("data/sheet/new")}admin_data_activity(e,t,s){this.set(`#/admin/data/${e}/activity/${t}/${s}`)}admin_data_seed(e,t,s){this.set(`#/admin/data/${e}/seed/${t}/${s}`)}admin_data_query(e,t){this.set(`#/admin/data/${e}/query/${t}`)}admin_users(){this.set("#/admin/user/")}admin_user_edit(e){this.set(`#/admin/user/edit/${e}`)}admin_user_new(){this.set("#/admin/user/new")}admin_ugroups(){this.set("admin/ugroup/")}admin_ugroup_new(){this.set("admin/ugroup/new")}admin_ugroup_edit(e){this.set(`admin/ugroup/edit/${e}`)}admin_ugroup_users(e){this.set(`admin/ugroup/subusers/${e}`)}admin_ugroup_user_edit(e,t){this.set(`#/admin/ugroup/${e}/user/${t}/edit`)}admin_ugroup_user_new(e,t){this.set(`#/admin/ugroup/${e}/user/new`,t)}admin_ugroup_auths(e){this.set(`#/admin/ugroup/${e}/auth`)}admin_ugroup_auth_new(e){this.set(`#/admin/ugroup/${e}/auth/new`)}admin_ugroup_auth_edit(e,t){this.set(`#/admin/ugroup/${e}/auth/edit/${t}`)}admin_ugroup_apps(e){this.set(`#/admin/ugroup/${e}/app`)}admin_ugroup_app_new(e){this.set(`#/admin/ugroup/${e}/app/new`)}admin_ugroup_app_edit(e,t){this.set(`#/admin/ugroup/${e}/app/edit/${t}`)}admin_ugroup_datas(e){this.set(`#/admin/ugroup/${e}/data`)}admin_ugroup_data_new(e){this.set(`#/admin/ugroup/${e}/data/new`)}admin_ugroup_data_edit(e,t){this.set(`#/admin/ugroup/${e}/data/edit/${t}`)}admin_tenant(){this.set("#/admin/tenant/")}admin_tenant_edit(){this.set("#/admin/tenant/edit")}admin_tenant_domain_edit(e){this.set(`#/admin/tenant/domain/${e}/edit`)}admin_tenant_domain_new(){this.set("#/admin/tenant/domain/new")}admin_tenant_domain_adapter_editor(e){this.set(`#/admin/tenant/domain/${e}/adapter_editor`)}admin_tenant_system_kvs(){this.set("admin/tenant/system/kv")}admin_tenant_system_events(){this.set("admin/tenant/system/event")}admin_lens_logs(e){this.set("admin/lens/logs",e)}admin_lens_watcher(e){this.set("admin/lens/watcher",e)}}class lr{constructor(e){a(this,"self_api");a(this,"state");a(this,"is_pending_read");a(this,"sockd");a(this,"toast_open");a(this,"handle_sockd",e=>{switch(e.payload.type){case"new":const t=e.payload.data;this.toast_open&&this.toast_open(t.title+" "+t.contents),this.state.update(s=>({...s,messages:[...s.messages,t]}));break;default:console.log("@message =>",e);break}});a(this,"set_sockd",e=>{this.sockd=e});this.self_api=e,this.state=Be({messages:[],cursor:0,loading:!1}),this.toast_open=null,this.is_pending_read=ws([this.state],([t])=>{let s=!1;return t.messages.forEach(r=>{if(!r.read){s=!0;return}}),s})}async init(){this.state.update(t=>({...t,loading:!0}));const e=await this.self_api.list_message();if(e.status!==200){console.warn("Error happend",e);return}this.state.update(t=>({...t,cursor:0,loading:!1,messages:e.data}))}async read_message(e){return await this.self_api.modify_message({ops:"read",ids:[e]}),this.init()}async delete_message(e){return await this.self_api.modify_message({ops:"delete",ids:[e]}),this.init()}}const os="server_publish",ur="client_direct",cr="client_broadcast",dr="client_publish",hr="client_system",_r="server_system";class fr{constructor(e,t,s){a(this,"initial");a(this,"increment");a(this,"maximum");a(this,"current");this.initial=e,this.increment=t,this.maximum=s,this.current=this.initial}next(){const e=this.current,t=this.current+this.increment;return this.maximum===void 0?this.current=t:t<=this.maximum&&(this.current=t),e}reset(){this.current=this.initial}}class pr{constructor(e){a(this,"buffer");a(this,"writePtr",0);a(this,"wrapped",!1);this.buffer=Array(e)}len(){return this.wrapped?this.buffer.length:this.writePtr}cap(){return this.buffer.length}read(e){if(e==null||e.length===0||this.buffer.length===0||this.writePtr===0&&!this.wrapped)return 0;const t=this.wrapped?this.writePtr:0,s=t-1<0?this.buffer.length-1:t-1;for(let r=0;r<e.length;r++){let n=(t+r)%this.buffer.length;if(e[r]=this.buffer[n],n===s)return r+1}return e.length}write(e){if(e==null||e.length===0||this.buffer.length===0)return 0;const t=e.length>this.buffer.length?e.length-this.buffer.length:0;for(let s=0;s<e.length-t;s++)this.buffer[this.writePtr]=e[t+s],this.writePtr=(this.writePtr+1)%this.buffer.length,this.writePtr===0&&(this.wrapped=!0);return e.length}forEach(e){if(this.writePtr===0&&!this.wrapped)return 0;let t=this.wrapped?this.writePtr:0;const s=this.wrapped?t-1<0?this.buffer.length-1:t-1:this.writePtr-1,r=this.len();for(;e(this.buffer[t]),t!==s;)t=(t+1)%this.buffer.length;return r}clear(){this.writePtr=0,this.wrapped=!1}}var Oe=(i=>(i.open="open",i.close="close",i.error="error",i.message="message",i.retry="retry",i))(Oe||{});class gr{constructor(e,t,s,r){a(this,"url");a(this,"protocols");a(this,"buffer");a(this,"backoff");a(this,"eventListeners",{open:[],close:[],error:[],message:[],retry:[]});a(this,"closedByUser",!1);a(this,"websocket");a(this,"retries",0);a(this,"handleOpenEvent",e=>this.handleEvent("open",e));a(this,"handleCloseEvent",e=>this.handleEvent("close",e));a(this,"handleErrorEvent",e=>this.handleEvent("error",e));a(this,"handleMessageEvent",e=>this.handleEvent("message",e));this.url=e,this.protocols=t,this.buffer=s,this.backoff=r,this.tryConnect()}getUnderlyingWebsocket(){return this.websocket}send(e){var t;this.closedByUser||(this.websocket===void 0||this.websocket.readyState!==this.websocket.OPEN?(t=this.buffer)==null||t.write([e]):this.websocket.send(e))}close(e,t){var s;this.closedByUser=!0,(s=this.websocket)==null||s.close(e,t)}addEventListener(e,t,s){const r={listener:t,options:s};this.eventListeners[e].push(r)}removeEventListener(e,t,s){this.eventListeners[e]=this.eventListeners[e].filter(r=>r.listener!==t&&(r.options===void 0||r.options!==s))}dispatchEvent(e,t){const s=this.eventListeners[e],r=[];s.forEach(n=>{n.listener(this,t),n.options!==void 0&&n.options.once&&r.push(n)}),r.forEach(n=>this.removeEventListener(e,n.listener,n.options))}tryConnect(){this.websocket!==void 0&&(this.websocket.removeEventListener("open",this.handleOpenEvent),this.websocket.removeEventListener("close",this.handleCloseEvent),this.websocket.removeEventListener("error",this.handleErrorEvent),this.websocket.removeEventListener("message",this.handleMessageEvent),this.websocket.close()),this.websocket=new WebSocket(this.url,this.protocols),this.websocket.addEventListener("open",this.handleOpenEvent),this.websocket.addEventListener("close",this.handleCloseEvent),this.websocket.addEventListener("error",this.handleErrorEvent),this.websocket.addEventListener("message",this.handleMessageEvent)}handleEvent(e,t){var s,r,n;switch(e){case"close":this.closedByUser||this.reconnect();break;case"open":this.retries=0,(s=this.backoff)==null||s.reset(),(r=this.buffer)==null||r.forEach(this.send.bind(this)),(n=this.buffer)==null||n.clear();break}this.dispatchEvent(e,t)}reconnect(){if(this.backoff===void 0)return;const e=this.backoff.next();setTimeout(()=>{this.dispatchEvent("retry",new CustomEvent("retry",{detail:{retries:++this.retries,backoff:e}})),this.tryConnect()},e)}}class mr{constructor(e){a(this,"url");a(this,"ws",null);a(this,"protocols");a(this,"backoff");a(this,"buffer");a(this,"onOpenListeners",[]);a(this,"onCloseListeners",[]);a(this,"onErrorListeners",[]);a(this,"onMessageListeners",[]);a(this,"onRetryListeners",[]);this.url=e.replace("http://","ws://").replace("https://","wss://")}withProtocols(e){return this.protocols=e,this}withBackoff(e){return this.backoff=e,this}withBuffer(e){return this.buffer=e,this}onOpen(e,t){return this.onOpenListeners.push({listener:e,options:t}),this}onClose(e,t){return this.onCloseListeners.push({listener:e,options:t}),this}onError(e,t){return this.onErrorListeners.push({listener:e,options:t}),this}onMessage(e,t){return this.onMessageListeners.push({listener:e,options:t}),this}onRetry(e,t){return this.onRetryListeners.push({listener:e,options:t}),this}build(){return this.ws!==null?this.ws:(this.ws=new gr(this.url,this.protocols,this.buffer,this.backoff),this.onOpenListeners.forEach(e=>{var t;return(t=this.ws)==null?void 0:t.addEventListener(Oe.open,e.listener,e.options)}),this.onCloseListeners.forEach(e=>{var t;return(t=this.ws)==null?void 0:t.addEventListener(Oe.close,e.listener,e.options)}),this.onErrorListeners.forEach(e=>{var t;return(t=this.ws)==null?void 0:t.addEventListener(Oe.error,e.listener,e.options)}),this.onMessageListeners.forEach(e=>{var t;return(t=this.ws)==null?void 0:t.addEventListener(Oe.message,e.listener,e.options)}),this.onRetryListeners.forEach(e=>{var t;return(t=this.ws)==null?void 0:t.addEventListener(Oe.retry,e.listener,e.options)}),this.ws)}}class br{constructor(e){a(this,"_ws");a(this,"_handler");a(this,"_builder");a(this,"_room");a(this,"_sid");a(this,"SendDirect",(e,t)=>{this._ws.send(JSON.stringify({type:ur,xid:Re(),room:this._room,from_id:this._sid,targets:[t],payload:e}))});a(this,"SendBroadcast",e=>{this._ws.send(JSON.stringify({type:cr,xid:Re(),room:this._room,from_id:this._sid,payload:e}))});a(this,"SendTagged",(e,t)=>{this._ws.send(JSON.stringify({type:dr,xid:Re(),room:this._room,from_id:this._sid,payload:e,target_tags:t}))});a(this,"UpdateToken",e=>{this._ws.send(JSON.stringify({type:hr,xid:Re(),room:this._room,from_id:this._sid,payload:e}))});a(this,"Close",()=>{this._ws.close(0,"closed by client")});a(this,"handleIncoming",(e,t)=>{const s=JSON.parse(t.data);if(console.log("@incoming_message",s),s.type===_r){console.log("@handle_server_system_message");return}this._handler(s)});this._builder=new mr(e),this._builder.onMessage(this.handleIncoming),this._builder.withBackoff(new fr(0,10,100)),this._builder.withBuffer(new pr(20)),this._handler=null}async Init(){this._ws=this._builder.build()}SetHandler(e){this._handler=e}}class wr{constructor(e){a(this,"dirtyStore");a(this,"callbacks");a(this,"start_modify_row",e=>{this.callbacks.clear(),this.dirtyStore.set({rowid:e,data:{}})});a(this,"start_new_row",()=>{this.callbacks.clear(),this.dirtyStore.set({rowid:0,data:{}})});a(this,"set_value",(e,t)=>{this.dirtyStore.update(s=>({...s,data:{...s.data,[e]:t}}))});a(this,"clear_dirty_row",()=>{this.dirtyStore.set({rowid:0,data:{}})});this.dirtyStore=e,this.callbacks=new Map}register_before_save(e,t){this.callbacks.set(e,t)}on_ohange(e,t){this.set_value(e,t)}set_ref_copy(e,t){this.dirtyStore.update(s=>({...s,data:{...s.data,[e]:t}}))}before_save(){this.callbacks.forEach(e=>e())}}const ls=()=>({count:20,filter_conds:[],main_column:"",search_term:"",selects:[],page:0});class vr{constructor(e){a(this,"all_tables");a(this,"table_slug");a(this,"group_slug");a(this,"data_api");a(this,"folder_api");a(this,"state");a(this,"source");a(this,"data_widgets");a(this,"rev_ref_columns");a(this,"_open_modal");a(this,"_close_modal");a(this,"profile_generator");a(this,"row_service");a(this,"refresh",()=>this.init());a(this,"init",async e=>{this.state.set_loading();const t=await this.data_api.load_table(this.table_slug,e?{view_filters:e}:{});if(!t.ok){console.log("Err",t);return}const s=t.data.count||0;let r=0,n=[],o=[];const l=t.data.query_response||{};let c=l.final||!1,u="NONE";const _=t.data.views||[],p=t.data.active_view;t.data.active_view?_.filter(g=>g.name!==p)[0]&&(u="STATIC"):e&&(u="MANUAL"),this.rev_ref_columns=t.data.reverse_refs||[],this.data_widgets=t.data.data_widgets||[],this.state.set_ok_loading(s,n,o,c,r,u),this.state.set_rows_data(l,!1)});a(this,"on_sockd",e=>{if(e.mod_type==="comment"){console.log("@comment on row",e);return}if(console.log("@processing data event",e),e.mod_type===$s){this.state.data_store.update(t=>(e.rows.forEach(s=>{delete t.indexed_rows[s],t.rows=t.rows.filter(r=>r!==s),console.log("@deleting_record",s)}),{...t}));return}this.state._nav_store.view_mode==="NONE"?e.mod_type===ys?this.state.data_store.update(t=>{const s=e.rows.length==1?[e.data]:e.data;return e.rows.forEach((r,n)=>{const o=s[n],l=t.indexed_rows[r];if(!l)return;const c={...l,...o};t.indexed_rows[r]=c}),console.log("@applying_update",e.data),{...t,indexed_rows:{...t.indexed_rows}}}):e.mod_type===Es&&(console.log("@applying_insert"),this.state._nav_store.last_page?(console.log("@row/push"),this.state.data_store.update(t=>{const s=e.rows.length==1?[e.data]:e.data;return e.rows.forEach((r,n)=>{const o=s[n];t.indexed_rows[r]=o,console.log("@row",o,r),t.rows.push(r)}),{...t}})):this.state.set_needs_refresh()):(this.state.data_store.update(t=>(e.rows.forEach(s=>{t.marked_rows[s]=e.mod_type==="update"?"blue":"green"}),console.log("@refresh/mark"),t)),this.state.set_needs_refresh())});a(this,"fts",e=>this.data_api.fts_query(this.table_slug,e));a(this,"poll",async()=>{});a(this,"close",()=>{});a(this,"get_row_service",()=>this.row_service);a(this,"apply_view",async(e,t,s)=>{const r=await this.do_query({...ls(),...t});if(!r){console.warn("Could not fetch rows");return}this.state.nav_store.update(n=>({...n,view_mode:s?"MANUAL":"STATIC"})),this.state.set_rows_data(r,!1)});a(this,"do_query",async e=>{this.state.set_loading();const t=await this.data_api.simple_query(this.table_slug,e);if(t.status!==200){this.state.set_err_loading(t.data);return}let s=t.final||!1;const r=e.filter_conds;return this.state.set_ok_loading(e.count,r,e.selects,s,e.page),t.data});a(this,"reached_top",async()=>{console.log("TOP REACHED"),!this.skip_loading()&&console.log("FETCH MORE")});a(this,"reached_buttom",async()=>{console.log("@start_fetch_more");const e=this.state._nav_store;if(e.last_page&&this.skip_loading()){console.warn("already last page");return}const t=await this.do_query({...e.active_view,page:e.active_page+1,count:50});if(!t){console.warn("Could not fetch rows");return}this.state.set_rows_data(t,!0),console.log("@end_fetch_more")});a(this,"skip_loading",()=>{if(this.state._nav_store.loading)return!0;const e=new Date().valueOf();return e-this.state.last_loading<1e3*10?!0:(this.state.last_loading=e,!1)});this.all_tables=e.all_tables,this.table_slug=e.table_slug,this.group_slug=e.group_slug,this.data_api=e.data_api,this.folder_api=e.folder_api,this.source=e.source,this._open_modal=e.open_modal,this._close_modal=e.close_modal,this.profile_generator=e.profile_generator,this.state=new kr(this),this.row_service=new $r(this,this.state)}get_invoker(e,t){return new yr(this,e,t)}get_exec_data(e){const t=ye(this.state.data_store),s={};return e.forEach(r=>{s[r]=t.indexed_rows[r]}),{cells:s,data_group:this.group_slug,invoker_type:"data_table",rows:e,table_slug:this.table_slug,table_id:this.table_slug,columns:Object.values(t.indexed_column),source:this.source}}}class kr{constructor(e){a(this,"dirty_store");a(this,"nav_store");a(this,"data_store");a(this,"last_loading");a(this,"service");a(this,"_nav_store");a(this,"set_loading",()=>{this.nav_store.update(e=>({...e,loading:!0}))});a(this,"set_err_loading",e=>{this.nav_store.update(t=>({...t,loading:!1,loading_error:e}))});a(this,"set_ok_loading",(e,t,s,r,n,o)=>{o=o||"NONE",this.nav_store.update(l=>({...l,loading:!1,active_view:{count:e,filter_conds:t,main_column:"",search_term:"",selects:s},last_page:r,active_page:n,loading_error:"",view_mode:o}))});a(this,"set_needs_refresh",()=>{this.nav_store.update(e=>({...e,needs_refresh:!0}))});a(this,"set_row_data",e=>{this.data_store.update(t=>{const s=e.__id;let r=t.indexed_rows[s];return r?(t.indexed_rows[s]={...r,...e},{...t,indexed_rows:{...t.indexed_rows}}):t})});a(this,"set_rows_data",(e,t)=>{e.rows&&this.data_store.update(s=>{const r=e.columns,n=ks(r),o=t?s.rows||[]:[],l=t?s.indexed_rows||{}:{};let c=s.views||[];const u=e.rows,_=u.map(g=>g.__id),p=Array.from(new Set([..._,...o])).sort((g,v)=>g-v),k=u.reduce((g,v)=>(g[v.__id]=v,g),{...l});return{...s,column_order:n,indexed_column:r,indexed_rows:k,rows:p,views:c}})});a(this,"start_row_edit",(e,t)=>{this.dirty_store.set({data:t||{},rowid:e})});this.service=e,this.last_loading=0,this.dirty_store=Be({data:{},rowid:0}),this.nav_store=Be({loading:!0,lastTry:null,view_mode:"NONE",loading_error:"",active_page:0,last_page:!1,active_view:ls(),needs_refresh:!1,views:{}}),this.nav_store.subscribe(t=>this._nav_store=t),this.data_store=Be({indexed_column:{},column_order:[],reverse_ref_column:[],rows:[],indexed_rows:{},sparse_rows:[],remote_dirty:{},views:[],ref_rows_cache:{},marked_rows:{}}),this.nav_store.subscribe(t=>console.log("NAV_STORE|>",t)),this.data_store.subscribe(t=>console.log("DATA_STORE|>",t))}}class $r{constructor(e,t){a(this,"service");a(this,"state");a(this,"get_dirty_service",()=>new wr(this.state.dirty_store));a(this,"ref_load",async e=>this.service.data_api.ref_load(this.service.table_slug,e));a(this,"ref_resolve_pri",async(e,t,s,r)=>this.service.data_api.ref_resolve(this.service.table_slug,{type:e,target:t,column:s,row_ids:r}));a(this,"list_activity",async e=>this.service.data_api.list_activity(this.service.table_slug,String(e)));a(this,"rev_ref_load",async(e,t,s)=>this.service.data_api.reverse_ref_load(this.service.table_slug,{current_table:this.service.table_slug,target_table:e,column:t,current_item:s}));a(this,"comment_row",async(e,t)=>this.service.data_api.comment_row(this.service.table_slug,String(e),t));a(this,"delete_row",async e=>{let t=await this.service.data_api.delete_row(this.service.table_slug,String(e));if(t.status!==200){console.warn("could not delete row",t);return}});a(this,"save_row",async()=>{const e=this.service.data_api,t=this.service.table_slug,s=ye(this.state.dirty_store);if(s.rowid===0)return(await e.new_row(t,{cells:s.data})).data;const r=s.rowid,o=ye(this.state.data_store).indexed_rows[r].__version,l=await e.update_row(t,String(r),{cells:s.data,version:o});return l.status!==200?(console.warn("could not update row",l),l.data):(this.state.set_row_data(l.data),l.data)});a(this,"fetch_row_latest",async e=>{const t=await this.service.data_api.get_row(this.service.table_slug,String(e));t.status===200&&this.state.set_row_data(t.data)});a(this,"list_user",e=>this.service.data_api.list_users({target_type:"table",target:`${this.service.table_slug}/${e}`}));this.service=e,this.state=t}open_model(e,t){this.service._open_modal(e,t)}close_model(){this.service._close_modal()}folder_api(){return this.service.folder_api}}class yr{constructor(e,t,s){a(this,"service");a(this,"widget");a(this,"instance_id");a(this,"launcher");a(this,"init",e=>{this.instance_id=e});a(this,"handle",(e,t)=>{console.log("@instance_handle",e,t)});a(this,"close",()=>{console.log("@close")});this.service=e,this.widget=t,this.launcher=s}}class Er{constructor(e){a(this,"source");a(this,"name");a(this,"data_api");a(this,"api_base_url");a(this,"tables_services");a(this,"active_table");a(this,"tables");a(this,"close_modal");a(this,"open_modal");a(this,"folder_api");a(this,"sockd_builder");a(this,"sockd_conn");a(this,"event_timer");a(this,"profile_generator");a(this,"init",async()=>{const e=await this.data_api.load();if(!e.ok){console.log("GROUP_SERVICE_INIT_ERR",e);return}this.tables=e.data.tables||[];const t=e.data.folder_ticket||"";this.folder_api=new ht(this.api_base_url,t),this.sockd_conn=await this.sockd_builder.build(this.data_api.sockd_url(),this.__sockd_handle)});a(this,"__sockd_handle",e=>{if(e.type!==os)return;const t=e.payload,s=this.tables_services.get(t.table);s&&s.on_sockd(t)});a(this,"default_table",()=>(this.tables[0]||{}).slug||void 0);a(this,"table_service",async e=>{let t=this.tables_services.get(e);return t||(t=new vr({all_tables:this.tables,data_api:this.data_api,group_slug:this.name,table_slug:e,folder_api:this.folder_api,close_modal:this.close_modal,open_modal:this.open_modal,profile_generator:this.profile_generator,source:this.source}),await t.init(),this.tables_services.set(e,t)),this.active_table=e,t});a(this,"run",async()=>{this.event_timer=setInterval(()=>{this.tables_services.forEach(e=>{e.poll()})},1e4)});a(this,"close",async()=>{clearInterval(this.event_timer),this.tables_services.forEach(e=>{e.close()})});this.source=e.source,this.name=e.name,this.data_api=e.api,this.tables_services=new Map,this.tables=[],this.api_base_url=e.api_base_url,this.sockd_builder=e.sockd_builder,this.close_modal=e.close_modal,this.open_modal=e.open_modal,this.profile_generator=e.profile_generator}}const xr=()=>{let i=0;return{skip:()=>{const t=new Date().valueOf();return t-i<1e3*10?!0:(i=t,!1)}}};class Lr{constructor(e,t,s,r,n){a(this,"source");a(this,"group_slug");a(this,"active_sheets");a(this,"sheets");a(this,"folder_api");a(this,"data_api");a(this,"data_sheet_api");a(this,"sockd_builder");a(this,"sockd_conn");a(this,"profile_genrator");a(this,"init",async()=>{const e=await this.data_sheet_api.list_sheet_group();if(!e.ok){console.log("@err",e);return}this.sheets.set(e.data.sheets||[]);const t=e.data.folder_ticket||"";this.folder_api=new ht(this.data_api.api_base_url,t),this.sockd_conn=await this.sockd_builder.build(this.data_api.sockd_url(),this.sockd_handle)});a(this,"sockd_handle",e=>{if(e.type!==os||!e.payload.sheet_id)return;const t=e.payload;this.active_sheets.get(String(t.sheet_id)).on_sockd(t)});a(this,"get_sheet_service",async(e,t)=>{let s=this.active_sheets.get(e);if(s)return s;const r=ye(this.sheets).filter(n=>n.__id!==Number(e));return s=new Tr(this,e,r[0].name,this.profile_genrator),await s.init(t),this.active_sheets.set(e,s),s});a(this,"refetch_sheets",async()=>{const e=await this.data_sheet_api.list_sheets();e.ok&&this.sheets.set(e.data)});this.source=e,this.group_slug=t,this.active_sheets=new Map,this.sheets=Be([]),this.data_api=s,this.data_sheet_api=s.sheet_api(),this.profile_genrator=n,this.sockd_builder=r}}class Tr{constructor(e,t,s,r){a(this,"group");a(this,"sheetid");a(this,"state");a(this,"api");a(this,"force_render_index");a(this,"sheet_name");a(this,"scroll_skip");a(this,"max_row");a(this,"min_row");a(this,"loading");a(this,"profile_genrator");a(this,"scroller");a(this,"close_big_modal");a(this,"close_small_modal");a(this,"init",async e=>{const t={};e&&(t.row_cursor_id=e);const s=await this.api.load_sheet(this.sheetid,t);return s.ok?(this.apply(s.data,{}),!0):!1});a(this,"apply",(e,t)=>{const s=e.cells||[],r={...t,...xs(s)},n=Object.keys(r).map(l=>({__id:Number(l),sheetid:Number(this.sheetid)})).sort((l,c)=>Number(l.__id)-Number(c.__id));this.min_row=(n[0]||{}).__id||0,this.max_row=(n[n.length-1]||{}).__id||0;const o={columns:e.columns||[],cells:r,rows:n,loading:!1};e.widget_apps&&(o.widgets=e.widget_apps),e.reverse_ref_cols&&(o.ref_columns=e.reverse_ref_cols),this.state.update(l=>({...l,...o}))});a(this,"add_sheet",async(e,t)=>{(await this.api.new_sheet({name:e,opts:t})).ok&&(await this.group.refetch_sheets(),this.force_render_index.update(r=>r+1))});a(this,"remove_sheet",async()=>{await this.api.delete_sheet(this.sheetid),this.group.active_sheets.delete(this.sheetid),await this.group.refetch_sheets()});a(this,"add_column",async e=>{(await this.api.new_column(this.sheetid,e)).ok&&await this.refetch_columns()});a(this,"update_column",async(e,t)=>{(await this.api.update_column(this.sheetid,e,t)).ok&&await this.refetch_columns()});a(this,"remove_column",async e=>{(await this.api.delete_column(this.sheetid,e)).ok||await this.refetch_columns()});a(this,"add_row_cell",async e=>{const t=await this.api.new_row_cell(this.sheetid,e);if(!t.ok)return t;const s=t.data[0].rowid;return this.insert_one_row(s,t.data),t});a(this,"update_row_cell",async(e,t)=>{const s=await this.api.update_row_cell(this.sheetid,e,t);return s.ok&&this.update_one_row(Number(e),s.data),s});a(this,"remove_row_cell",async e=>{if((await this.api.delete_row_cell(this.sheetid,e)).ok){const s=Number(e);this.state.update(r=>{const n=r.rows.filter(o=>o.__id!==s);return{...r,rows:n}})}});a(this,"ref_sheet_query",async e=>{const t=await this.api.ref_query_sheet(this.sheetid,e);return t.ok?Ls(t.data):{}});a(this,"refetch_columns",async()=>{const e=await this.api.list_columns(this.sheetid);e.ok&&(console.log("@refetch_column",e.data),this.state.update(t=>({...t,columns:e.data})))});a(this,"get_relations",(e,t,s)=>this.api.get_row_relation(this.sheetid,e,t,s));a(this,"search",e=>this.api.search(this.sheetid,e));a(this,"goto_row",e=>{ye(this.state).cells[e]?this.scroller&&this.scroller(e):this.init(Number(e)-1)});a(this,"scroll_top",async()=>{if(this.loading=!0,this.scroll_skip())return;const e=await this.api.query_sheet(this.sheetid,{row_cursor_id:this.min_row});if(!e.ok){this.loading=!1;return}this.apply(e.data,ye(this.state).cells),this.loading=!1});a(this,"scroll_bottom",async()=>{if(this.loading=!0,this.scroll_skip())return;const e=await this.api.query_sheet(this.sheetid,{row_cursor_id:this.max_row});if(!e.ok){this.loading=!1;return}this.apply(e.data,ye(this.state).cells),this.loading=!1});a(this,"export",()=>{const e=ye(this.group.sheets).map(t=>t.__id);return this.api.export(e)});a(this,"on_sockd",e=>{switch(e.mod_type){case"sheet_insert":this.insert_one_row(e.rows[0],e.data);break;case"sheet_update":this.update_one_row(e.rows[0],e.data);break;case"sheet_delete":const t=Number(e.rows[0]);this.state.update(s=>{const r=s.rows.filter(n=>n.__id!==t);return{...s,rows:r}});break}});a(this,"insert_one_row",(e,t)=>{if(ye(this.state).rows.findIndex(r=>r.__id===e)!==-1){console.log("@skipping insert row",e);return}this.state.update(r=>(r.rows.push({__id:e,sheetid:Number(this.sheetid)}),t.forEach(n=>{const o=r.cells[n.rowid]||{};o[n.colid]=n,r.cells[n.rowid]=o}),{...r}))});a(this,"update_one_row",(e,t)=>{if(ye(this.state).rows.findIndex(r=>r.__id===e)===-1){console.log("@skipping update row, cause outof range ?",e);return}this.state.update(r=>(t.forEach(n=>{const o=r.cells[n.rowid]||{};o[n.colid]=n,r.cells[n.rowid]=o}),{...r}))});this.group=e,this.sheetid=t,this.sheet_name=s,this.profile_genrator=r,this.api=e.data_sheet_api,this.state=Be({cells:{},columns:[],rows:[],widgets:[],ref_columns:[],loading:!0}),this.force_render_index=Be(0),this.state.subscribe(n=>console.log("@state",n)),this.max_row=0,this.min_row=0,this.loading=!1,this.scroll_skip=xr().skip}get_invoker(e,t){return new Sr(this,e,t)}get_exec_data(e){const t=ye(this.state),s={};return e.forEach(r=>{s[r]=t.cells[r]}),{data_group:this.group.group_slug,invoker_type:"data_sheet",sheet_id:Number(this.sheetid),sheet_name:this.sheet_name,cells:s,columns:t.columns,rows:e.map(r=>({__id:r,sheetid:Number(this.sheetid)})),source:this.group.source}}}class Sr{constructor(e,t,s){a(this,"widget");a(this,"service");a(this,"instance_id");a(this,"launcher");a(this,"init",e=>{this.instance_id=e});a(this,"handle",(e,t)=>{console.log("@instance_handle",e,t)});a(this,"close",()=>{});this.widget=t,this.service=e,this.launcher=s}}class Ir{constructor(e){a(this,"sources");a(this,"current_group");a(this,"sockd_builder");a(this,"apm");a(this,"close_modal");a(this,"open_modal");a(this,"api_base_url");a(this,"current_sheet_group");a(this,"profile_genrator");a(this,"group_service",async(e,t)=>this.current_group?this.current_group.source===e&&this.current_group.name===t?this.current_group:(await this.current_group.close(),this.create_group(e,t)):(this.current_group=await this.create_group(e,t),this.current_group));a(this,"group_sheet",async(e,t)=>this.current_sheet_group?this.current_sheet_group.source===e&&this.current_sheet_group.group_slug?this.current_sheet_group:this.create_group_sheet(e,t):this.create_group_sheet(e,t));a(this,"create_group_sheet",async(e,t)=>{const s=await this.apm.get_data_api(e,t),r=new Lr(e,t,s,this.sockd_builder,this.profile_genrator);return await r.init(),this.current_sheet_group=r,r});a(this,"create_group",async(e,t)=>{const s=await this.apm.get_data_api(e,t);if(!s){console.log("BIG ERR");return}const r=new Er({api:s,name:t,source:e,close_modal:this.close_modal,open_modal:this.open_modal,api_base_url:this.api_base_url,sockd_builder:this.sockd_builder,profile_generator:this.profile_genrator});return await r.init(),r});this.sources=e.sources,this.current_group=null,this.apm=e.apm,this.api_base_url=e.api_base_url,this.close_modal=e.close_modal,this.open_modal=e.open_modal,this.sockd_builder=e.sockd_builder,this.profile_genrator=e.profile_genrator}}class Ar{constructor(e){a(this,"apm");a(this,"source_apis");a(this,"folder_apis");a(this,"sources");this.apm=e,this.source_apis=new Map,this.sources=null,this.folder_apis=new Map}get_source_api(e){this.source_apis.has(e)&&this.source_apis.get(e);const t=this.apm.get_cabinet(e);return this.source_apis.set(e,t),t}async get_cab_sources(){if(this.sources)return this.sources;const t=await this.apm.get_self_api().list_cabinet_sources();return t.ok?(this.sources=t.data,this.sources):[]}async get_folder_api(e,t){const s=`${e}#${t}`;let r=this.folder_apis.get(s);return r||(r=await this.apm.get_folder_api(e,t),this.folder_apis.set(s,r),r)}}class Dr{constructor(){a(this,"build",async(e,t)=>{const s=new br(e);return s.SetHandler(t),await s.Init(),s})}}class Mr{constructor(e,t){a(this,"app");a(this,"registry");a(this,"bprint_editors");a(this,"init",()=>{this.registry.GetAll("portal_extensions").forEach(t=>{t({xmgr:this})})});a(this,"register_bprint_editor",(e,t)=>{this.bprint_editors.set(e,t)});this.app=e,this.registry=t,this.bprint_editors=new Map,console.log("XTMGR ",this)}}class Cr{constructor(e){a(this,"options");a(this,"nav");a(this,"api_manager");a(this,"sockd_service");a(this,"notifier");a(this,"utils");a(this,"registry");a(this,"logger");a(this,"xtmgr");a(this,"services");a(this,"launcher");a(this,"data_service");a(this,"cabinet_service");a(this,"get_sockd_service",()=>this.sockd_service);a(this,"get_cabinet_service",()=>this.cabinet_service);a(this,"get_user_profile",e=>`${this.options.base_url}/z/assets/system/${this.options.tenant_id}/user/${e}`);a(this,"logout",()=>{this.options.site_utils.clearAuthedData(),location.href="/z/auth"});console.log("@portal_service",this),this.options=e,this.nav=new or,this.api_manager=new ir(e.base_url,e.tenant_id,e.user_token),this.services=new Map,this.launcher=new nr,this.sockd_service=new Dr,this.cabinet_service=new Ar(this.api_manager),this.registry=e.registry,this.xtmgr=new Mr(this,this.registry)}async init(){const e=await this.api_manager.init();if(e)return e;this.init_notifier(),this.xtmgr.init()}async init_notifier(){const e=this.api_manager.self_api.self_ws_url();this.notifier=new lr(this.api_manager.self_api);const t=await this.sockd_service.build(e,this.notifier.handle_sockd);this.notifier.set_sockd(t),await this.notifier.init()}async get_data_service(){return this.data_service||(this.data_service=new Ir({apm:this.api_manager,sources:await this.api_manager.self_data.get_data_sources(),close_modal:this.utils.big_modal_close,open_modal:this.utils.big_modal_open,api_base_url:this.api_manager.api_base_url,sockd_builder:this.sockd_service,profile_genrator:this.get_user_profile})),this.data_service}inject(e){this.utils=e,this.notifier.toast_open=e.toast_success}}function Br(i){let e,t,s,r,n,o,l="Some Error Occured",c,u,_="Sorry, invalid session or you are not logged in.",p,k,g='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L7.414 9H15a1 1 0 110 2H7.414l2.293 2.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg> <span>Goto Auth Page</span>',v,f;return{c(){e=$("div"),t=$("img"),r=B(),n=$("div"),o=$("p"),o.textContent=l,c=B(),u=$("p"),u.textContent=_,p=B(),k=$("button"),k.innerHTML=g,this.h()},l(d){e=y(d,"DIV",{class:!0});var m=x(e);t=y(m,"IMG",{src:!0,class:!0,alt:!0}),r=N(m),n=y(m,"DIV",{class:!0});var T=x(n);o=y(T,"P",{class:!0,"data-svelte-h":!0}),ae(o)!=="svelte-18wt2if"&&(o.textContent=l),c=N(T),u=y(T,"P",{class:!0,"data-svelte-h":!0}),ae(u)!=="svelte-g9x7m6"&&(u.textContent=_),p=N(T),k=y(T,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(k)!=="svelte-1uw2zau"&&(k.innerHTML=g),T.forEach(b),m.forEach(b),this.h()},h(){_s(t.src,s="/z/assets/static/400.svg")||h(t,"src",s),h(t,"class","w-1/2 md:1/3 lg:w-1/4 text-blue-600"),h(t,"alt","no auth banner"),h(o,"class","text-3xl md:text-4xl lg:text-5xl text-gray-800 mt-12"),h(u,"class","md:text-lg lg:text-xl text-gray-600 mt-8"),h(k,"class","flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 text-gray-100 px-4 py-2 mt-12 rounded transition duration-150"),h(n,"class","flex flex-col items-center justify-center"),h(e,"class","w-full h-screen flex flex-col items-center justify-center")},m(d,m){P(d,e,m),w(e,t),w(e,r),w(e,n),w(n,o),w(n,c),w(n,u),w(n,p),w(n,k),v||(f=F(k,"click",i[0]),v=!0)},p:H,i:H,o:H,d(d){d&&b(e),v=!1,f()}}}function Nr(i){return[()=>{const t=new is;t.clearAuthedData(),t.gotoLoginPage()}]}class Pr extends de{constructor(e){super(),he(this,e,Nr,Br,ne,{})}}function Hr(i){let e,t;return{c(){e=re("svg"),t=re("path"),this.h()},l(s){e=ie(s,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var r=x(e);t=ie(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),x(t).forEach(b),r.forEach(b),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"stroke-width","2"),h(t,"d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"class","h-6 w-6"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke","currentColor")},m(s,r){P(s,e,r),w(e,t)},p:H,i:H,o:H,d(s){s&&b(e)}}}class Or extends de{constructor(e){super(),he(this,e,null,Hr,ne,{})}}function Vr(i){let e,t;return{c(){e=re("svg"),t=re("path"),this.h()},l(s){e=ie(s,"svg",{width:!0,height:!0,fill:!0,class:!0,viewBox:!0,stroke:!0});var r=x(e);t=ie(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),x(t).forEach(b),r.forEach(b),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"stroke-width","2"),h(t,"d","M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"),h(e,"width","20"),h(e,"height","20"),h(e,"fill","currentColor"),h(e,"class","h-6 w-6"),h(e,"viewBox","0 0 24 24"),h(e,"stroke","currentColor")},m(s,r){P(s,e,r),w(e,t)},p:H,i:H,o:H,d(s){s&&b(e)}}}class jr extends de{constructor(e){super(),he(this,e,null,Vr,ne,{})}}function zr(i){let e,t;return{c(){e=re("svg"),t=re("path"),this.h()},l(s){e=ie(s,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var r=x(e);t=ie(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),x(t).forEach(b),r.forEach(b),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"stroke-width","2"),h(t,"d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"class","h-6 w-6"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke","currentColor")},m(s,r){P(s,e,r),w(e,t)},p:H,i:H,o:H,d(s){s&&b(e)}}}class Ur extends de{constructor(e){super(),he(this,e,null,zr,ne,{})}}function Rr(i){let e,t;return{c(){e=re("svg"),t=re("path"),this.h()},l(s){e=ie(s,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var r=x(e);t=ie(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),x(t).forEach(b),r.forEach(b),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"stroke-width","2"),h(t,"d","M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"class","h-6 w-6"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke","currentColor")},m(s,r){P(s,e,r),w(e,t)},p:H,i:H,o:H,d(s){s&&b(e)}}}let Mt=class extends de{constructor(e){super(),he(this,e,null,Rr,ne,{})}};function Fr(i){let e,t,s,r,n,o,l,c;return{c(){e=re("svg"),t=re("path"),s=re("g"),r=re("path"),n=re("ellipse"),o=re("path"),l=re("ellipse"),c=re("path"),this.h()},l(u){e=ie(u,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0});var _=x(e);t=ie(_,"path",{d:!0,fill:!0,stroke:!0,"stroke-width":!0}),x(t).forEach(b),s=ie(_,"g",{fill:!0});var p=x(s);r=ie(p,"path",{d:!0}),x(r).forEach(b),n=ie(p,"ellipse",{ry:!0,rx:!0,cy:!0,cx:!0}),x(n).forEach(b),o=ie(p,"path",{d:!0}),x(o).forEach(b),l=ie(p,"ellipse",{cx:!0,cy:!0,rx:!0,ry:!0}),x(l).forEach(b),c=ie(p,"path",{d:!0}),x(c).forEach(b),p.forEach(b),_.forEach(b),this.h()},h(){h(t,"d","M.378.378h69.7v67.81H.378z"),h(t,"fill","#925bd5"),h(t,"stroke","#fff"),h(t,"stroke-width",".757"),h(r,"d","M26.613 15.364a.26.26 0 0 0-.264.259l-.007.905a3.79 3.79 0 0 0-.465.06l-.228-.879a.26.26 0 1 0-.506.131l.228.88a3.79 3.79 0 0 0-.435.174l-.447-.789a.26.26 0 0 0-.455.258l.447.79a3.79 3.79 0 0 0-.373.283l-.638-.648a.26.26 0 1 0-.373.367l.636.647a3.79 3.79 0 0 0-.289.369l-.781-.459a.26.26 0 1 0-.265.451l.784.461a3.79 3.79 0 0 0-.183.431l-.876-.242a.26.26 0 0 0-.139.504l.873.242-.045.285.597.005c.193-1.592 1.544-2.79 3.148-2.792 1.624.002 2.984 1.229 3.153 2.843l.627.005-.041-.285.879-.228a.26.26 0 0 0-.131-.506l-.88.228a3.79 3.79 0 0 0-.174-.435l.789-.447a.26.26 0 1 0-.258-.455l-.79.447a3.79 3.79 0 0 0-.283-.373l.648-.638a.26.26 0 1 0-.367-.373l-.647.636a3.79 3.79 0 0 0-.369-.289l.459-.781a.26.26 0 1 0-.451-.265l-.461.784a3.79 3.79 0 0 0-.43-.183l.242-.876a.26.26 0 0 0-.504-.14l-.242.873a3.79 3.79 0 0 0-.464-.062l.007-.909a.26.26 0 0 0-.259-.264z"),h(n,"ry",".938"),h(n,"rx",".916"),h(n,"cy","19.213"),h(n,"cx","27.2"),h(o,"d","M43.905 15.364a.26.26 0 0 0-.264.259l-.007.905a3.79 3.79 0 0 0-.465.06l-.228-.879a.26.26 0 0 0-.506.131l.228.88a3.79 3.79 0 0 0-.435.174l-.447-.789a.26.26 0 0 0-.455.258l.447.79a3.79 3.79 0 0 0-.373.283l-.638-.648a.26.26 0 1 0-.373.367l.636.647a3.79 3.79 0 0 0-.289.369l-.781-.459a.26.26 0 1 0-.265.451l.784.461a3.79 3.79 0 0 0-.183.431l-.876-.242a.26.26 0 0 0-.139.504l.873.242-.045.285.597.005c.193-1.592 1.544-2.79 3.148-2.792 1.624.002 2.984 1.229 3.153 2.843l.627.005-.041-.285.879-.228a.26.26 0 1 0-.131-.506l-.88.228a3.79 3.79 0 0 0-.174-.435l.789-.447a.26.26 0 0 0-.258-.455l-.79.447a3.79 3.79 0 0 0-.283-.373l.648-.638a.26.26 0 1 0-.367-.373l-.647.636a3.79 3.79 0 0 0-.369-.289l.459-.781a.26.26 0 1 0-.451-.265l-.461.784a3.79 3.79 0 0 0-.43-.183l.242-.876a.26.26 0 0 0-.504-.14l-.242.873a3.79 3.79 0 0 0-.464-.062l.007-.909a.26.26 0 0 0-.259-.264z"),h(l,"cx","44.493"),h(l,"cy","19.307"),h(l,"rx",".916"),h(l,"ry",".938"),h(c,"d","M17.178 25.113l30.918-.44-1.145 6.518-29.597-3.171zm11.715 5.373l8.632 2.026-.088 28.011-3.435.617z"),h(s,"fill","#fff"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"width","35"),h(e,"height","35"),h(e,"viewBox","0 0 70.457 68.567")},m(u,_){P(u,e,_),w(e,t),w(e,s),w(s,r),w(s,n),w(s,o),w(s,l),w(s,c)},p:H,i:H,o:H,d(u){u&&b(e)}}}class qr extends de{constructor(e){super(),he(this,e,null,Fr,ne,{})}}function Gr(i){let e,t;return e=new Is({props:{exec_data:{agent_id:i[4].agent_id,plug_id:i[4].plug_id,tenant_id:i[4].tenant_id,exec_token:i[3],startup_payload:null},url:i[2],name:i[0].name||"App"}}),{c(){O(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,r){V(e,s,r),t=!0},p(s,r){const n={};r&24&&(n.exec_data={agent_id:s[4].agent_id,plug_id:s[4].plug_id,tenant_id:s[4].tenant_id,exec_token:s[3],startup_payload:null}),r&4&&(n.url=s[2]),r&1&&(n.name=s[0].name||"App"),e.$set(n)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Wr(i){let e,t;return e=new as({}),{c(){O(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,r){V(e,s,r),t=!0},p:H,i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Jr(i){let e,t,s,r;const n=[Wr,Gr],o=[];function l(c,u){return c[1]?0:1}return e=l(i),t=o[e]=n[e](i),{c(){t.c(),s=xe()},l(c){t.l(c),s=xe()},m(c,u){o[e].m(c,u),P(c,s,u),r=!0},p(c,[u]){let _=e;e=l(c),e===_?o[e].p(c,u):(X(),S(o[_],1,1,()=>{o[_]=null}),Y(),t=o[e],t?t.p(c,u):(t=o[e]=n[e](c),t.c()),E(t,1),t.m(s.parentNode,s))},i(c){r||(E(t),r=!0)},o(c){S(t),r=!1},d(c){c&&b(s),o[e].d(c)}}}function Kr(i,e,t){let{options:s}=e;const n=ts("__app__").api_manager.get_engine_api();let o=!0,l="",c="",u={};return(async()=>{const p=await n.launch_target({target_id:Number(s.target_id)});p.ok&&(t(2,l=`http://${p.data.domain}:${location.port||80}/z/pages/agent/inject`),t(3,c=p.data.token),t(4,u=p.data),t(1,o=!1))})(),i.$$set=p=>{"options"in p&&t(0,s=p.options)},[s,o,l,c,u]}class Zr extends de{constructor(e){super(),he(this,e,Kr,Jr,ne,{options:0})}}function Ct(i,e,t){const s=i.slice();return s[13]=e[t],s}function Bt(i,e,t){const s=i.slice();return s[13]=e[t],s}function Qr(i){let e,t="No Apps running";return{c(){e=$("div"),e.textContent=t},l(s){e=y(s,"DIV",{"data-svelte-h":!0}),ae(e)!=="svelte-jbavzs"&&(e.textContent=t)},m(s,r){P(s,e,r)},p:H,i:H,o:H,d(s){s&&b(e)}}}function Xr(i){let e,t,s,r,n,o,l,c=Ae(i[4]),u=[];for(let f=0;f<c.length;f+=1)u[f]=Nt(Bt(i,c,f));const _=f=>S(u[f],1,1,()=>{u[f]=null});let p=i[3]&&Pt(i),k=Ae(i[4]),g=[];for(let f=0;f<k.length;f+=1)g[f]=Ht(Ct(i,k,f));const v=f=>S(g[f],1,1,()=>{g[f]=null});return{c(){e=$("div"),t=$("div");for(let f=0;f<u.length;f+=1)u[f].c();s=B(),r=$("div"),p&&p.c(),n=B(),o=$("div");for(let f=0;f<g.length;f+=1)g[f].c();this.h()},l(f){e=y(f,"DIV",{class:!0});var d=x(e);t=y(d,"DIV",{class:!0});var m=x(t);for(let A=0;A<u.length;A+=1)u[A].l(m);m.forEach(b),s=N(d),r=y(d,"DIV",{class:!0});var T=x(r);p&&p.l(T),T.forEach(b),d.forEach(b),n=N(f),o=y(f,"DIV",{class:!0,style:!0});var I=x(o);for(let A=0;A<g.length;A+=1)g[A].l(I);I.forEach(b),this.h()},h(){h(t,"class","grow h-10 flex flex-row flex-nowrap overflow-hidden"),h(r,"class","grow-0 h-8 w-8 p-1 flex"),h(e,"class","flex justify-between border border-gray-100"),h(o,"class","border border-red-600 w-full"),ps(o,"height","calc(100vh - 2.75rem)")},m(f,d){P(f,e,d),w(e,t);for(let m=0;m<u.length;m+=1)u[m]&&u[m].m(t,null);w(e,s),w(e,r),p&&p.m(r,null),P(f,n,d),P(f,o,d);for(let m=0;m<g.length;m+=1)g[m]&&g[m].m(o,null);l=!0},p(f,d){if(d&59){c=Ae(f[4]);let m;for(m=0;m<c.length;m+=1){const T=Bt(f,c,m);u[m]?(u[m].p(T,d),E(u[m],1)):(u[m]=Nt(T),u[m].c(),E(u[m],1),u[m].m(t,null))}for(X(),m=c.length;m<u.length;m+=1)_(m);Y()}if(f[3]?p?(p.p(f,d),d&8&&E(p,1)):(p=Pt(f),p.c(),E(p,1),p.m(r,null)):p&&(X(),S(p,1,1,()=>{p=null}),Y()),d&18){k=Ae(f[4]);let m;for(m=0;m<k.length;m+=1){const T=Ct(f,k,m);g[m]?(g[m].p(T,d),E(g[m],1)):(g[m]=Ht(T),g[m].c(),E(g[m],1),g[m].m(o,null))}for(X(),m=k.length;m<g.length;m+=1)v(m);Y()}},i(f){if(!l){for(let d=0;d<c.length;d+=1)E(u[d]);E(p);for(let d=0;d<k.length;d+=1)E(g[d]);l=!0}},o(f){u=u.filter(Boolean);for(let d=0;d<u.length;d+=1)S(u[d]);S(p),g=g.filter(Boolean);for(let d=0;d<g.length;d+=1)S(g[d]);l=!1},d(f){f&&(b(e),b(n),b(o)),Fe(u,f),p&&p.d(),Fe(g,f)}}}function Nt(i){let e,t=(i[13].name||"")+"",s,r,n=(i[13].id||"")+"",o,l,c,u,_,p,k,g,v,f;u=new at({props:{name:"x-circle",class:"w-5 pt-1 text-gray-500 hover:text-red-500"}});function d(){return i[8](i[13])}function m(){return i[9](i[13])}return{c(){e=$("button"),s=Se(t),r=Se(" ["),o=Se(n),l=Se(`]   

            `),c=$("button"),O(u.$$.fragment),_=B(),this.h()},l(T){e=y(T,"BUTTON",{id:!0,class:!0});var I=x(e);s=Ie(I,t),r=Ie(I," ["),o=Ie(I,n),l=Ie(I,`]   

            `),c=y(I,"BUTTON",{});var A=x(c);q(u.$$.fragment,A),A.forEach(b),_=N(I),I.forEach(b),this.h()},h(){h(e,"id",p=`itab-item-${i[13].id}`),h(e,"class",k="text-gray-600 py-2 px-2 flex hover:text-blue-500 cursor-pointer focus:outline-none "+(i[13].id===i[1]?"text-blue-500 border-b-2 font-medium border-blue-500":""))},m(T,I){P(T,e,I),w(e,s),w(e,r),w(e,o),w(e,l),w(e,c),V(u,c,null),w(e,_),g=!0,v||(f=[F(c,"click",d),F(e,"click",m)],v=!0)},p(T,I){i=T,(!g||I&16)&&t!==(t=(i[13].name||"")+"")&&ze(s,t),(!g||I&16)&&n!==(n=(i[13].id||"")+"")&&ze(o,n),(!g||I&16&&p!==(p=`itab-item-${i[13].id}`))&&h(e,"id",p),(!g||I&18&&k!==(k="text-gray-600 py-2 px-2 flex hover:text-blue-500 cursor-pointer focus:outline-none "+(i[13].id===i[1]?"text-blue-500 border-b-2 font-medium border-blue-500":"")))&&h(e,"class",k)},i(T){g||(E(u.$$.fragment,T),g=!0)},o(T){S(u.$$.fragment,T),g=!1},d(T){T&&b(e),j(u),v=!1,Ke(f)}}}function Pt(i){let e,t,s,r,n;return t=new at({props:{name:"eye-off",class:"w-6 h-6 rounded border hover:text-blue-500"}}),{c(){e=$("button"),O(t.$$.fragment)},l(o){e=y(o,"BUTTON",{});var l=x(e);q(t.$$.fragment,l),l.forEach(b)},m(o,l){P(o,e,l),V(t,e,null),s=!0,r||(n=F(e,"click",i[10]),r=!0)},p:H,i(o){s||(E(t.$$.fragment,o),s=!0)},o(o){S(t.$$.fragment,o),s=!1},d(o){o&&b(e),j(t),r=!1,n()}}}function Ht(i){let e,t,s,r,n;return t=new Zr({props:{options:i[13]}}),{c(){e=$("div"),O(t.$$.fragment),s=B(),this.h()},l(o){e=y(o,"DIV",{class:!0});var l=x(e);q(t.$$.fragment,l),s=N(l),l.forEach(b),this.h()},h(){h(e,"class",r="w-full h-full "+(i[13].id===i[1]?"":"hidden")+" svelte-fe4014")},m(o,l){P(o,e,l),V(t,e,null),w(e,s),n=!0},p(o,l){const c={};l&16&&(c.options=o[13]),t.$set(c),(!n||l&18&&r!==(r="w-full h-full "+(o[13].id===o[1]?"":"hidden")+" svelte-fe4014"))&&h(e,"class",r)},i(o){n||(E(t.$$.fragment,o),n=!0)},o(o){S(t.$$.fragment,o),n=!1},d(o){o&&b(e),j(t)}}}function Yr(i){let e,t,s,r,n;const o=[Xr,Qr],l=[];function c(u,_){return u[1]?0:u[2]?-1:1}return~(t=c(i))&&(s=l[t]=o[t](i)),{c(){e=$("div"),s&&s.c(),this.h()},l(u){e=y(u,"DIV",{class:!0});var _=x(e);s&&s.l(_),_.forEach(b),this.h()},h(){h(e,"class",r="bg-white "+(i[2]?"hidden":i[3]?"floating":"not-floating")+" svelte-fe4014")},m(u,_){P(u,e,_),~t&&l[t].m(e,null),n=!0},p(u,[_]){let p=t;t=c(u),t===p?~t&&l[t].p(u,_):(s&&(X(),S(l[p],1,1,()=>{l[p]=null}),Y()),~t?(s=l[t],s?s.p(u,_):(s=l[t]=o[t](u),s.c()),E(s,1),s.m(e,null)):s=null),(!n||_&12&&r!==(r="bg-white "+(u[2]?"hidden":u[3]?"floating":"not-floating")+" svelte-fe4014"))&&h(e,"class",r)},i(u){n||(E(s),n=!0)},o(u){S(s),n=!1},d(u){u&&b(e),~t&&l[t].d()}}}function ei(i,e,t){let s,r,n,o,l;const c=ts("__app__");let{launcher:u}=e;const _=u.state;je(i,_,d=>t(7,l=d));let p;fs(()=>{if(!r||n||p===r)return;const d=document.getElementById(`itab-item-${r}`);d&&d.scrollIntoView(),p=r,console.log("@fix_tab")});const g=d=>u.instance_close(d.id),v=d=>{o?u.instance_change(d.id):c.nav.launch_target(d.target_id)},f=()=>{u.plane_hide()};return i.$$set=d=>{"launcher"in d&&t(0,u=d.launcher)},i.$$.update=()=>{i.$$.dirty&128&&t(4,s=l.instances),i.$$.dirty&128&&t(1,r=l.active_instance),i.$$.dirty&128&&t(2,n=l.display==="HIDDEN"),i.$$.dirty&128&&t(3,o=l.display==="FLOATING")},[u,r,n,o,s,c,_,l,g,v,f]}class ti extends de{constructor(e){super(),he(this,e,ei,Yr,ne,{launcher:0})}}function Ot(i,e,t){const s=i.slice();return s[21]=e[t],s}function Vt(i,e,t){const s=i.slice();return s[21]=e[t],s}function jt(i){let e,t,s,r,n,o,l;var c=i[21][0];function u(_,p){return{}}return c&&(r=Ne(c,u())),{c(){e=$("li"),t=$("a"),s=$("button"),r&&O(r.$$.fragment),this.h()},l(_){e=y(_,"LI",{class:!0});var p=x(e);t=y(p,"A",{href:!0,class:!0});var k=x(t);s=y(k,"BUTTON",{});var g=x(s);r&&q(r.$$.fragment,g),g.forEach(b),k.forEach(b),p.forEach(b),this.h()},h(){h(t,"href",i[21][2]),h(t,"class","h-12 px-4 flex justify-center items-center w-full text-gray-700 focus:text-orange-500"),h(e,"class","text-white hover:bg-gray-100")},m(_,p){P(_,e,p),w(e,t),w(t,s),r&&V(r,s,null),n=!0,o||(l=F(t,"click",i[8]),o=!0)},p(_,p){if(c!==(c=_[21][0])){if(r){X();const k=r;S(k.$$.fragment,1,0,()=>{j(k,1)}),Y()}c?(r=Ne(c,u()),O(r.$$.fragment),E(r.$$.fragment,1),V(r,s,null)):r=null}},i(_){n||(r&&E(r.$$.fragment,_),n=!0)},o(_){r&&S(r.$$.fragment,_),n=!1},d(_){_&&b(e),r&&j(r),o=!1,l()}}}function zt(i){let e,t='<span class="animate-ping absolute inline-flex h-3 w-3 rounded-full bg-pink-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-pink-500"></span>';return{c(){e=$("span"),e.innerHTML=t,this.h()},l(s){e=y(s,"SPAN",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-1tvvu8n"&&(e.innerHTML=t),this.h()},h(){h(e,"class","flex absolute -mt-5 ml-4")},m(s,r){P(s,e,r)},d(s){s&&b(e)}}}function Ut(i){let e,t='<span class="animate-ping absolute inline-flex h-3 w-3 rounded-full bg-pink-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-pink-500"></span>';return{c(){e=$("span"),e.innerHTML=t,this.h()},l(s){e=y(s,"SPAN",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-m2o7nj"&&(e.innerHTML=t),this.h()},h(){h(e,"class","flex absolute -mt-5 ml-4")},m(s,r){P(s,e,r)},d(s){s&&b(e)}}}function Rt(i){let e,t,s,r,n,o='<svg class="h-6 w-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18 6L6 18" stroke="#4B5563" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6 6L18 18" stroke="#4B5563" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"></path></svg>',l,c,u,_,p,k='<svg class="h-5 w-5 text-red-700" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>',g,v,f,d=Ae(i[4]),m=[];for(let I=0;I<d.length;I+=1)m[I]=Ft(Ot(i,d,I));const T=I=>S(m[I],1,1,()=>{m[I]=null});return{c(){e=$("div"),t=$("div"),s=$("div"),r=$("div"),n=$("button"),n.innerHTML=o,l=B(),c=$("ul");for(let I=0;I<m.length;I+=1)m[I].c();u=B(),_=$("li"),p=$("button"),p.innerHTML=k,this.h()},l(I){e=y(I,"DIV",{class:!0});var A=x(e);t=y(A,"DIV",{class:!0});var D=x(t);s=y(D,"DIV",{class:!0});var W=x(s);r=y(W,"DIV",{class:!0});var z=x(r);n=y(z,"BUTTON",{"aria-label":!0,class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-1rovpn3"&&(n.innerHTML=o),z.forEach(b),l=N(W),c=y(W,"UL",{class:!0});var J=x(c);for(let U=0;U<m.length;U+=1)m[U].l(J);u=N(J),_=y(J,"LI",{class:!0});var oe=x(_);p=y(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(p)!=="svelte-1ts92nl"&&(p.innerHTML=k),oe.forEach(b),J.forEach(b),W.forEach(b),D.forEach(b),A.forEach(b),this.h()},h(){h(n,"aria-label","close menu modal"),h(n,"class","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 cursor-pointer rounded border mr-2"),h(r,"class","absolute right-4"),h(p,"class","h-12 cursor-pointer mx-auto flex justify-center items-center w-full focus:text-orange-500 hover:bg-red-200 focus:outline-none"),h(_,"class","border rounded"),h(c,"class","space-y-4 pt-10"),h(s,"class","h-full bg-white rounded p-5"),h(t,"class","h-full w-full absolute transform translate-x-0 transition ease-in-out duration-700 p-5"),h(e,"class","h-screen w-screen bg-gray-600 bg-opacity-90 fixed z-50")},m(I,A){P(I,e,A),w(e,t),w(t,s),w(s,r),w(r,n),w(s,l),w(s,c);for(let D=0;D<m.length;D+=1)m[D]&&m[D].m(c,null);w(c,u),w(c,_),w(_,p),g=!0,v||(f=[F(n,"click",i[17]),F(p,"click",i[19])],v=!0)},p(I,A){if(A&24){d=Ae(I[4]);let D;for(D=0;D<d.length;D+=1){const W=Ot(I,d,D);m[D]?(m[D].p(W,A),E(m[D],1)):(m[D]=Ft(W),m[D].c(),E(m[D],1),m[D].m(c,u))}for(X(),D=d.length;D<m.length;D+=1)T(D);Y()}},i(I){if(!g){for(let A=0;A<d.length;A+=1)E(m[A]);g=!0}},o(I){m=m.filter(Boolean);for(let A=0;A<m.length;A+=1)S(m[A]);g=!1},d(I){I&&b(e),Fe(m,I),v=!1,Ke(f)}}}function Ft(i){let e,t,s,r,n=i[21][1]+"",o,l,c,u;var _=i[21][0];function p(k,g){return{}}return _&&(s=Ne(_,p())),{c(){e=$("li"),t=$("a"),s&&O(s.$$.fragment),r=B(),o=Se(n),this.h()},l(k){e=y(k,"LI",{class:!0});var g=x(e);t=y(g,"A",{href:!0,class:!0});var v=x(t);s&&q(s.$$.fragment,v),r=N(v),o=Ie(v,n),v.forEach(b),g.forEach(b),this.h()},h(){h(t,"href",i[21][2]),h(t,"class","h-12 px-4 flex justify-center items-center w-full text-gray-700 focus:text-orange-500 uppercase"),h(e,"class","border rounded")},m(k,g){P(k,e,g),w(e,t),s&&V(s,t,null),w(t,r),w(t,o),l=!0,c||(u=F(t,"click",i[18]),c=!0)},p(k,g){if(_!==(_=k[21][0])){if(s){X();const v=s;S(v.$$.fragment,1,0,()=>{j(v,1)}),Y()}_?(s=Ne(_,p()),O(s.$$.fragment),E(s.$$.fragment,1),V(s,t,r)):s=null}},i(k){l||(s&&E(s.$$.fragment,k),l=!0)},o(k){s&&S(s.$$.fragment,k),l=!1},d(k){k&&b(e),s&&j(s),c=!1,u()}}}function qt(i){let e;const t=i[7].default,s=qe(t,i,i[6],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&64)&&Ge(s,t,r,r[6],e?Je(t,r[6],n,null):We(r[6]),null)},i(r){e||(E(s,r),e=!0)},o(r){S(s,r),e=!1},d(r){s&&s.d(r)}}}function si(i){let e,t,s,r,n,o,l,c,u,_,p,k,g,v,f,d,m,T,I,A,D,W,z,J='<svg class="h-5 w-5 text-red-700" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>',oe,U,ee,le,Le='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hover:text-gray-200" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>',me,C,_e,Te,ue,fe,R,Me,K,Z,be,ke,we,$e,Ee,De,L,_t;n=new qr({});let Pe=Ae(i[4]),Q=[];for(let M=0;M<Pe.length;M+=1)Q[M]=jt(Vt(i,Pe,M));const us=M=>S(Q[M],1,1,()=>{Q[M]=null});k=new at({props:{name:"lightning-bolt",class:"w-6 h-6"}});let pe=i[0]&&zt();T=new Mt({}),D=new Lt({}),_e=new at({props:{name:"lightning-bolt",class:"w-6 h-6"}}),fe=new Mt({});let ge=i[0]&&Ut();Z=new Lt({});let te=i[3]&&Rt(i);$e=new ti({props:{launcher:i[1]}});let se=!i[2]&&qt(i);return{c(){e=$("div"),t=$("nav"),s=$("div"),r=$("a"),O(n.$$.fragment),o=B(),l=$("ul");for(let M=0;M<Q.length;M+=1)Q[M].c();c=B(),u=$("li"),_=$("span"),p=$("button"),O(k.$$.fragment),g=B(),v=$("div"),f=$("div"),d=$("button"),pe&&pe.c(),m=B(),O(T.$$.fragment),I=B(),A=$("button"),O(D.$$.fragment),W=B(),z=$("button"),z.innerHTML=J,oe=B(),U=$("nav"),ee=$("div"),le=$("a"),le.innerHTML=Le,me=B(),C=$("button"),O(_e.$$.fragment),Te=B(),ue=$("button"),O(fe.$$.fragment),R=B(),ge&&ge.c(),Me=B(),K=$("button"),O(Z.$$.fragment),be=B(),te&&te.c(),ke=B(),we=$("div"),O($e.$$.fragment),Ee=B(),se&&se.c(),this.h()},l(M){e=y(M,"DIV",{class:!0});var G=x(e);t=y(G,"NAV",{class:!0});var ve=x(t);s=y(ve,"DIV",{class:!0});var ce=x(s);r=y(ce,"A",{class:!0,href:!0});var Ue=x(r);q(n.$$.fragment,Ue),Ue.forEach(b),ce.forEach(b),o=N(ve),l=y(ve,"UL",{});var Qe=x(l);for(let lt=0;lt<Q.length;lt+=1)Q[lt].l(Qe);c=N(Qe),u=y(Qe,"LI",{class:!0});var ft=x(u);_=y(ft,"SPAN",{class:!0});var pt=x(_);p=y(pt,"BUTTON",{});var gt=x(p);q(k.$$.fragment,gt),gt.forEach(b),pt.forEach(b),ft.forEach(b),Qe.forEach(b),g=N(ve),v=y(ve,"DIV",{class:!0});var mt=x(v);f=y(mt,"DIV",{class:!0});var He=x(f);d=y(He,"BUTTON",{class:!0});var Xe=x(d);pe&&pe.l(Xe),m=N(Xe),q(T.$$.fragment,Xe),Xe.forEach(b),I=N(He),A=y(He,"BUTTON",{class:!0});var bt=x(A);q(D.$$.fragment,bt),bt.forEach(b),W=N(He),z=y(He,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(z)!=="svelte-15dgien"&&(z.innerHTML=J),He.forEach(b),mt.forEach(b),ve.forEach(b),oe=N(G),U=y(G,"NAV",{class:!0});var Ce=x(U);ee=y(Ce,"DIV",{class:!0});var wt=x(ee);le=y(wt,"A",{class:!0,href:!0,"data-svelte-h":!0}),ae(le)!=="svelte-8ihpxb"&&(le.innerHTML=Le),wt.forEach(b),me=N(Ce),C=y(Ce,"BUTTON",{class:!0});var vt=x(C);q(_e.$$.fragment,vt),vt.forEach(b),Te=N(Ce),ue=y(Ce,"BUTTON",{class:!0});var Ye=x(ue);q(fe.$$.fragment,Ye),R=N(Ye),ge&&ge.l(Ye),Ye.forEach(b),Me=N(Ce),K=y(Ce,"BUTTON",{class:!0});var kt=x(K);q(Z.$$.fragment,kt),kt.forEach(b),Ce.forEach(b),be=N(G),te&&te.l(G),ke=N(G),we=y(G,"DIV",{class:!0});var et=x(we);q($e.$$.fragment,et),Ee=N(et),se&&se.l(et),et.forEach(b),G.forEach(b),this.h()},h(){h(r,"class","h-6 mx-auto"),h(r,"href","http://github.com/temphia/temphia/"),h(s,"class","h-16 flex items-center w-full"),h(_,"class","h-12 px-4 flex justify-center items-center w-full text-gray-700 focus:text-orange-500"),h(u,"class","text-white hover:bg-gray-100"),h(d,"class","h-12 cursor-pointer mx-auto w-full flex justify-center items-center focus:text-orange-500 hover:bg-red-200 focus:outline-none relative"),h(A,"class","h-12 cursor-pointer mx-auto flex justify-center items-center w-full focus:text-orange-500 hover:bg-red-200 focus:outline-none"),h(z,"class","h-12 cursor-pointer mx-auto flex justify-center items-center w-full focus:text-orange-500 hover:bg-red-200 focus:outline-none"),h(f,"class","flex flex-col items-center w-full"),h(v,"class","mt-auto flex items-center w-full"),h(t,"class","flex-col items-center h-full w-12 shadow-lg tx-nav-desktop variant-glass-primary svelte-5oj05y"),h(le,"class","navbar-burger self-center mr-12"),h(le,"href","#"),h(ee,"class","py-2 flex w-full items-center"),h(C,"class","flex mr-6 items-center cursor-pointer"),h(ue,"class","flex mr-6 items-center cursor-pointer"),h(K,"class","flex mr-6 items-center cursor-pointer"),h(U,"class","justify-between w-screen variant-glass-primary text-gray-700 shadow-lg tx-nav-mobile svelte-5oj05y"),h(we,"class","h-screen overflow-auto tx-main svelte-5oj05y"),h(e,"class","h-screen w-screen flex tx-root svelte-5oj05y")},m(M,G){P(M,e,G),w(e,t),w(t,s),w(s,r),V(n,r,null),w(t,o),w(t,l);for(let ve=0;ve<Q.length;ve+=1)Q[ve]&&Q[ve].m(l,null);w(l,c),w(l,u),w(u,_),w(_,p),V(k,p,null),w(t,g),w(t,v),w(v,f),w(f,d),pe&&pe.m(d,null),w(d,m),V(T,d,null),w(f,I),w(f,A),V(D,A,null),w(f,W),w(f,z),w(e,oe),w(e,U),w(U,ee),w(ee,le),w(U,me),w(U,C),V(_e,C,null),w(U,Te),w(U,ue),V(fe,ue,null),w(ue,R),ge&&ge.m(ue,null),w(U,Me),w(U,K),V(Z,K,null),w(e,be),te&&te.m(e,null),w(e,ke),w(e,we),V($e,we,null),w(we,Ee),se&&se.m(we,null),De=!0,L||(_t=[F(p,"click",i[9]),F(d,"click",i[10]),F(A,"click",i[11]),F(z,"click",i[12]),F(le,"click",i[13]),F(C,"click",i[14]),F(ue,"click",i[15]),F(K,"click",i[16])],L=!0)},p(M,[G]){if(G&18){Pe=Ae(M[4]);let ce;for(ce=0;ce<Pe.length;ce+=1){const Ue=Vt(M,Pe,ce);Q[ce]?(Q[ce].p(Ue,G),E(Q[ce],1)):(Q[ce]=jt(Ue),Q[ce].c(),E(Q[ce],1),Q[ce].m(l,c))}for(X(),ce=Pe.length;ce<Q.length;ce+=1)us(ce);Y()}M[0]?pe||(pe=zt(),pe.c(),pe.m(d,m)):pe&&(pe.d(1),pe=null),M[0]?ge||(ge=Ut(),ge.c(),ge.m(ue,null)):ge&&(ge.d(1),ge=null),M[3]?te?(te.p(M,G),G&8&&E(te,1)):(te=Rt(M),te.c(),E(te,1),te.m(e,ke)):te&&(X(),S(te,1,1,()=>{te=null}),Y());const ve={};G&2&&(ve.launcher=M[1]),$e.$set(ve),M[2]?se&&(X(),S(se,1,1,()=>{se=null}),Y()):se?(se.p(M,G),G&4&&E(se,1)):(se=qt(M),se.c(),E(se,1),se.m(we,null))},i(M){if(!De){E(n.$$.fragment,M);for(let G=0;G<Pe.length;G+=1)E(Q[G]);E(k.$$.fragment,M),E(T.$$.fragment,M),E(D.$$.fragment,M),E(_e.$$.fragment,M),E(fe.$$.fragment,M),E(Z.$$.fragment,M),E(te),E($e.$$.fragment,M),E(se),De=!0}},o(M){S(n.$$.fragment,M),Q=Q.filter(Boolean);for(let G=0;G<Q.length;G+=1)S(Q[G]);S(k.$$.fragment,M),S(T.$$.fragment,M),S(D.$$.fragment,M),S(_e.$$.fragment,M),S(fe.$$.fragment,M),S(Z.$$.fragment,M),S(te),S($e.$$.fragment,M),S(se),De=!1},d(M){M&&b(e),j(n),Fe(Q,M),j(k),pe&&pe.d(),j(T),j(D),j(_e),j(fe),ge&&ge.d(),j(Z),te&&te.d(),j($e),se&&se.d(),L=!1,Ke(_t)}}}function ri(i,e,t){let s,r,{$$slots:n={},$$scope:o}=e,{pending_notification:l=!1}=e,{launcher:c}=e;const u=[[Or,"start","/z/pages/portal"],[Ts,"data tables","/z/pages/portal/data"],[jr,"admin","/z/pages/portal/admin/bprint"],[Ur,"cabinet","/z/pages/portal/cabinet/listings"],[Ss,"store","/z/pages/portal/repo/"]],_=dt(),p=()=>{c.plane_not_float()},k=()=>_("open_executors"),g=()=>{c.plane_not_float(),_("notification_toggle")},v=()=>{c.plane_not_float(),_("self_profile")},f=()=>{c.plane_not_float(),_("logout")},d=()=>{c.plane_not_float(),t(3,s=!s)},m=()=>_("open_executors"),T=()=>{c.plane_not_float(),_("notification_toggle")},I=()=>{c.plane_not_float(),_("self_profile")},A=()=>{t(3,s=!s)},D=()=>{t(3,s=!1)},W=()=>_("logout");return i.$$set=z=>{"pending_notification"in z&&t(0,l=z.pending_notification),"launcher"in z&&t(1,c=z.launcher),"$$scope"in z&&t(6,o=z.$$scope)},t(3,s=!1),t(2,r=!1),[l,c,r,s,u,_,o,n,p,k,g,v,f,d,m,T,I,A,D,W]}class ii extends de{constructor(e){super(),he(this,e,ri,si,ne,{pending_notification:0,launcher:1})}}function ai(i){let e,t;return{c(){e=re("svg"),t=re("path"),this.h()},l(s){e=ie(s,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0});var r=x(e);t=ie(r,"path",{d:!0,fill:!0}),x(t).forEach(b),r.forEach(b),this.h()},h(){h(t,"d","M4.30325 12.6667L1.33325 15V2.66667C1.33325 2.48986 1.40349 2.32029 1.52851 2.19526C1.65354 2.07024 1.82311 2 1.99992 2H13.9999C14.1767 2 14.3463 2.07024 14.4713 2.19526C14.5963 2.32029 14.6666 2.48986 14.6666 2.66667V12C14.6666 12.1768 14.5963 12.3464 14.4713 12.4714C14.3463 12.5964 14.1767 12.6667 13.9999 12.6667H4.30325ZM5.33325 6.66667V8H10.6666V6.66667H5.33325Z"),h(t,"fill","#4338CA"),h(e,"width","16"),h(e,"height","16"),h(e,"viewBox","0 0 16 16"),h(e,"fill","none"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(s,r){P(s,e,r),w(e,t)},p:H,i:H,o:H,d(s){s&&b(e)}}}class ni extends de{constructor(e){super(),he(this,e,null,ai,ne,{})}}function oi(i){let e,t='<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 3.5L3.5 10.5" stroke="#4B5563" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"></path><path d="M3.5 3.5L10.5 10.5" stroke="#4B5563" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"></path></svg>',s,r;return{c(){e=$("div"),e.innerHTML=t,this.h()},l(n){e=y(n,"DIV",{tabindex:!0,"aria-label":!0,role:!0,class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-1ii0ltq"&&(e.innerHTML=t),this.h()},h(){h(e,"tabindex","0"),h(e,"aria-label","delete icon"),h(e,"role","button"),h(e,"class","focus:outline-none cursor-pointer")},m(n,o){P(n,e,o),s||(r=F(e,"click",function(){gs(i[0])&&i[0].apply(this,arguments)}),s=!0)},p(n,[o]){i=n},i:H,o:H,d(n){n&&b(e),s=!1,r()}}}function li(i,e,t){let{onClick:s}=e;return i.$$set=r=>{"onClick"in r&&t(0,s=r.onClick)},[s]}class ui extends de{constructor(e){super(),he(this,e,li,oi,ne,{onClick:0})}}function Gt(i){let e,t='<div class="h-2 w-2 rounded-full bg-green-400"></div>';return{c(){e=$("div"),e.innerHTML=t,this.h()},l(s){e=y(s,"DIV",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-1aewlqt"&&(e.innerHTML=t),this.h()},h(){h(e,"class","absolute")},m(s,r){P(s,e,r)},d(s){s&&b(e)}}}function ci(i){let e,t="Not implemented";return{c(){e=$("div"),e.textContent=t},l(s){e=y(s,"DIV",{"data-svelte-h":!0}),ae(e)!=="svelte-25gnt7"&&(e.textContent=t)},m(s,r){P(s,e,r)},p:H,i:H,o:H,d(s){s&&b(e)}}}function di(i){let e,t,s,r,n=(i[2].from_user||(i[2].type==="system_message"?"system":""))+"",o,l,c,u=(i[2].contents||"")+"",_,p,k,g,v;k=new ui({props:{onClick:i[3]}});let f=i[2].created_at&&Wt(i);return{c(){e=$("div"),t=$("div"),s=$("p"),r=$("span"),o=Se(n),l=Se(`
          messaged you:
          `),c=$("span"),_=Se(u),p=B(),O(k.$$.fragment),g=B(),f&&f.c(),this.h()},l(d){e=y(d,"DIV",{class:!0});var m=x(e);t=y(m,"DIV",{class:!0});var T=x(t);s=y(T,"P",{tabindex:!0,class:!0});var I=x(s);r=y(I,"SPAN",{class:!0});var A=x(r);o=Ie(A,n),A.forEach(b),l=Ie(I,`
          messaged you:
          `),c=y(I,"SPAN",{class:!0});var D=x(c);_=Ie(D,u),D.forEach(b),I.forEach(b),p=N(T),q(k.$$.fragment,T),T.forEach(b),g=N(m),f&&f.l(m),m.forEach(b),this.h()},h(){h(r,"class","text-indigo-700"),h(c,"class","italic leading-5"),h(s,"tabindex","0"),h(s,"class","focus:outline-none text-sm leading-none text-gray-600"),h(t,"class","flex items-center justify-between w-full"),h(e,"class","pl-3 w-full")},m(d,m){P(d,e,m),w(e,t),w(t,s),w(s,r),w(r,o),w(s,l),w(s,c),w(c,_),w(t,p),V(k,t,null),w(e,g),f&&f.m(e,null),v=!0},p(d,m){(!v||m&4)&&n!==(n=(d[2].from_user||(d[2].type==="system_message"?"system":""))+"")&&ze(o,n),(!v||m&4)&&u!==(u=(d[2].contents||"")+"")&&ze(_,u);const T={};m&5&&(T.onClick=d[3]),k.$set(T),d[2].created_at?f?f.p(d,m):(f=Wt(d),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},i(d){v||(E(k.$$.fragment,d),v=!0)},o(d){S(k.$$.fragment,d),v=!1},d(d){d&&b(e),j(k),f&&f.d()}}}function Wt(i){let e,t=It(i[2].created_at)+"",s;return{c(){e=$("p"),s=Se(t),this.h()},l(r){e=y(r,"P",{class:!0});var n=x(e);s=Ie(n,t),n.forEach(b),this.h()},h(){h(e,"class","focus:outline-none text-xs leading-3 pt-1 text-gray-500")},m(r,n){P(r,e,n),w(e,s)},p(r,n){n&4&&t!==(t=It(r[2].created_at)+"")&&ze(s,t)},d(r){r&&b(e)}}}function hi(i){let e,t,s,r,n,o,l,c,u,_,p=!i[2].read&&Gt();r=new ni({});const k=[di,ci],g=[];function v(f,d){return f[2].type==="user_message"||f[2].type==="system_message"?0:1}return o=v(i),l=g[o]=k[o](i),{c(){e=$("div"),p&&p.c(),t=B(),s=$("div"),O(r.$$.fragment),n=B(),l.c(),this.h()},l(f){e=y(f,"DIV",{class:!0});var d=x(e);p&&p.l(d),t=N(d),s=y(d,"DIV",{tabindex:!0,"aria-label":!0,role:!0,class:!0});var m=x(s);q(r.$$.fragment,m),m.forEach(b),n=N(d),l.l(d),d.forEach(b),this.h()},h(){h(s,"tabindex","0"),h(s,"aria-label","group icon"),h(s,"role","img"),h(s,"class","focus:outline-none w-8 h-8 border rounded-full border-gray-200 flex flex-shrink-0 items-center justify-center"),h(e,"class","w-full p-3 mt-4 bg-white rounded shadow flex flex-shrink-0 cursor-pointer relative")},m(f,d){P(f,e,d),p&&p.m(e,null),w(e,t),w(e,s),V(r,s,null),w(e,n),g[o].m(e,null),c=!0,u||(_=F(e,"click",ms(i[4])),u=!0)},p(f,[d]){f[2].read?p&&(p.d(1),p=null):p||(p=Gt(),p.c(),p.m(e,t));let m=o;o=v(f),o===m?g[o].p(f,d):(X(),S(g[m],1,1,()=>{g[m]=null}),Y(),l=g[o],l?l.p(f,d):(l=g[o]=k[o](f),l.c()),E(l,1),l.m(e,null))},i(f){c||(E(r.$$.fragment,f),E(l),c=!0)},o(f){S(r.$$.fragment,f),S(l),c=!1},d(f){f&&b(e),p&&p.d(),j(r),g[o].d(),u=!1,_()}}}function _i(i,e,t){let{delete_notif:s}=e,{read_notif:r}=e,{nmsg:n}=e;const o=()=>{s(n.id)},l=()=>{n.read||r(n.id)};return i.$$set=c=>{"delete_notif"in c&&t(0,s=c.delete_notif),"read_notif"in c&&t(1,r=c.read_notif),"nmsg"in c&&t(2,n=c.nmsg)},[s,r,n,o,l]}class fi extends de{constructor(e){super(),he(this,e,_i,hi,ne,{delete_notif:0,read_notif:1,nmsg:2})}}function pi(i){let e,t,s,r,n,o;return{c(){e=$("div"),t=re("svg"),s=re("path"),r=B(),n=$("div"),o=Se(i[0]),this.h()},l(l){e=y(l,"DIV",{class:!0});var c=x(e);t=ie(c,"svg",{fill:!0,class:!0,viewBox:!0,xmlns:!0});var u=x(t);s=ie(u,"path",{"clip-rule":!0,d:!0,fill:!0,"fill-rule":!0}),x(s).forEach(b),u.forEach(b),r=N(c),n=y(c,"DIV",{});var _=x(n);o=Ie(_,i[0]),_.forEach(b),c.forEach(b),this.h()},h(){h(s,"clip-rule","evenodd"),h(s,"d","M15.165 8.53a.5.5 0 01-.404.58A7 7 0 1023 16a.5.5 0 011 0 8 8 0 11-9.416-7.874.5.5 0 01.58.404z"),h(s,"fill","currentColor"),h(s,"fill-rule","evenodd"),h(t,"fill","none"),h(t,"class","w-20 h-20 animate-spin"),h(t,"viewBox","0 0 32 32"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class","flex justify-center items-center space-x-1 text-lg text-gray-700")},m(l,c){P(l,e,c),w(e,t),w(t,s),w(e,r),w(e,n),w(n,o)},p(l,[c]){c&1&&ze(o,l[0])},i:H,o:H,d(l){l&&b(e)}}}function gi(i,e,t){let{text:s="Processing"}=e;return i.$$set=r=>{"text"in r&&t(0,s=r.text)},[s]}class mi extends de{constructor(e){super(),he(this,e,gi,pi,ne,{text:0})}}const Jt=["Existance is lie :|","power of myth and postmodern man","Existance is overrated","glory to gorzo","Universe goes towards higher etropy","Chaos is only natural"];function Kt(i,e,t){const s=i.slice();return s[9]=e[t],s}function bi(i){let e,t,s=Ae(i[1]),r=[];for(let o=0;o<s.length;o+=1)r[o]=Zt(Kt(i,s,o));const n=o=>S(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=xe()},l(o){for(let l=0;l<r.length;l+=1)r[l].l(o);e=xe()},m(o,l){for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(o,l);P(o,e,l),t=!0},p(o,l){if(l&50){s=Ae(o[1]);let c;for(c=0;c<s.length;c+=1){const u=Kt(o,s,c);r[c]?(r[c].p(u,l),E(r[c],1)):(r[c]=Zt(u),r[c].c(),E(r[c],1),r[c].m(e.parentNode,e))}for(X(),c=s.length;c<r.length;c+=1)n(c);Y()}},i(o){if(!t){for(let l=0;l<s.length;l+=1)E(r[l]);t=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)S(r[l]);t=!1},d(o){o&&b(e),Fe(r,o)}}}function wi(i){let e,t;return e=new mi({props:{text:"loading"}}),{c(){O(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,r){V(e,s,r),t=!0},p:H,i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Zt(i){let e,t;return e=new fi({props:{nmsg:i[9],delete_notif:i[5],read_notif:i[4]}}),{c(){O(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,r){V(e,s,r),t=!0},p(s,r){const n={};r&2&&(n.nmsg=s[9]),e.$set(n)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function vi(i){let e,t,s,r="Notifications",n,o,l,c='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400" viewBox="0 0 20 20" fill="currentColor"><path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path><path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path></svg>',u,_,p='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"></path></svg>',k,g,v='<svg class="h-6 w-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18 6L6 18" stroke="#4B5563" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6 6L18 18" stroke="#4B5563" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"></path></svg>',f,d,m,T,I,A,D,W="Explore",z,J,oe,U,ee,le=Jt[Math.floor(Math.random()*Jt.length)]+"",Le,me,C,_e,Te,ue;const fe=[wi,bi],R=[];function Me(K,Z){return K[0]?0:1}return m=Me(i),T=R[m]=fe[m](i),{c(){e=$("div"),t=$("div"),s=$("p"),s.textContent=r,n=B(),o=$("div"),l=$("button"),l.innerHTML=c,u=B(),_=$("button"),_.innerHTML=p,k=B(),g=$("button"),g.innerHTML=v,f=B(),d=$("div"),T.c(),I=B(),A=$("div"),D=$("button"),D.textContent=W,z=B(),J=$("div"),oe=$("hr"),U=B(),ee=$("p"),Le=Se(le),me=B(),C=$("hr"),this.h()},l(K){e=y(K,"DIV",{class:!0});var Z=x(e);t=y(Z,"DIV",{class:!0});var be=x(t);s=y(be,"P",{class:!0,"data-svelte-h":!0}),ae(s)!=="svelte-18ha4pw"&&(s.textContent=r),n=N(be),o=y(be,"DIV",{});var ke=x(o);l=y(ke,"BUTTON",{"aria-label":!0,class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1lnb8v1"&&(l.innerHTML=c),u=N(ke),_=y(ke,"BUTTON",{"aria-label":!0,class:!0,"data-svelte-h":!0}),ae(_)!=="svelte-1dofkhm"&&(_.innerHTML=p),k=N(ke),g=y(ke,"BUTTON",{"aria-label":!0,class:!0,"data-svelte-h":!0}),ae(g)!=="svelte-hjvzob"&&(g.innerHTML=v),ke.forEach(b),be.forEach(b),f=N(Z),d=y(Z,"DIV",{});var we=x(d);T.l(we),we.forEach(b),I=N(Z),A=y(Z,"DIV",{class:!0});var $e=x(A);D=y($e,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(D)!=="svelte-qjbpfs"&&(D.textContent=W),$e.forEach(b),z=N(Z),J=y(Z,"DIV",{class:!0});var Ee=x(J);oe=y(Ee,"HR",{class:!0}),U=N(Ee),ee=y(Ee,"P",{class:!0});var De=x(ee);Le=Ie(De,le),De.forEach(b),me=N(Ee),C=y(Ee,"HR",{class:!0}),Ee.forEach(b),Z.forEach(b),this.h()},h(){h(s,"class","focus:outline-none text-2xl font-semibold leading-6 text-gray-800"),h(l,"aria-label","mark all message as read"),h(l,"class","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 rounded-md cursor-pointer"),h(_,"aria-label","refresh"),h(_,"class","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 rounded-md cursor-pointer mx-5"),h(g,"aria-label","close notification modal"),h(g,"class","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 rounded-md cursor-pointer"),h(t,"class","flex items-center justify-between"),h(D,"class","underline variant-filled"),h(A,"class","flex justify-end mt-10"),h(oe,"class","w-full"),h(ee,"class","focus:outline-none text-sm flex flex-shrink-0 leading-normal px-3 py-16 text-gray-500"),h(C,"class","w-full"),h(J,"class","flex items-center justiyf-between"),h(e,"class","p-8")},m(K,Z){P(K,e,Z),w(e,t),w(t,s),w(t,n),w(t,o),w(o,l),w(o,u),w(o,_),w(o,k),w(o,g),w(e,f),w(e,d),R[m].m(d,null),w(e,I),w(e,A),w(A,D),w(e,z),w(e,J),w(J,oe),w(J,U),w(J,ee),w(ee,Le),w(J,me),w(J,C),_e=!0,Te||(ue=[F(_,"click",i[2]),F(g,"click",i[3]),F(D,"click",i[6])],Te=!0)},p(K,[Z]){let be=m;m=Me(K),m===be?R[m].p(K,Z):(X(),S(R[be],1,1,()=>{R[be]=null}),Y(),T=R[m],T?T.p(K,Z):(T=R[m]=fe[m](K),T.c()),E(T,1),T.m(d,null))},i(K){_e||(E(T),_e=!0)},o(K){S(T),_e=!1},d(K){K&&b(e),R[m].d(),Te=!1,Ke(ue)}}}function ki(i,e,t){let s,{loading:r=!0}=e,{messages:n=[]}=e;const o=dt(),l=()=>o("refresh"),c=()=>o("toggle_npanel"),u=k=>o("nread",k),_=k=>o("ndelete",k),p=()=>o("explore_noti");return i.$$set=k=>{"loading"in k&&t(0,r=k.loading),"messages"in k&&t(7,n=k.messages)},i.$$.update=()=>{i.$$.dirty&128&&t(1,s=n.sort((k,g)=>k.id-g.id))},[r,s,l,c,u,_,p,n]}class $i extends de{constructor(e){super(),he(this,e,ki,vi,ne,{loading:0,messages:7})}}function Qt(i){let e,t,s='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path></svg>',r,n,o,l,c,u;const _=[i[3]];var p=i[2];function k(g,v){let f={};if(v!==void 0&&v&8)f=nt(_,[ot(g[3])]);else for(let d=0;d<_.length;d+=1)f=it(f,_[d]);return{props:f}}return p&&(o=Ne(p,k(i))),{c(){e=$("modal-big-wrapper"),t=$("div"),t.innerHTML=s,r=B(),n=$("div"),o&&O(o.$$.fragment),this.h()},l(g){e=y(g,"MODAL-BIG-WRAPPER",{class:!0});var v=x(e);t=y(v,"DIV",{class:!0,"data-svelte-h":!0}),ae(t)!=="svelte-18k472"&&(t.innerHTML=s),r=N(v),n=y(v,"DIV",{class:!0});var f=x(n);o&&q(o.$$.fragment,f),f.forEach(b),v.forEach(b),this.h()},h(){h(t,"class","modal-close absolute top-0 right-0 cursor-pointer flex flex-col items-center mt-4 mr-4 bg-white rounded-lg border-4 z-50"),h(n,"class","sm:w-3/4 lg:w-1/2 3xl:w-1/3 modal-big-section svelte-agotx6"),ct(e,"class","svelte-agotx6")},m(g,v){P(g,e,v),w(e,t),w(e,r),w(e,n),o&&V(o,n,null),l=!0,c||(u=F(t,"click",i[0]),c=!0)},p(g,v){if(v&4&&p!==(p=g[2])){if(o){X();const f=o;S(f.$$.fragment,1,0,()=>{j(f,1)}),Y()}p?(o=Ne(p,k(g,v)),O(o.$$.fragment),E(o.$$.fragment,1),V(o,n,null)):o=null}else if(p){const f=v&8?nt(_,[ot(g[3])]):{};o.$set(f)}},i(g){l||(o&&E(o.$$.fragment,g),l=!0)},o(g){o&&S(o.$$.fragment,g),l=!1},d(g){g&&b(e),o&&j(o),c=!1,u()}}}function Xt(i){let e,t,s=i[7]&&i[2]&&Qt(i);return{c(){s&&s.c(),e=xe()},l(r){s&&s.l(r),e=xe()},m(r,n){s&&s.m(r,n),P(r,e,n),t=!0},p(r,n){r[7]&&r[2]?s?(s.p(r,n),n&132&&E(s,1)):(s=Qt(r),s.c(),E(s,1),s.m(e.parentNode,e)):s&&(X(),S(s,1,1,()=>{s=null}),Y())},i(r){t||(E(s),t=!0)},o(r){S(s),t=!1},d(r){r&&b(e),s&&s.d(r)}}}function Yt(i){let e,t,s='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path></svg>',r,n,o,l,c,u;const _=[i[5]];var p=i[4];function k(g,v){let f={};if(v!==void 0&&v&32)f=nt(_,[ot(g[5])]);else for(let d=0;d<_.length;d+=1)f=it(f,_[d]);return{props:f}}return p&&(o=Ne(p,k(i))),{c(){e=$("modal-small-wrapper"),t=$("div"),t.innerHTML=s,r=B(),n=$("modal-small-section"),o&&O(o.$$.fragment),this.h()},l(g){e=y(g,"MODAL-SMALL-WRAPPER",{class:!0});var v=x(e);t=y(v,"DIV",{class:!0,"data-svelte-h":!0}),ae(t)!=="svelte-ho3e6v"&&(t.innerHTML=s),r=N(v),n=y(v,"MODAL-SMALL-SECTION",{class:!0});var f=x(n);o&&q(o.$$.fragment,f),f.forEach(b),v.forEach(b),this.h()},h(){h(t,"class","modal-close absolute top-0 right-0 cursor-pointer flex flex-col items-center mt-4 mr-4 bg-white rounded-lg border-4 z-50"),ct(n,"class","svelte-agotx6"),ct(e,"class","svelte-agotx6")},m(g,v){P(g,e,v),w(e,t),w(e,r),w(e,n),o&&V(o,n,null),l=!0,c||(u=F(t,"click",i[1]),c=!0)},p(g,v){if(v&16&&p!==(p=g[4])){if(o){X();const f=o;S(f.$$.fragment,1,0,()=>{j(f,1)}),Y()}p?(o=Ne(p,k(g,v)),O(o.$$.fragment),E(o.$$.fragment,1),V(o,n,null)):o=null}else if(p){const f=v&32?nt(_,[ot(g[5])]):{};o.$set(f)}},i(g){l||(o&&E(o.$$.fragment,g),l=!0)},o(g){o&&S(o.$$.fragment,g),l=!1},d(g){g&&b(e),o&&j(o),c=!1,u()}}}function es(i){let e,t,s=i[6]&&i[4]&&Yt(i);return{c(){s&&s.c(),e=xe()},l(r){s&&s.l(r),e=xe()},m(r,n){s&&s.m(r,n),P(r,e,n),t=!0},p(r,n){r[6]&&r[4]?s?(s.p(r,n),n&80&&E(s,1)):(s=Yt(r),s.c(),E(s,1),s.m(e.parentNode,e)):s&&(X(),S(s,1,1,()=>{s=null}),Y())},i(r){t||(E(s),t=!0)},o(r){S(s),t=!1},d(r){r&&b(e),s&&s.d(r)}}}function yi(i){let e=i[7],t,s=i[6],r,n,o=Xt(i),l=es(i);const c=i[11].default,u=qe(c,i,i[10],null);return{c(){o.c(),t=B(),l.c(),r=B(),u&&u.c()},l(_){o.l(_),t=N(_),l.l(_),r=N(_),u&&u.l(_)},m(_,p){o.m(_,p),P(_,t,p),l.m(_,p),P(_,r,p),u&&u.m(_,p),n=!0},p(_,[p]){p&128&&ne(e,e=_[7])?(X(),S(o,1,1,H),Y(),o=Xt(_),o.c(),E(o,1),o.m(t.parentNode,t)):o.p(_,p),p&64&&ne(s,s=_[6])?(X(),S(l,1,1,H),Y(),l=es(_),l.c(),E(l,1),l.m(r.parentNode,r)):l.p(_,p),u&&u.p&&(!n||p&1024)&&Ge(u,c,_,_[10],n?Je(c,_[10],p,null):We(_[10]),null)},i(_){n||(E(o),E(l),E(u,_),n=!0)},o(_){S(o),S(l),S(u,_),n=!1},d(_){_&&(b(t),b(r)),o.d(_),l.d(_),u&&u.d(_)}}}function Ei(i,e,t){let s,r,{$$slots:n={},$$scope:o}=e,l,c={},u,_={};const p=(f,d)=>{t(2,l=f),t(3,c=d),t(7,s=!0)},k=()=>{t(7,s=!1),t(2,l=null)},g=(f,d)=>{t(4,u=f),t(5,_=d),t(6,r=!0)},v=()=>{t(6,r=!1),t(4,u=null)};return i.$$set=f=>{"$$scope"in f&&t(10,o=f.$$scope)},t(7,s=!0),t(6,r=!0),[k,v,l,c,u,_,r,s,p,g,o,n]}class xi extends de{constructor(e){super(),he(this,e,Ei,yi,ne,{show_big:8,close_big:0,show_small:9,close_small:1})}get show_big(){return this.$$.ctx[8]}get close_big(){return this.$$.ctx[0]}get show_small(){return this.$$.ctx[9]}get close_small(){return this.$$.ctx[1]}}function Li(i){let e,t;return e=new $i({props:{loading:i[6].loading,messages:i[6].messages}}),e.$on("ndelete",i[17]),e.$on("nread",i[18]),e.$on("refresh",i[19]),e.$on("toggle_npanel",i[11]),e.$on("explore_noti",i[20]),{c(){O(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,r){V(e,s,r),t=!0},p(s,r){const n={};r&64&&(n.loading=s[6].loading),r&64&&(n.messages=s[6].messages),e.$set(n)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Ti(i){let e;const t=i[12].default,s=qe(t,i,i[24],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&16777216)&&Ge(s,t,r,r[24],e?Je(t,r[24],n,null):We(r[24]),null)},i(r){e||(E(s,r),e=!0)},o(r){S(s,r),e=!1},d(r){s&&s.d(r)}}}function Si(i){let e,t,s,r,n,o,l,c,u,_;function p(d){i[13](d)}function k(d){i[14](d)}function g(d){i[15](d)}function v(d){i[16](d)}let f={};return i[2]!==void 0&&(f.show_big=i[2]),i[4]!==void 0&&(f.show_small=i[4]),i[3]!==void 0&&(f.close_big=i[3]),i[5]!==void 0&&(f.close_small=i[5]),e=new xi({props:f}),Ve.push(()=>st(e,"show_big",p)),Ve.push(()=>st(e,"show_small",k)),Ve.push(()=>st(e,"close_big",g)),Ve.push(()=>st(e,"close_small",v)),l=new Os({props:{$$slots:{default:[Li]},$$scope:{ctx:i}}}),u=new ii({props:{launcher:i[0],pending_notification:i[7],$$slots:{default:[Ti]},$$scope:{ctx:i}}}),u.$on("logout",i[21]),u.$on("notification_toggle",i[11]),u.$on("open_executors",i[22]),u.$on("self_profile",i[23]),{c(){O(e.$$.fragment),o=B(),O(l.$$.fragment),c=B(),O(u.$$.fragment)},l(d){q(e.$$.fragment,d),o=N(d),q(l.$$.fragment,d),c=N(d),q(u.$$.fragment,d)},m(d,m){V(e,d,m),P(d,o,m),V(l,d,m),P(d,c,m),V(u,d,m),_=!0},p(d,[m]){const T={};!t&&m&4&&(t=!0,T.show_big=d[2],tt(()=>t=!1)),!s&&m&16&&(s=!0,T.show_small=d[4],tt(()=>s=!1)),!r&&m&8&&(r=!0,T.close_big=d[3],tt(()=>r=!1)),!n&&m&32&&(n=!0,T.close_small=d[5],tt(()=>n=!1)),e.$set(T);const I={};m&16777282&&(I.$$scope={dirty:m,ctx:d}),l.$set(I);const A={};m&1&&(A.launcher=d[0]),m&128&&(A.pending_notification=d[7]),m&16777216&&(A.$$scope={dirty:m,ctx:d}),u.$set(A)},i(d){_||(E(e.$$.fragment,d),E(l.$$.fragment,d),E(u.$$.fragment,d),_=!0)},o(d){S(e.$$.fragment,d),S(l.$$.fragment,d),S(u.$$.fragment,d),_=!1},d(d){d&&(b(o),b(c)),j(e,d),j(l,d),j(u,d)}}}function Ii(i,e,t){let s,r,n,{$$slots:o={},$$scope:l}=e,{launcher:c}=e,{app:u}=e;const _=ns();je(i,_,C=>t(25,s=C));const p=u.notifier.is_pending_read;je(i,p,C=>t(7,n=C));const k=u.notifier.state;je(i,k,C=>t(6,r=C));const g=C=>{},v=C=>{};let f,d,m,T;const I=()=>{s.open?_.close():_.open({id:"notification",bgDrawer:"bg-purple-200 text-white",position:"left",width:"w-full md:w-[480px]",padding:"p-2",rounded:"rounded-xl"})};ss(()=>{u.inject({toast_success:g,toast_error:v,big_modal_open:f,big_modal_close:d,small_modal_open:m,small_modal_close:T,notification_toggle:I})}),bs("__app__",u);function A(C){f=C,t(2,f)}function D(C){m=C,t(4,m)}function W(C){d=C,t(3,d)}function z(C){T=C,t(5,T)}const J=C=>u.notifier.delete_message(C.detail),oe=C=>u.notifier.read_message(C.detail),U=()=>u.notifier.init(),ee=()=>u.nav.notifications(),le=()=>u.logout(),Le=()=>u.nav.launcher(),me=()=>u.nav.self_profile();return i.$$set=C=>{"launcher"in C&&t(0,c=C.launcher),"app"in C&&t(1,u=C.app),"$$scope"in C&&t(24,l=C.$$scope)},[c,u,f,d,m,T,r,n,_,p,k,I,o,A,D,W,z,J,oe,U,ee,le,Le,me,l]}class Ai extends de{constructor(e){super(),he(this,e,Ii,Si,ne,{launcher:0,app:1})}}function Di(i){let e,t;return e=new Ai({props:{launcher:i[2].launcher,app:i[2],$$slots:{default:[Bi]},$$scope:{ctx:i}}}),{c(){O(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,r){V(e,s,r),t=!0},p(s,r){const n={};r&4&&(n.launcher=s[2].launcher),r&4&&(n.app=s[2]),r&16&&(n.$$scope={dirty:r,ctx:s}),e.$set(n)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Mi(i){let e,t;return e=new Pr({}),{c(){O(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,r){V(e,s,r),t=!0},p:H,i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Ci(i){let e,t;return e=new as({}),{c(){O(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,r){V(e,s,r),t=!0},p:H,i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){S(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Bi(i){let e;const t=i[3].default,s=qe(t,i,i[4],null);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,n){s&&s.m(r,n),e=!0},p(r,n){s&&s.p&&(!e||n&16)&&Ge(s,t,r,r[4],e?Je(t,r[4],n,null):We(r[4]),null)},i(r){e||(E(s,r),e=!0)},o(r){S(s,r),e=!1},d(r){s&&s.d(r)}}}function Ni(i){let e,t,s,r;const n=[Ci,Mi,Di],o=[];function l(c,u){return c[0]?0:c[1]?2:1}return e=l(i),t=o[e]=n[e](i),{c(){t.c(),s=xe()},l(c){t.l(c),s=xe()},m(c,u){o[e].m(c,u),P(c,s,u),r=!0},p(c,[u]){let _=e;e=l(c),e===_?o[e].p(c,u):(X(),S(o[_],1,1,()=>{o[_]=null}),Y(),t=o[e],t?t.p(c,u):(t=o[e]=n[e](c),t.c()),E(t,1),t.m(s.parentNode,s))},i(c){r||(E(t),r=!0)},o(c){S(t),r=!1},d(c){c&&b(s),o[e].d(c)}}}function Pi(i,e,t){let{$$slots:s={},$$scope:r}=e,n=!0,o=!0,l;return(async()=>{const u=new is;u.isLogged()||(t(1,o=!1),t(0,n=!1));const _=u.getAuthedData();t(2,l=new Cr({base_url:rs(),registry:window.__registry__,site_utils:u,tenant_id:_.tenant_id,user_token:_.user_token})),await l.init(),t(0,n=!1)})(),ss(()=>{window.onunhandledrejection=u=>{console.log("we got exception, but the app has crashed",u),u.preventDefault()}}),i.$$set=u=>{"$$scope"in u&&t(4,r=u.$$scope)},[n,o,l,s,r]}class oa extends de{constructor(e){super(),he(this,e,Pi,Ni,ne,{})}}export{oa as component};
