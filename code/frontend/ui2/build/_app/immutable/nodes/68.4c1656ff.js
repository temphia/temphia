import{s as u,B as k,P as X}from"../chunks/scheduler.e2ee220a.js";import{S as A,i as x,b,d as I,m as P,a as h,t as C,e as L}from"../chunks/index.4aee2103.js";import{A as N}from"../chunks/auto_form.ee101f61.js";import"../chunks/paths.555c70f8.js";import"../chunks/loading_spinner.svelte_svelte_type_style_lang.9f9ec163.js";import{p as Y}from"../chunks/index.37ddda1f.js";import{d as T,T as f,a as g,c}from"../chunks/target.d267d535.js";function w(n){let t,m;return t=new N({props:{message:n[2],schema:{fields:[{name:"Name",ftype:"TEXT",key_name:"name"},{name:"Target Type",ftype:"TEXT",key_name:"target_type",disabled:!!n[0],options:[T,f,g,c]},{name:"Target",ftype:"TEXT",key_name:"target",disabled:!!n[1]},{name:"Context Type",ftype:"TEXT",key_name:"context_type"},{name:"Policy",ftype:"TEXT_POLICY",key_name:"policy"},{name:"Plug Id",ftype:"TEXT",key_name:"plug_id"},{name:"Agent Id",ftype:"TEXT",key_name:"agent_id"},{name:"Exec Domain",ftype:"INT",key_name:"exec_domain"},{name:"Exec Meta",ftype:"KEY_VALUE_TEXT",key_name:"exec_meta"},{name:"Extra Meta",ftype:"KEY_VALUE_TEXT",key_name:"extra_meta"}],name:"New Target App",required_fields:[]},onSave:n[4],data:n[3]}}),{c(){b(t.$$.fragment)},l(e){I(t.$$.fragment,e)},m(e,a){P(t,e,a),m=!0},p(e,[a]){const p={};a&4&&(p.message=e[2]),a&3&&(p.schema={fields:[{name:"Name",ftype:"TEXT",key_name:"name"},{name:"Target Type",ftype:"TEXT",key_name:"target_type",disabled:!!e[0],options:[T,f,g,c]},{name:"Target",ftype:"TEXT",key_name:"target",disabled:!!e[1]},{name:"Context Type",ftype:"TEXT",key_name:"context_type"},{name:"Policy",ftype:"TEXT_POLICY",key_name:"policy"},{name:"Plug Id",ftype:"TEXT",key_name:"plug_id"},{name:"Agent Id",ftype:"TEXT",key_name:"agent_id"},{name:"Exec Domain",ftype:"INT",key_name:"exec_domain"},{name:"Exec Meta",ftype:"KEY_VALUE_TEXT",key_name:"exec_meta"},{name:"Extra Meta",ftype:"KEY_VALUE_TEXT",key_name:"extra_meta"}],name:"New Target App",required_fields:[]}),a&8&&(p.data=e[3]),t.$set(p)},i(e){m||(h(t.$$.fragment,e),m=!0)},o(e){C(t.$$.fragment,e),m=!1},d(e){L(t,e)}}}function D(n,t,m){let e;k(n,Y,r=>m(5,e=r));let{ttype:a=e.ttype}=t,{target:p=e.target}=t;const _=X("__app__"),d=_.api_manager.get_admin_target_api();let s="",o={};a&&(o.target_type=a),p&&(o.target=p);const y=_.nav.options;y&&(o={...y});const E=async r=>{const l=r.target_type||o.target_type,i=await d.newApp(l,{...o,...r});if(!i.ok){m(2,s=i.data);return}_.nav.admin_target_apps()};return n.$$set=r=>{"ttype"in r&&m(0,a=r.ttype),"target"in r&&m(1,p=r.target)},[a,p,s,o,E]}class W extends A{constructor(t){super(),x(this,t,D,w,u,{ttype:0,target:1})}}export{W as component};
