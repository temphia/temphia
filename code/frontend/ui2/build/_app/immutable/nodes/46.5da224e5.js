import{s as N,e as P,i as F,d as C,A as D,a as z,c as G,B as H,P as J}from"../chunks/scheduler.e2ee220a.js";import{S as L,i as S,g as T,t as m,c as q,a as p,b as g,d as k,m as b,e as y}from"../chunks/index.4aee2103.js";import"../chunks/paths.555c70f8.js";import{F as K}from"../chunks/floating_add.1495f8dc.js";import"../chunks/loading_spinner.svelte_svelte_type_style_lang.9f9ec163.js";import{A as M}from"../chunks/autotable.0057460b.js";import{L as B}from"../chunks/loading_spinner.4ceee987.js";import{p as O}from"../chunks/index.37ddda1f.js";import{A as E}from"../chunks/action_picker.7081fe98.js";function Q(c){let e,n;return e=new E({props:{actions:c[2].map(c[10]),title:"Pick Agent"}}),{c(){g(e.$$.fragment)},l(t){k(e.$$.fragment,t)},m(t,a){b(e,t,a),n=!0},p(t,a){const o={};a&4&&(o.actions=t[2].map(t[10])),e.$set(o)},i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){y(e,t)}}}function R(c){let e,n;return e=new E({props:{actions:c[1].map(c[9]),title:"Pick Plug"}}),{c(){g(e.$$.fragment)},l(t){k(e.$$.fragment,t)},m(t,a){b(e,t,a),n=!0},p(t,a){const o={};a&2&&(o.actions=t[1].map(t[9])),e.$set(o)},i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){y(e,t)}}}function U(c){let e,n;return e=new B({props:{classes:""}}),{c(){g(e.$$.fragment)},l(t){k(e.$$.fragment,t)},m(t,a){b(e,t,a),n=!0},p:D,i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){y(e,t)}}}function V(c){let e,n,t,a;const o=[U,R,Q],s=[];function _(r,i){return r[0]?0:r[3]==="pick_plug"?1:r[3]==="pick_agent"?2:-1}return~(e=_(c))&&(n=s[e]=o[e](c)),{c(){n&&n.c(),t=P()},l(r){n&&n.l(r),t=P()},m(r,i){~e&&s[e].m(r,i),F(r,t,i),a=!0},p(r,[i]){let f=e;e=_(r),e===f?~e&&s[e].p(r,i):(n&&(T(),m(s[f],1,1,()=>{s[f]=null}),q()),~e?(n=s[e],n?n.p(r,i):(n=s[e]=o[e](r),n.c()),p(n,1),n.m(t.parentNode,t)):n=null)},i(r){a||(p(n),a=!0)},o(r){m(n),a=!1},d(r){r&&C(t),~e&&s[e].d(r)}}}function W(c,e,n){let{service:t}=e,{pid:a}=e,{aid:o}=e,s=!0,_="",r="",i=[],f=[],d="pick_plug";const A=async()=>{const h=await t.api_manager.get_admin_plug_api().list_plug();h.ok&&(n(1,i=h.data),n(0,s=!1))},w=async l=>{n(0,s=!0),n(3,d="pick_agent"),_=l.data.id;const $=await t.api_manager.get_admin_plug_api().list_agent(_);$.ok&&(n(2,f=$.data),n(0,s=!1))},u=async l=>{n(0,s=!0),r=l.data.id,t.nav.admin_agent_link_new(a,o,{to_agent_id:r,to_plug_id:_}),t.utils.small_modal_close()};A();const I=l=>({action:w,icon:"hashtag",info:l.name,name:l.id,data:l}),j=l=>({action:u,icon:"hashtag",info:l.name,name:l.id,data:l});return c.$$set=l=>{"service"in l&&n(6,t=l.service),"pid"in l&&n(7,a=l.pid),"aid"in l&&n(8,o=l.aid)},[s,i,f,d,w,u,t,a,o,I,j]}class X extends L{constructor(e){super(),S(this,e,W,V,N,{service:6,pid:7,aid:8})}}function Y(c){let e,n;return e=new M({props:{action_key:"id",actions:[{Name:"Edit",Action:c[2],drop:!0,icon:"trash"},{Name:"Delete",Action:c[3],drop:!0,icon:"trash"}],key_names:[["id","ID"],["name","Name"],["from_plug_id","From Plug"],["from_agent_id","From Agent"],["to_plug_id","To Plug"],["to_agent_id","To Agent"]],datas:c[0]}}),{c(){g(e.$$.fragment)},l(t){k(e.$$.fragment,t)},m(t,a){b(e,t,a),n=!0},p(t,a){const o={};a&1&&(o.datas=t[0]),e.$set(o)},i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){y(e,t)}}}function Z(c){let e,n;return e=new B({}),{c(){g(e.$$.fragment)},l(t){k(e.$$.fragment,t)},m(t,a){b(e,t,a),n=!0},p:D,i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){m(e.$$.fragment,t),n=!1},d(t){y(e,t)}}}function v(c){let e,n,t,a,o;const s=[Z,Y],_=[];function r(i,f){return i[1]?0:1}return e=r(c),n=_[e]=s[e](c),a=new K({props:{onClick:c[4]}}),{c(){n.c(),t=z(),g(a.$$.fragment)},l(i){n.l(i),t=G(i),k(a.$$.fragment,i)},m(i,f){_[e].m(i,f),F(i,t,f),b(a,i,f),o=!0},p(i,[f]){let d=e;e=r(i),e===d?_[e].p(i,f):(T(),m(_[d],1,1,()=>{_[d]=null}),q(),n=_[e],n?n.p(i,f):(n=_[e]=s[e](i),n.c()),p(n,1),n.m(t.parentNode,t))},i(i){o||(p(n),p(a.$$.fragment,i),o=!0)},o(i){m(n),m(a.$$.fragment,i),o=!1},d(i){i&&C(t),_[e].d(i),y(a,i)}}}function x(c,e,n){let t;H(c,O,u=>n(7,t=u));let{pid:a=t.pid}=e,{aid:o=t.aid}=e,s=[],_=!0;const r=J("__app__"),i=r.api_manager.get_admin_plug_api(),f=async()=>{const u=await i.list_agent_link(a,o);u.ok&&(n(0,s=u.data),n(1,_=!1))};f();const d=u=>{},A=async u=>{await i.delete_agent_link(a,o,u),f()},w=()=>{r.utils.small_modal_open(X,{service:r,pid:a,aid:o})};return c.$$set=u=>{"pid"in u&&n(5,a=u.pid),"aid"in u&&n(6,o=u.aid)},[s,_,d,A,w,a,o]}class le extends L{constructor(e){super(),S(this,e,x,v,N,{pid:5,aid:6})}}export{le as component};
