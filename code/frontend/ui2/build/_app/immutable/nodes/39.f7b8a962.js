import{s as H,e as G,i as C,d as b,f as x,g as k,C as A,j as v,A as y,a as j,h as D,c as U,w,D as I,J as X,l as K,m as Q,P as Z}from"../chunks/scheduler.e2ee220a.js";import{S as V,i as J,g as q,t as S,c as M,a as L,b as B,d as P,m as R,e as F}from"../chunks/index.4aee2103.js";import"../chunks/paths.555c70f8.js";import{F as ee}from"../chunks/floating_add.1495f8dc.js";import"../chunks/loading_spinner.svelte_svelte_type_style_lang.9f9ec163.js";import{A as te}from"../chunks/autotable.0057460b.js";import{L as z}from"../chunks/loading_spinner.4ceee987.js";function ne(r){let e,n='<h3 class="mb-2 text-2xl font-bold text-gray-800">Done</h3>';return{c(){e=x("div"),e.innerHTML=n,this.h()},l(t){e=k(t,"DIV",{class:!0,"data-svelte-h":!0}),A(e)!=="svelte-1r1jfrs"&&(e.innerHTML=n),this.h()},h(){v(e,"class","p-2 text-center overflow-y-auto")},m(t,l){C(t,e,l)},p:y,i:y,o:y,d(t){t&&b(e)}}}function le(r){let e,n,t="Export State",l,s,i="Do you want to export plug states ?",u,o,a,f="Ok",h,_,m="Cancel",g,T;return{c(){e=x("div"),n=x("h3"),n.textContent=t,l=j(),s=x("p"),s.textContent=i,u=j(),o=x("div"),a=x("button"),a.textContent=f,h=j(),_=x("button"),_.textContent=m,this.h()},l(E){e=k(E,"DIV",{class:!0});var N=D(e);n=k(N,"H3",{class:!0,"data-svelte-h":!0}),A(n)!=="svelte-1ss3mvb"&&(n.textContent=t),l=U(N),s=k(N,"P",{class:!0,"data-svelte-h":!0}),A(s)!=="svelte-ie6lge"&&(s.textContent=i),u=U(N),o=k(N,"DIV",{class:!0});var d=D(o);a=k(d,"BUTTON",{class:!0,"data-svelte-h":!0}),A(a)!=="svelte-1pgq4ab"&&(a.textContent=f),h=U(d),_=k(d,"BUTTON",{class:!0,"data-svelte-h":!0}),A(_)!=="svelte-k3hue6"&&(_.textContent=m),d.forEach(b),N.forEach(b),this.h()},h(){v(n,"class","mb-2 text-2xl font-bold text-gray-800"),v(s,"class","text-gray-500"),v(a,"class","py-2 px-4 inline-flex justify-center items-center gap-2 rounded-md border border-transparent font-semibold bg-blue-500 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all text-sm"),v(_,"class","py-2 px-4 inline-flex justify-center items-center gap-2 rounded-md border border-transparent font-semibold bg-red-500 text-white hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all text-sm"),v(o,"class","mt-6 flex justify-end gap-2"),v(e,"class","p-2 text-center overflow-y-auto")},m(E,N){C(E,e,N),w(e,n),w(e,l),w(e,s),w(e,u),w(e,o),w(o,a),w(o,h),w(o,_),g||(T=[I(a,"click",r[5]),I(_,"click",r[6])],g=!0)},p:y,i:y,o:y,d(E){E&&b(e),g=!1,X(T)}}}function oe(r){let e,n;return e=new z({props:{classes:""}}),{c(){B(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,l){R(e,t,l),n=!0},p:y,i(t){n||(L(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function ae(r){let e,n,t,l;const s=[oe,le,ne],i=[];function u(o,a){return o[1]?0:o[2]==="SELECT"?1:2}return e=u(r),n=i[e]=s[e](r),{c(){n.c(),t=G()},l(o){n.l(o),t=G()},m(o,a){i[e].m(o,a),C(o,t,a),l=!0},p(o,[a]){let f=e;e=u(o),e===f?i[e].p(o,a):(q(),S(i[f],1,1,()=>{i[f]=null}),M(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),L(n,1),n.m(t.parentNode,t))},i(o){l||(L(n),l=!0)},o(o){S(n),l=!1},d(o){o&&b(t),i[e].d(o)}}}function se(r,e,n){let{id:t}=e,{app:l}=e,s=!1,i="SELECT";const u=async()=>{n(1,s=!0);const h=await l.api_manager.get_admin_plug_api().export_plug_state(t);if(!h.ok)return;let _=document.createElement("a");document.body.appendChild(_);let m=h.data;typeof m=="object"&&(m=JSON.stringify(h.data,null,4));let g=window.URL.createObjectURL(new Blob([m]));_.href=g,_.download="plug_state.json",_.click(),window.URL.revokeObjectURL(g),n(2,i="RESULT"),n(1,s=!1)},o=()=>u(),a=()=>l.utils.small_modal_close();return r.$$set=f=>{"id"in f&&n(4,t=f.id),"app"in f&&n(0,l=f.app)},[l,s,i,u,t,o,a]}class re extends V{constructor(e){super(),J(this,e,se,ae,H,{id:4,app:0})}}function ie(r){let e,n="Done";return{c(){e=x("h3"),e.textContent=n,this.h()},l(t){e=k(t,"H3",{class:!0,"data-svelte-h":!0}),A(e)!=="svelte-ulkybn"&&(e.textContent=n),this.h()},h(){v(e,"class","mb-2 text-2xl font-bold text-gray-800 text-center")},m(t,l){C(t,e,l)},p:y,i:y,o:y,d(t){t&&b(e)}}}function ce(r){let e,n="Import State",t,l,s,i,u,o,a,f,h,_,m,g,T="Cancel",E,N,d=r[3]&&W(r);return{c(){e=x("h3"),e.textContent=n,t=j(),l=x("label"),s=K(`JSON file
      `),i=x("input"),u=j(),o=x("label"),a=K(`Clean Previous States
      `),f=x("input"),h=j(),_=x("div"),d&&d.c(),m=j(),g=x("button"),g.textContent=T,this.h()},l(p){e=k(p,"H3",{class:!0,"data-svelte-h":!0}),A(e)!=="svelte-19hxypx"&&(e.textContent=n),t=U(p),l=k(p,"LABEL",{});var c=D(l);s=Q(c,`JSON file
      `),i=k(c,"INPUT",{type:!0}),c.forEach(b),u=U(p),o=k(p,"LABEL",{});var $=D(o);a=Q($,`Clean Previous States
      `),f=k($,"INPUT",{type:!0}),$.forEach(b),h=U(p),_=k(p,"DIV",{class:!0});var O=D(_);d&&d.l(O),m=U(O),g=k(O,"BUTTON",{class:!0,"data-svelte-h":!0}),A(g)!=="svelte-k3hue6"&&(g.textContent=T),O.forEach(b),this.h()},h(){v(e,"class","mb-2 text-center text-2xl font-bold text-gray-800"),v(i,"type","file"),v(f,"type","checkbox"),v(g,"class","py-2 px-4 inline-flex justify-center items-center gap-2 rounded-md border border-transparent font-semibold bg-red-500 text-white hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all text-sm"),v(_,"class","mt-6 flex justify-end gap-2")},m(p,c){C(p,e,c),C(p,t,c),C(p,l,c),w(l,s),w(l,i),C(p,u,c),C(p,o,c),w(o,a),w(o,f),f.checked=r[2],C(p,h,c),C(p,_,c),d&&d.m(_,null),w(_,m),w(_,g),E||(N=[I(i,"change",r[7]),I(f,"change",r[8]),I(g,"click",r[9])],E=!0)},p(p,c){c&4&&(f.checked=p[2]),p[3]?d?d.p(p,c):(d=W(p),d.c(),d.m(_,m)):d&&(d.d(1),d=null)},i:y,o:y,d(p){p&&(b(e),b(t),b(l),b(u),b(o),b(h),b(_)),d&&d.d(),E=!1,X(N)}}}function ue(r){let e,n;return e=new z({props:{classes:""}}),{c(){B(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,l){R(e,t,l),n=!0},p:y,i(t){n||(L(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function W(r){let e,n="Ok",t,l;return{c(){e=x("button"),e.textContent=n,this.h()},l(s){e=k(s,"BUTTON",{class:!0,"data-svelte-h":!0}),A(e)!=="svelte-1wqcehx"&&(e.textContent=n),this.h()},h(){v(e,"class","py-2 px-4 inline-flex justify-center items-center gap-2 rounded-md border border-transparent font-semibold bg-blue-500 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all text-sm")},m(s,i){C(s,e,i),t||(l=I(e,"click",r[5]),t=!0)},p:y,d(s){s&&b(e),t=!1,l()}}}function fe(r){let e,n,t,l;const s=[ue,ce,ie],i=[];function u(o,a){return o[1]?0:o[4]==="SELECT"?1:2}return n=u(r),t=i[n]=s[n](r),{c(){e=x("div"),t.c(),this.h()},l(o){e=k(o,"DIV",{class:!0});var a=D(e);t.l(a),a.forEach(b),this.h()},h(){v(e,"class","p-4 text-center overflow-y-auto flex flex-col gap-2")},m(o,a){C(o,e,a),i[n].m(e,null),l=!0},p(o,[a]){let f=n;n=u(o),n===f?i[n].p(o,a):(q(),S(i[f],1,1,()=>{i[f]=null}),M(),t=i[n],t?t.p(o,a):(t=i[n]=s[n](o),t.c()),L(t,1),t.m(e,null))},i(o){l||(L(t),l=!0)},o(o){S(t),l=!1},d(o){o&&b(e),i[n].d()}}}function _e(r,e,n){let{id:t}=e,{app:l}=e,s=!1,i=!1,u,o="SELECT";const a=async()=>{n(1,s=!0),!(!u||!(await l.api_manager.get_admin_plug_api().import_plug_state(t,i,u)).ok)&&(n(4,o="RESULT"),n(1,s=!1))},f=m=>{const g=m.target.files[0];if(g){const T=new FileReader;T.onload=E=>{n(3,u=E.target.result),console.log(u)},T.readAsText(g)}};function h(){i=this.checked,n(2,i)}const _=()=>l.utils.small_modal_close();return r.$$set=m=>{"id"in m&&n(6,t=m.id),"app"in m&&n(0,l=m.app)},[l,s,i,u,o,a,t,f,h,_]}class pe extends V{constructor(e){super(),J(this,e,_e,fe,H,{id:6,app:0})}}function de(r){let e,n;return e=new te({props:{action_key:"id",actions:[{Name:"Execute",Class:"bg-blue-400",Action:r[2],icon:"lightning-bolt"},{Name:"Agents",Class:"bg-green-400",Action:r[3],icon:"users"},{Name:"Edit",Action:r[4],drop:!0,icon:"pencil-alt"},{Name:"States",Action:r[5],drop:!0,icon:"database"},{Name:"Export States",Action:r[12],drop:!0,icon:"download"},{Name:"Import States",Action:r[13],drop:!0,icon:"upload"},{Name:"Flow Map",Action:r[6],drop:!0,icon:"map"},{Name:"Logs",drop:!0,icon:"document-search",Action:r[9]},{Name:"Files",Action:r[11],Class:"bg-green-400",icon:"document-duplicate",drop:!0},{Name:"Reset",Action:r[8],drop:!0,icon:"refresh"},{Name:"Delete",Class:"bg-red-400",Action:r[7],icon:"trash",drop:!0}],key_names:[["id","ID"],["name","Name"],["owner","Owner"],["bprint_id","Bprint Id"]],color:[],datas:r[0],show_drop:!0}}),{c(){B(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,l){R(e,t,l),n=!0},p(t,l){const s={};l&1&&(s.datas=t[0]),e.$set(s)},i(t){n||(L(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function me(r){let e,n;return e=new z({}),{c(){B(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,l){R(e,t,l),n=!0},p:y,i(t){n||(L(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function ge(r){let e,n,t,l,s;const i=[me,de],u=[];function o(a,f){return a[1]?0:1}return e=o(r),n=u[e]=i[e](r),l=new ee({props:{onClick:r[10]}}),{c(){n.c(),t=j(),B(l.$$.fragment)},l(a){n.l(a),t=U(a),P(l.$$.fragment,a)},m(a,f){u[e].m(a,f),C(a,t,f),R(l,a,f),s=!0},p(a,[f]){let h=e;e=o(a),e===h?u[e].p(a,f):(q(),S(u[h],1,1,()=>{u[h]=null}),M(),n=u[e],n?n.p(a,f):(n=u[e]=i[e](a),n.c()),L(n,1),n.m(t.parentNode,t))},i(a){s||(L(n),L(l.$$.fragment,a),s=!0)},o(a){S(n),S(l.$$.fragment,a),s=!1},d(a){a&&b(t),u[e].d(a),F(l,a)}}}function be(r,e,n){let t=[],l=!0;const s=Z("__app__"),i=s.api_manager.get_admin_plug_api(),u=async()=>{const c=await i.list_plug();c.ok&&(n(0,t=c.data),n(1,l=!1))};return u(),[t,l,c=>s.nav.admin_plug_dev_execute(c,"default"),c=>s.nav.admin_agents(c),c=>s.nav.admin_plug_edit(c),c=>s.nav.admin_plug_states(c),c=>s.nav.admin_plug_dev_flowmap(c),async c=>{await s.api_manager.get_admin_plug_api().delete_plug(c),u()},async c=>{n(1,l=!0);const $=s.api_manager.get_engine_api(),O=await i.list_agent(c);if(!O.ok){n(1,l=!1);return}await Promise.all(O.data.map(async Y=>{await $.reset(c,Y.id)})).finally(()=>{n(1,l=!1)})},c=>{s.nav.admin_lens_logs({filters:{plug_id:c}})},()=>s.nav.admin_plug_new(),(c,$)=>s.nav.admin_bprint_files($.bprint_id),c=>{s.utils.small_modal_open(re,{app:s,id:c})},c=>{s.utils.small_modal_open(pe,{app:s,id:c})}]}class Ee extends V{constructor(e){super(),J(this,e,be,ge,H,{})}}export{Ee as component};
