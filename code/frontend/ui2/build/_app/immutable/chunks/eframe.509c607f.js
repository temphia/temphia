import{s as b,f as p,g as y,h as x,d as f,M as u,j as r,i as E,D as M,A as d,E as k,p as S}from"./scheduler.e2ee220a.js";import{S as D,i as F}from"./index.4aee2103.js";function q(n){let e,s,i,o;return{c(){e=p("iframe"),this.h()},l(t){e=y(t,"IFRAME",{src:!0,title:!0,class:!0,allow:!0,sandbox:!0}),x(e).forEach(f),this.h()},h(){u(e.src,s=n[3])||r(e,"src",s),r(e,"title",n[2]),r(e,"class","border-green-200 w-full h-full transition-all"),r(e,"allow","accelerometer; ambient-light-sensor; autoplay; battery; camera; clipboard-write; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking"),r(e,"sandbox","allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads allow-storage-access-by-user-activation")},m(t,l){E(t,e,l),n[5](e),i||(o=M(e,"load",n[6]),i=!0)},p(t,[l]){l&8&&!u(e.src,s=t[3])&&r(e,"src",s),l&4&&r(e,"title",t[2])},i:d,o:d,d(t){t&&f(e),n[5](null),i=!1,o()}}}function A(n,e,s){let{name:i}=e,{exec_data:o}=e,{iframe:t=null}=e,{url:l}=e,{chan:c=new MessageChannel}=e;const g=k(),_=a=>{console.log("@onFramwData",a);const m=JSON.parse(a.data);if(m.mtype!=="get_exec_data"){g("eframe_message",m);return}console.log("sending_exec_data"),c.port1.postMessage(JSON.stringify({mtype:"exec_data",data:o}),[])};c.port1.onmessage=_;function h(a){S[a?"unshift":"push"](()=>{t=a,s(0,t)})}const w=a=>{t.contentWindow.postMessage("transfer_port","*",[c.port2])};return n.$$set=a=>{"name"in a&&s(2,i=a.name),"exec_data"in a&&s(4,o=a.exec_data),"iframe"in a&&s(0,t=a.iframe),"url"in a&&s(3,l=a.url),"chan"in a&&s(1,c=a.chan)},[t,c,i,l,o,h,w]}class N extends D{constructor(e){super(),F(this,e,A,q,b,{name:2,exec_data:4,iframe:0,url:3,chan:1})}}export{N as E};
